<!DOCTYPE html>
<html lang="en">
<head>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "axm7ymo5bk");
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3JRCY1BFK"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1764421546773661" crossorigin="anonymous"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J3JRCY1BFK');
</script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="xcbyao,pwn,crypto,reverse,hack,信息熵洞,踏雪无痕">
    <meta name="description" content="凡心所向 素履以往 生如逆旅 一苇以航">
    <meta name="author" content="xcbyao">
    
    <title>
        
            LeetCode Record |
        
        Xcbyao&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"xcbyao.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#CC3333","avatar":"/images/avatar.png","favicon":"/images/favicon.ico","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.jpg","description":"我曾当年失意客，烟花依旧笑星空"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Xcbyao&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">LeetCode Record</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.png">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">xcbyao</span>
                        
                            <span class="author-label">小妖</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2023-05-19 17:32:51</span>
        <span class="mobile">2023-05-19 17:32</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Programming/">Programming</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>12.7k Words</span>
        </span>
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="Pref"><a href="#Pref" class="headerlink" title="Pref"></a>Pref</h1><p>LeetCode 刷题记录。 Hard</p>
<h1 id="Convert-the-Temperature-Easy"><a href="#Convert-the-Temperature-Easy" class="headerlink" title="Convert the Temperature - Easy"></a>Convert the Temperature - Easy</h1><p>Kelvin = Celsius + 273.15<br>Fahrenheit = Celsius * 1.80 + 32.00</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">convertTemperature</span>(<span class="params">self, celsius: <span class="built_in">float</span></span>) -&gt; List[float]:</span></span><br><span class="line">        <span class="keyword">return</span> [celsius + <span class="number">273.15</span>, celsius * <span class="number">1.80</span> + <span class="number">32.00</span>]</span><br></pre></td></tr></table></figure>
<h1 id="Smallest-Even-Multiple-Easy"><a href="#Smallest-Even-Multiple-Easy" class="headerlink" title="Smallest Even Multiple - Easy"></a>Smallest Even Multiple - Easy</h1><p>最小偶倍数：</p>
<p>Given a positive integer n, return the smallest positive integer that is a multiple of both 2 and n.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">smallestEvenMultiple</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> n <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> n * <span class="number">2</span></span><br><span class="line">        <span class="comment"># return n &lt;&lt; (n &amp; 1)</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        位运算避免分支判断。常用 n &amp; 1 判断奇数，二进制奇数最低位一定为 1，</span></span><br><span class="line"><span class="string">        因此，若按位与结果为 1，则最后一位为 1，n 为奇数；若为 0，则为偶数。</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># return (n % 2) == 0 ? n : n * 2</span></span><br></pre></td></tr></table></figure>
<h1 id="XOR-Operation-in-an-Array-Easy"><a href="#XOR-Operation-in-an-Array-Easy" class="headerlink" title="XOR Operation in an Array - Easy"></a>XOR Operation in an Array - Easy</h1><p>给你两个整数，n 和 start。</p>
<p>定义 nums[i] = start + 2*i（下标从 0 开始）且 n == nums.length。</p>
<p>请返回 nums 中所有元素按位异或后得到的结果。</p>
<p>输入：n = 5, start = 0<br>输出：8<br>解释：数组 nums 为 [0, 2, 4, 6, 8]，其中 (0 ^ 2 ^ 4 ^ 6 ^ 8) = 8 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">xorOperation</span>(<span class="params">self, n: <span class="built_in">int</span>, start: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            ans ^= (start + i * <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/problems/xor-operation-in-an-array/solution/shu-zu-yi-huo-cao-zuo-by-leetcode-solution" >方法二：数学<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="Number-of-Good-Pairs-Easy"><a href="#Number-of-Good-Pairs-Easy" class="headerlink" title="Number of Good Pairs - Easy"></a>Number of Good Pairs - Easy</h1><p>好数对的数目：</p>
<p>给你一个整数数组 nums。</p>
<p>如果一组数字 (i,j) 满足 nums[i] == nums[j] 且 i &lt; j ，就可以认为这是一组好数对。</p>
<p>返回好数对的数目。</p>
<p>输入：nums = [1,2,3,1,1,3]<br>输出：4<br>解释：有 4 组好数对，分别是 (0,3), (0,4), (3,4), (2,5) ，下标从 0 开始</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 暴力统计</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIdenticalPairs</span>(<span class="params">self, nums: List[<span class="built_in">int</span>]</span>) -&gt; int:</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(nums)):</span><br><span class="line">                <span class="keyword">if</span> nums[i] == nums[j]:</span><br><span class="line">                    ans += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/problems/number-of-good-pairs/solution/hao-shu-dui-de-shu-mu-by-leetcode-solution" >方法二：组合计数<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="Count-Good-Triplets-Easy"><a href="#Count-Good-Triplets-Easy" class="headerlink" title="Count Good Triplets - Easy"></a>Count Good Triplets - Easy</h1><p>一个整数数组 arr，以及 a、b 、c 三个整数。</p>
<p>如果三元组 (arr[i], arr[j], arr[k]) 满足下列全部条件，则认为它是一个好三元组。</p>
<p>0 &lt;= i &lt; j &lt; k &lt; arr.length<br>|arr[i] - arr[j]| &lt;= a<br>|arr[j] - arr[k]| &lt;= b<br>|arr[i] - arr[k]| &lt;= c<br>其中 |x| 表示 x 的绝对值。</p>
<p>返回好三元组的数量。</p>
<p>输入：arr = [3,0,1,1,9,7], a = 7, b = 2, c = 3<br>输出：4<br>解释：一共 4 个好三元组：[(3,0,1), (3,0,1), (3,1,1), (0,1,1)]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 枚举</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countGoodTriplets</span>(<span class="params">self, arr: List[<span class="built_in">int</span>], a: <span class="built_in">int</span>, b: <span class="built_in">int</span>, c: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        n = <span class="built_in">len</span>(arr)</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, n):</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j + <span class="number">1</span>, n):</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">abs</span>(arr[i] - arr[j]) &lt;= a <span class="keyword">and</span> <span class="built_in">abs</span>(arr[j] - arr[k]) &lt;= b <span class="keyword">and</span> <span class="built_in">abs</span>(arr[i] - arr[k]) &lt;= c:</span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> cnt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 暴力法三重循环可以提前判断终止最内层的计算</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countGoodTriplets</span>(<span class="params">self, arr: List[<span class="built_in">int</span>], a: <span class="built_in">int</span>, b: <span class="built_in">int</span>, c: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        size = <span class="built_in">len</span>(arr)</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size-<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,size-<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">abs</span>(arr[i] - arr[j]) &lt;= a:</span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j+<span class="number">1</span>, size):</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">abs</span>(arr[j] - arr[k]) &lt;= b <span class="keyword">and</span> <span class="built_in">abs</span>(arr[i] - arr[k]) &lt;= c:</span><br><span class="line">                            cnt += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> cnt</span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/problems/count-good-triplets/solution/tong-ji-hao-san-yuan-zu-by-leetcode-solution" >方法二：枚举优化<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="Add-Digits-Easy"><a href="#Add-Digits-Easy" class="headerlink" title="Add Digits - Easy"></a>Add Digits - Easy</h1><p>各位相加：</p>
<p>给定一个非负整数 num，反复将各个位上的数字相加，直到结果为一位数。返回这个结果。</p>
<p>输入: num = 38<br>输出: 2<br>解释: 各位相加的过程为：<br>38 –&gt; 3 + 8 –&gt; 11<br>11 –&gt; 1 + 1 –&gt; 2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addDigits</span>(<span class="params">self, num: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">while</span> num &gt;= <span class="number">10</span>:</span><br><span class="line">            <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> num:</span><br><span class="line">                <span class="built_in">sum</span> += num % <span class="number">10</span></span><br><span class="line">                num //= <span class="number">10</span></span><br><span class="line">            num = <span class="built_in">sum</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数学</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addDigits</span>(<span class="params">self, num: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> (num - <span class="number">1</span>) % <span class="number">9</span> + <span class="number">1</span> <span class="keyword">if</span> num <span class="keyword">else</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/problems/add-digits/solution/ge-wei-xiang-jia-by-leetcode-solution-u4kj" >方法二：数学<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="Subtract-the-Product-and-Sum-of-Digits-of-an-Integer-Easy"><a href="#Subtract-the-Product-and-Sum-of-Digits-of-an-Integer-Easy" class="headerlink" title="Subtract the Product and Sum of Digits of an Integer - Easy"></a>Subtract the Product and Sum of Digits of an Integer - Easy</h1><p>整数的各位积和之差：</p>
<p>整数 n，计算并返回该整数「各位数字之积」与「各位数字之和」的差。</p>
<p>输入：n = 234<br>输出：15<br>解释：<br>各位数之积 = 2 * 3 * 4 = 24<br>各位数之和 = 2 + 3 + 4 = 9<br>结果 = 24 - 9 = 15</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">subtractProductAndSum</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        add, mul = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">            add += n % <span class="number">10</span></span><br><span class="line">            mul *= n % <span class="number">10</span></span><br><span class="line">            n //= <span class="number">10</span></span><br><span class="line">        <span class="keyword">return</span> mul - add</span><br><span class="line"></span><br><span class="line"><span class="comment"># 暴力</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">subtractProductAndSum</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        add, mul = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">str</span>(n):</span><br><span class="line">            num = <span class="built_in">int</span>(num)</span><br><span class="line">            add += num</span><br><span class="line">            mul *= num</span><br><span class="line">        <span class="keyword">return</span> mul - add</span><br></pre></td></tr></table></figure>
<h1 id="Power-of-Two-Easy"><a href="#Power-of-Two-Easy" class="headerlink" title="Power of Two - Easy"></a>Power of Two - Easy</h1><p>给你一个整数 n，请你判断该整数是否是 2 的幂次方。如果是，返回 true；否则返回 false。</p>
<p>输入：n = 1<br>输出：true<br>解释：2^0 = 1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判断是否为最大 2 的幂的约数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    BIG = <span class="number">2</span>**<span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPowerOfTwo</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> <span class="keyword">and</span> Solution.BIG % n == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/problems/power-of-two/solution/2de-mi-by-leetcode-solution-rny3" >方法一：二进制表示<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="Power-of-Three-Easy"><a href="#Power-of-Three-Easy" class="headerlink" title="Power of Three - Easy"></a>Power of Three - Easy</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 试除法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPowerOfThree</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line">        <span class="keyword">while</span> n <span class="keyword">and</span> n % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">            n //= <span class="number">3</span></span><br><span class="line">        <span class="keyword">return</span> n == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断是否为最大 3 的幂的约数</span></span><br><span class="line"><span class="comment"># 这里限定范围最大 3 的幂为 3^19 = 1162261467</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPowerOfThree</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> <span class="keyword">and</span> <span class="number">1162261467</span> % n == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h1 id="Ugly-Number-Easy"><a href="#Ugly-Number-Easy" class="headerlink" title="Ugly Number - Easy"></a>Ugly Number - Easy</h1><p>丑数：只包含质因数 2、3 和 5 的正整数。</p>
<p>1 没有质因数，因此它的全部质因数是 {2, 3, 5} 的空集。习惯上将其视作第一个丑数。</p>
<p>给你一个整数 n，请你判断 n 是否为丑数。如果是，返回 true；否则返回 false。</p>
<p>输入：n = 6<br>输出：true<br>解释：6 = 2 × 3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数学</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isUgly</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        factors = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">        <span class="keyword">for</span> factor <span class="keyword">in</span> factors:</span><br><span class="line">            <span class="keyword">while</span> n % factor == <span class="number">0</span>:</span><br><span class="line">                n //= factor</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> n == <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="Shuffle-the-Array-Easy"><a href="#Shuffle-the-Array-Easy" class="headerlink" title="Shuffle the Array - Easy"></a>Shuffle the Array - Easy</h1><p>重新排序数组：</p>
<p>给你一个数组 nums，数组中有 2n 个元素，按 [x1,x2,…,xn,y1,y2,…,yn] 的格式排列。</p>
<p>请你将数组按 [x1,y1,x2,y2,…,xn,yn] 格式重新排列返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一次遍历</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], n: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">        ans = [<span class="number">0</span>] * (<span class="number">2</span> * n)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            ans[<span class="number">2</span> * i] = nums[i]</span><br><span class="line">            ans[<span class="number">2</span> * i + <span class="number">1</span>] = nums[n + i]</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切片赋值</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], n: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">        nums[::<span class="number">2</span>], nums[<span class="number">1</span>::<span class="number">2</span>] = nums[:n], nums[n:]</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], n: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            ans.append(nums[i])</span><br><span class="line">            ans.append(nums[n + i])</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<h1 id="Transpose-Matrix-Easy"><a href="#Transpose-Matrix-Easy" class="headerlink" title="Transpose Matrix - Easy"></a>Transpose Matrix - Easy</h1><p>二维整数数组 matrix，返回 matrix 的转置矩阵。</p>
<p>输入：<code>matrix = [[1,2,3],[4,5,6],[7,8,9]]</code><br>输出：<code>[[1,4,7],[2,5,8],[3,6,9]]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transpose</span>(<span class="params">self, matrix: List[List[<span class="built_in">int</span>]]</span>) -&gt; List[List[int]]:</span></span><br><span class="line">        m, n = <span class="built_in">len</span>(matrix), <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">        transposed = [[<span class="number">0</span>] * m <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                transposed[j][i] = matrix[i][j]</span><br><span class="line">        <span class="keyword">return</span> transposed</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟 python3_oneline</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transpose</span>(<span class="params">self, matrix: List[List[<span class="built_in">int</span>]]</span>) -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">list</span>(row) <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">zip</span>(*matrix))</span><br><span class="line">        <span class="comment"># return [list(row) for row in zip(*matrix)] # 强制转换返回列表值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transpose</span>(<span class="params">self, matrix: List[List[<span class="built_in">int</span>]]</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">zip</span>(*matrix)</span><br><span class="line"></span><br><span class="line"><span class="comment"># numpy 库</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transpose</span>(<span class="params">self, matrix: List[List[<span class="built_in">int</span>]]</span>) -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">        <span class="keyword">return</span> np.array(matrix).T.tolist()</span><br></pre></td></tr></table></figure>
<h1 id="Maximum-Score-After-Splitting-a-String-Easy"><a href="#Maximum-Score-After-Splitting-a-String-Easy" class="headerlink" title="Maximum Score After Splitting a String - Easy"></a>Maximum Score After Splitting a String - Easy</h1><p>分割字符串的最大得分：</p>
<p>由若干 0 和 1 组成的字符串 s，计算并返回将该字符串分割成两个非空子字符串（即左和右子字符串）所能获得的最大得分。</p>
<p>「分割字符串的得分」为左子字符串中 0 的数量加上右子字符串中 1 的数量。</p>
<p>输入：s = “011101”<br>输出：5<br>解释：<br>将字符串 s 划分为两个非空子字符串的可行方案有：<br>左子字符串 = “0” 且 右子字符串 = “11101”，得分 = 1 + 4 = 5<br>左子字符串 = “01” 且 右子字符串 = “1101”，得分 = 1 + 3 = 4<br>左子字符串 = “011” 且 右子字符串 = “101”，得分 = 1 + 2 = 3<br>左子字符串 = “0111” 且 右子字符串 = “01”，得分 = 1 + 1 = 2<br>左子字符串 = “01110” 且 右子字符串 = “1”，得分 = 2 + 1 = 3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 枚举每个分割点</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(s[:i].count(<span class="string">&#x27;0&#x27;</span>) + s[i:].count(<span class="string">&#x27;1&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(s)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 两次遍历</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">        ans = score = (s[<span class="number">0</span>] == <span class="string">&#x27;0&#x27;</span>) + s[<span class="number">1</span>:].count(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s[<span class="number">1</span>:-<span class="number">1</span>]:</span><br><span class="line">            score += <span class="number">1</span> <span class="keyword">if</span> c == <span class="string">&#x27;0&#x27;</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">            ans = <span class="built_in">max</span>(ans, score)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<h1 id="Count-the-Number-of-Vowel-Strings-in-Range-Easy"><a href="#Count-the-Number-of-Vowel-Strings-in-Range-Easy" class="headerlink" title="Count the Number of Vowel Strings in Range - Easy"></a>Count the Number of Vowel Strings in Range - Easy</h1><p>统计范围内的元音字符串数：</p>
<p>给你一个下标从 0 开始的字符串数组 words 和两个整数：left 和 right。</p>
<p>如果字符串以元音字母开头并以元音字母结尾，那么该字符串就是一个元音字符串，其中元音字母是 ‘a’、’e’、’i’、’o’、’u’。</p>
<p>返回 words[i] 是元音字符串的数目，其中 i 在闭区间 [left, right] 内。</p>
<p>输入：words = [“are”,”amy”,”u”], left = 0, right = 2<br>输出：2<br>解释：</p>
<ul>
<li>“are” 是一个元音字符串，因为它以 ‘a’ 开头并以 ‘e’ 结尾。</li>
<li>“amy” 不是元音字符串，因为它没有以元音字母结尾。</li>
<li>“u” 是一个元音字符串，因为它以 ‘u’ 开头并以 ‘u’ 结尾。<br>在上述范围中的元音字符串数目为 2 。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">vowelStrings</span>(<span class="params">self, words: List[<span class="built_in">str</span>], left: <span class="built_in">int</span>, right: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(s[<span class="number">0</span>] <span class="keyword">in</span> <span class="string">&quot;aeiou&quot;</span> <span class="keyword">and</span> s[-<span class="number">1</span>] <span class="keyword">in</span> <span class="string">&quot;aeiou&quot;</span> <span class="keyword">for</span> s <span class="keyword">in</span> words[left:right+<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<h1 id="Peak-Index-in-a-Mountain-Array-Medium"><a href="#Peak-Index-in-a-Mountain-Array-Medium" class="headerlink" title="Peak Index in a Mountain Array - Medium"></a>Peak Index in a Mountain Array - Medium</h1><p>山脉数组的峰顶索引：</p>
<p>符合下列属性的数组 arr 称为 山脉数组：<br>arr.length &gt;= 3<br>存在 i（0 &lt; i &lt; arr.length - 1）使得：<br>arr[0] &lt; arr[1] &lt; … arr[i-1] &lt; arr[i]<br>arr[i] &gt; arr[i+1] &gt; … &gt; arr[arr.length - 1]</p>
<p>给你由整数组成的山脉数组 arr，返回满足 arr[0] &lt; arr[1] &lt; … arr[i - 1] &lt; arr[i] &gt; arr[i + 1] &gt; … &gt; arr[arr.length - 1] 的下标 i。</p>
<p>设计并实现时间复杂度为 O(logn) 的解决方案。</p>
<p>输入：arr = [0,2,1,0]<br>输出：1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 枚举，时间复杂度 O(n)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span>(<span class="params">self, arr: List[<span class="built_in">int</span>]</span>) -&gt; int:</span></span><br><span class="line">        ans = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(arr)-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> arr[i] &gt; arr[i+<span class="number">1</span>]:</span><br><span class="line">                ans = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二分查找</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span>(<span class="params">self, arr: List[<span class="built_in">int</span>]</span>) -&gt; int:</span></span><br><span class="line">        left, right, ans = <span class="number">1</span>, <span class="built_in">len</span>(arr) - <span class="number">2</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> left &lt;= right:</span><br><span class="line">            mid = (left + right) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> arr[mid] &gt; arr[mid + <span class="number">1</span>]:</span><br><span class="line">                ans = mid</span><br><span class="line">                right = mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>





<h1 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h1><h2 id="Find-Customer-Referee-Easy"><a href="#Find-Customer-Referee-Easy" class="headerlink" title="Find Customer Referee - Easy"></a>Find Customer Referee - Easy</h2><p>寻找用户推荐人：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Customer</span><br><span class="line">+----+------+------------+</span><br><span class="line">| id | name | referee_id |</span><br><span class="line">+----+------+------------+</span><br><span class="line">| 1  | Will | null       |</span><br><span class="line">| 2  | Jane | null       |</span><br><span class="line">| 3  | Alex | 2          |</span><br><span class="line">| 4  | Bill | null       |</span><br><span class="line">| 5  | Zack | 1          |</span><br><span class="line">| 6  | Mark | 2          |</span><br><span class="line">+----+------+------------+</span><br></pre></td></tr></table></figure>
<p>写一个查询语句，返回一个客户列表，列表中客户的推荐人的编号都不是 2。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Output:</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| Will |</span><br><span class="line">| Jane |</span><br><span class="line">| Bill |</span><br><span class="line">| Zack |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>
<p>MySQL 使用三值逻辑 —— TRUE, FALSE 和 UNKNOWN。任何与 NULL 值进行的比较都会与第三种值 UNKNOWN 做比较。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> customer <span class="keyword">WHERE</span> referee_id <span class="operator">&lt;&gt;</span> <span class="number">2</span> <span class="keyword">OR</span> referee_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> customer <span class="keyword">WHERE</span> referee_id <span class="operator">!=</span> <span class="number">2</span> <span class="keyword">OR</span> referee_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用安全等于取反</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> customer <span class="keyword">WHERE</span> <span class="keyword">NOT</span> referee_id <span class="operator">&lt;=&gt;</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">因此，最后一句意思是选择所有 referee_id 不等于 2 的行，包括 NULL  行。</span></span><br><span class="line"><span class="comment">&lt;=&gt; 是 MySQL 特有的运算符，用于比较两个值是否相等，包括 NULL 值。使用方式：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">如果两个值都不是 NULL，&quot;&lt;=&gt;&quot; 的作用与 &quot;=&quot; 相同，即比较两个值是否相等。</span></span><br><span class="line"><span class="comment">如果其中一个值为 NULL，那么 &quot;&lt;=&gt;&quot; 的结果为 FALSE（不相等），而&quot;=&quot; 的结果为 UNKNOWN（未知）。</span></span><br><span class="line"><span class="comment">如果两个值都为 NULL，那么 &quot;&lt;=&gt;&quot; 的结果为 TRUE（相等），而&quot;=&quot; 的结果为 UNKNOWN（未知）。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="Recyclable-and-Low-Fat-Products-Easy"><a href="#Recyclable-and-Low-Fat-Products-Easy" class="headerlink" title="Recyclable and Low Fat Products - Easy"></a>Recyclable and Low Fat Products - Easy</h2><p>可回收且低脂的产品：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Table: Products</span><br><span class="line">+-------------+----------+------------+</span><br><span class="line">| product_id  | low_fats | recyclable |</span><br><span class="line">+-------------+----------+------------+</span><br><span class="line">| 0           | Y        | N          |</span><br><span class="line">| 1           | Y        | Y          |</span><br><span class="line">| 2           | N        | Y          |</span><br><span class="line">| 3           | Y        | Y          |</span><br><span class="line">| 4           | N        | N          |</span><br><span class="line">+-------------+----------+------------+</span><br><span class="line"></span><br><span class="line">product_id 是这个表的主键。</span><br><span class="line">low_fats 是枚举类型，取值为以下两种 (&#39;Y&#39;, &#39;N&#39;)，其中 &#39;Y&#39; 表示该产品是低脂产品，&#39;N&#39; 则不是。</span><br><span class="line">recyclable 同上。</span><br></pre></td></tr></table></figure>
<p>查找既是低脂又是可回收的产品编号。返回结果无顺序要求。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Output:</span><br><span class="line">+-------------+</span><br><span class="line">| product_id  |</span><br><span class="line">+-------------+</span><br><span class="line">| 1           |</span><br><span class="line">| 3           |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> low_fats <span class="operator">=</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">AND</span> recyclable <span class="operator">=</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Big-Countries-Easy"><a href="#Big-Countries-Easy" class="headerlink" title="Big Countries - Easy"></a>Big Countries - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: World</span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| name        | varchar |</span><br><span class="line">| continent   | varchar |</span><br><span class="line">| area        | int     |</span><br><span class="line">| population  | int     |</span><br><span class="line">| gdp         | bigint  |</span><br><span class="line">+-------------+---------+</span><br><span class="line">name is the primary key column</span><br></pre></td></tr></table></figure>
<p>面积至少为 300 万平方公里，或人口至少为 2500 万。<br>编写一个 SQL 查询以报告大国的国家名称、人口和面积。</p>
<p>按任意顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">World table:</span><br><span class="line">+-------------+-----------+---------+------------+--------------+</span><br><span class="line">| name        | continent | area    | population | gdp          |</span><br><span class="line">+-------------+-----------+---------+------------+--------------+</span><br><span class="line">| Afghanistan | Asia      | 652230  | 25500100   | 20343000000  |</span><br><span class="line">| Albania     | Europe    | 28748   | 2831741    | 12960000000  |</span><br><span class="line">| Algeria     | Africa    | 2381741 | 37100000   | 188681000000 |</span><br><span class="line">| Andorra     | Europe    | 468     | 78115      | 3712000000   |</span><br><span class="line">| Angola      | Africa    | 1246700 | 20609294   | 100990000000 |</span><br><span class="line">+-------------+-----------+---------+------------+--------------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+------------+---------+</span><br><span class="line">| name        | population | area    |</span><br><span class="line">+-------------+------------+---------+</span><br><span class="line">| Afghanistan | 25500100   | 652230  |</span><br><span class="line">| Algeria     | 37100000   | 2381741 |</span><br><span class="line">+-------------+------------+---------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="comment">-- 使用 OR</span></span><br><span class="line"><span class="keyword">SELECT</span> name, population, area</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> population <span class="operator">&gt;=</span> <span class="number">25000000</span> <span class="keyword">OR</span> area <span class="operator">&gt;=</span> <span class="number">3000000</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 or 可能会使索引失效，在数据量较大的时候查找效率较低，通常建议使用 union。</span></span><br><span class="line"><span class="comment">-- 使用 UNION，比上一种速度更块，但差别不大</span></span><br><span class="line"><span class="keyword">SELECT</span> name, population, area</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> population <span class="operator">&gt;=</span> <span class="number">25000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> name, population, area</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> area <span class="operator">&gt;=</span> <span class="number">3000000</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Article-Views-I-Easy"><a href="#Article-Views-I-Easy" class="headerlink" title="Article Views I - Easy"></a>Article Views I - Easy</h2><p>文章浏览 I：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Table: Views</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| article_id    | int     |</span><br><span class="line">| author_id     | int     |</span><br><span class="line">| viewer_id     | int     |</span><br><span class="line">| view_date     | date    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">此表无主键，因此可能会存在重复行。</span><br><span class="line">此表的每一行都表示某人在某天浏览了某位作者的某篇文章。</span><br><span class="line">同一人的 author_id 和 viewer_id 是相同的。</span><br></pre></td></tr></table></figure>
<p>找出所有浏览过自己文章的作者，结果按照 id 升序排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Views table:</span><br><span class="line">+------------+-----------+-----------+------------+</span><br><span class="line">| article_id | author_id | viewer_id | view_date  |</span><br><span class="line">+------------+-----------+-----------+------------+</span><br><span class="line">| 1          | 3         | 5         | 2019-08-01 |</span><br><span class="line">| 1          | 3         | 6         | 2019-08-02 |</span><br><span class="line">| 2          | 7         | 7         | 2019-08-01 |</span><br><span class="line">| 2          | 7         | 6         | 2019-08-02 |</span><br><span class="line">| 4          | 7         | 1         | 2019-07-22 |</span><br><span class="line">| 3          | 4         | 4         | 2019-07-21 |</span><br><span class="line">| 3          | 4         | 4         | 2019-07-21 |</span><br><span class="line">+------------+-----------+-----------+------------+</span><br><span class="line">Output:</span><br><span class="line">+------+</span><br><span class="line">| id   |</span><br><span class="line">+------+</span><br><span class="line">| 4    |</span><br><span class="line">| 7    |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> author_id <span class="keyword">AS</span> id</span><br><span class="line"><span class="keyword">FROM</span>  Views</span><br><span class="line"><span class="keyword">WHERE</span> author_id <span class="operator">=</span> viewer_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> author_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Invalid-Tweets-Easy"><a href="#Invalid-Tweets-Easy" class="headerlink" title="Invalid Tweets - Easy"></a>Invalid Tweets - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Table: Tweets</span><br><span class="line">+----------------+---------+</span><br><span class="line">| Column Name    | Type    |</span><br><span class="line">+----------------+---------+</span><br><span class="line">| tweet_id       | int     |</span><br><span class="line">| content        | varchar |</span><br><span class="line">+----------------+---------+</span><br><span class="line">tweet_id is the primary key.</span><br></pre></td></tr></table></figure>
<p>查询所有无效推文的编号（ID）。当推文内容中的字符数严格大于 15 时，该推文是无效的。</p>
<p>以任意顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Tweets table:</span><br><span class="line">+----------+----------------------------------+</span><br><span class="line">| tweet_id | content                          |</span><br><span class="line">+----------+----------------------------------+</span><br><span class="line">| 1        | Vote for Biden                   |</span><br><span class="line">| 2        | Let us make America great again! |</span><br><span class="line">+----------+----------------------------------+</span><br><span class="line">Output:</span><br><span class="line">+----------+</span><br><span class="line">| tweet_id |</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">+----------+</span><br><span class="line">Explanation:</span><br><span class="line">Tweet 1 has length &#x3D; 14. It is a valid tweet.</span><br><span class="line">Tweet 2 has length &#x3D; 32. It is an invalid tweet.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> tweet_id</span><br><span class="line"><span class="keyword">FROM</span> tweets</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">CHAR_LENGTH</span>(content) <span class="operator">&gt;</span> <span class="number">15</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Replace-Employee-ID-With-The-Unique-Identifier-Easy"><a href="#Replace-Employee-ID-With-The-Unique-Identifier-Easy" class="headerlink" title="Replace Employee ID With The Unique Identifier - Easy"></a>Replace Employee ID With The Unique Identifier - Easy</h2><p>使用唯一标识码替换员工 ID：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Table: Employees</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| name          | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">id is the primary key.</span><br><span class="line"></span><br><span class="line">Table: EmployeeUNI</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| unique_id     | int     |</span><br><span class="line">+---------------+---------+</span><br></pre></td></tr></table></figure>
<p>展示每位用户的唯一标识码（unique ID ）；如果某位员工没有唯一标识码，使用 null 填充即可。</p>
<p>你可以以任意顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employees table:</span><br><span class="line">+----+----------+</span><br><span class="line">| id | name     |</span><br><span class="line">+----+----------+</span><br><span class="line">| 1  | Alice    |</span><br><span class="line">| 7  | Bob      |</span><br><span class="line">| 11 | Meir     |</span><br><span class="line">| 90 | Winston  |</span><br><span class="line">| 3  | Jonathan |</span><br><span class="line">+----+----------+</span><br><span class="line">EmployeeUNI table:</span><br><span class="line">+----+-----------+</span><br><span class="line">| id | unique_id |</span><br><span class="line">+----+-----------+</span><br><span class="line">| 3  | 1         |</span><br><span class="line">| 11 | 2         |</span><br><span class="line">| 90 | 3         |</span><br><span class="line">+----+-----------+</span><br><span class="line">Output:</span><br><span class="line">+-----------+----------+</span><br><span class="line">| unique_id | name     |</span><br><span class="line">+-----------+----------+</span><br><span class="line">| null      | Alice    |</span><br><span class="line">| null      | Bob      |</span><br><span class="line">| 2         | Meir     |</span><br><span class="line">| 3         | Winston  |</span><br><span class="line">| 1         | Jonathan |</span><br><span class="line">+-----------+----------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> unique_id, name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employeeUNI</span><br><span class="line"><span class="keyword">ON</span> employees.id <span class="operator">=</span> employeeUNI.id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Product-Sales-Analysis-I-Easy"><a href="#Product-Sales-Analysis-I-Easy" class="headerlink" title="Product Sales Analysis I - Easy"></a>Product Sales Analysis I - Easy</h2><p>产品销售分析 I:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Table: Sales</span><br><span class="line">+-------------+-------+</span><br><span class="line">| Column Name | Type  |</span><br><span class="line">+-------------+-------+</span><br><span class="line">| sale_id     | int   |</span><br><span class="line">| product_id  | int   |</span><br><span class="line">| year        | int   |</span><br><span class="line">| quantity    | int   |</span><br><span class="line">| price       | int   |</span><br><span class="line">+-------------+-------+</span><br><span class="line">(sale_id, year) is the primary key of this table.</span><br><span class="line">product_id is a foreign key to Product table.</span><br><span class="line"></span><br><span class="line">Table: Product</span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| product_id   | int     |</span><br><span class="line">| product_name | varchar |</span><br><span class="line">+--------------+---------+</span><br><span class="line">product_id is the primary key of this table.</span><br></pre></td></tr></table></figure>
<p>获取 Sales 表中所有产品对应的产品名称 product_name 以及该产品的所有售卖年份 year 和价格 price。</p>
<p>查询结果中的顺序无特定要求。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Sales table:</span><br><span class="line">+---------+------------+------+----------+-------+</span><br><span class="line">| sale_id | product_id | year | quantity | price |</span><br><span class="line">+---------+------------+------+----------+-------+</span><br><span class="line">| 1       | 100        | 2008 | 10       | 5000  |</span><br><span class="line">| 2       | 100        | 2009 | 12       | 5000  |</span><br><span class="line">| 7       | 200        | 2011 | 15       | 9000  |</span><br><span class="line">+---------+------------+------+----------+-------+</span><br><span class="line">Product table:</span><br><span class="line">+------------+--------------+</span><br><span class="line">| product_id | product_name |</span><br><span class="line">+------------+--------------+</span><br><span class="line">| 100        | Nokia        |</span><br><span class="line">| 200        | Apple        |</span><br><span class="line">| 300        | Samsung      |</span><br><span class="line">+------------+--------------+</span><br><span class="line">Output:</span><br><span class="line">+--------------+-------+-------+</span><br><span class="line">| product_name | year  | price |</span><br><span class="line">+--------------+-------+-------+</span><br><span class="line">| Nokia        | 2008  | 5000  |</span><br><span class="line">| Nokia        | 2009  | 5000  |</span><br><span class="line">| Apple        | 2011  | 9000  |</span><br><span class="line">+--------------+-------+-------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> p.product_name, s.year, s.price</span><br><span class="line"><span class="keyword">FROM</span> sales s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> product p</span><br><span class="line"><span class="keyword">ON</span> s.product_id <span class="operator">=</span> p.product_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Customer-Who-Visited-but-Did-Not-Make-Any-Transactions-Easy"><a href="#Customer-Who-Visited-but-Did-Not-Make-Any-Transactions-Easy" class="headerlink" title="Customer Who Visited but Did Not Make Any Transactions - Easy"></a>Customer Who Visited but Did Not Make Any Transactions - Easy</h2><p>进店却未进行过交易的顾客：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Table: Visits</span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| visit_id    | int     |</span><br><span class="line">| customer_id | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">visit_id is the primary key for this table.</span><br><span class="line"></span><br><span class="line">Table: Transactions</span><br><span class="line">+----------------+---------+</span><br><span class="line">| Column Name    | Type    |</span><br><span class="line">+----------------+---------+</span><br><span class="line">| transaction_id | int     |</span><br><span class="line">| visit_id       | int     |</span><br><span class="line">| amount         | int     |</span><br><span class="line">+----------------+---------+</span><br><span class="line">transaction_id is the primary key for this table.</span><br></pre></td></tr></table></figure>
<p>有一些顾客可能光顾了购物中心但没有进行交易。请你编写一个 SQL 查询，来查找这些顾客的 ID，以及他们只光顾不交易的次数。</p>
<p>返回以 任何顺序 排序的结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Visits</span><br><span class="line">+----------+-------------+</span><br><span class="line">| visit_id | customer_id |</span><br><span class="line">+----------+-------------+</span><br><span class="line">| 1        | 23          |</span><br><span class="line">| 2        | 9           |</span><br><span class="line">| 4        | 30          |</span><br><span class="line">| 5        | 54          |</span><br><span class="line">| 6        | 96          |</span><br><span class="line">| 7        | 54          |</span><br><span class="line">| 8        | 54          |</span><br><span class="line">+----------+-------------+</span><br><span class="line">Transactions</span><br><span class="line">+----------------+----------+--------+</span><br><span class="line">| transaction_id | visit_id | amount |</span><br><span class="line">+----------------+----------+--------+</span><br><span class="line">| 2              | 5        | 310    |</span><br><span class="line">| 3              | 5        | 300    |</span><br><span class="line">| 9              | 5        | 200    |</span><br><span class="line">| 12             | 1        | 910    |</span><br><span class="line">| 13             | 2        | 970    |</span><br><span class="line">+----------------+----------+--------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+----------------+</span><br><span class="line">| customer_id | count_no_trans |</span><br><span class="line">+-------------+----------------+</span><br><span class="line">| 54          | 2              |</span><br><span class="line">| 30          | 1              |</span><br><span class="line">| 96          | 1              |</span><br><span class="line">+-------------+----------------+</span><br><span class="line">解释:</span><br><span class="line">ID &#x3D; 23 的顾客曾经逛过一次购物中心，并在 ID &#x3D; 12 的访问期间进行了一笔交易。</span><br><span class="line">ID &#x3D; 9 的顾客曾经逛过一次购物中心，并在 ID &#x3D; 13 的访问期间进行了一笔交易。</span><br><span class="line">ID &#x3D; 30 的顾客曾经去过购物中心，并且没有进行任何交易。</span><br><span class="line">ID &#x3D; 54 的顾客三度造访了购物中心。在 2 次访问中，他们没有进行任何交易，在 1 次访问中，他们进行了 3 次交易。</span><br><span class="line">ID &#x3D; 96 的顾客曾经去过购物中心，并且没有进行任何交易。</span><br><span class="line">如我们所见，ID 为 30 和 96 的顾客一次没有进行任何交易就去了购物中心。顾客 54 也两次访问了购物中心并且没有进行任何交易。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> customer_id, <span class="built_in">count</span>(customer_id) count_no_trans</span><br><span class="line"><span class="keyword">FROM</span> visits v</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> transactions t</span><br><span class="line"><span class="keyword">ON</span> v.visit_id <span class="operator">=</span> t.visit_id</span><br><span class="line"><span class="keyword">WHERE</span> amount <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Rising-Temperature-Easy"><a href="#Rising-Temperature-Easy" class="headerlink" title="Rising Temperature - Easy"></a>Rising Temperature - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Table: Weather</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| recordDate    | date    |</span><br><span class="line">| temperature   | int     |</span><br><span class="line">+---------------+---------+</span><br><span class="line">id is the primary key for this table.</span><br></pre></td></tr></table></figure>
<p>查找与之前（昨天的）日期相比温度更高的所有日期的 id。</p>
<p>返回结果不排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Weather table:</span><br><span class="line">+----+------------+-------------+</span><br><span class="line">| id | recordDate | temperature |</span><br><span class="line">+----+------------+-------------+</span><br><span class="line">| 1  | 2015-01-01 | 10          |</span><br><span class="line">| 2  | 2015-01-02 | 25          |</span><br><span class="line">| 3  | 2015-01-03 | 20          |</span><br><span class="line">| 4  | 2015-01-04 | 30          |</span><br><span class="line">+----+------------+-------------+</span><br><span class="line">Output:</span><br><span class="line">+----+</span><br><span class="line">| id |</span><br><span class="line">+----+</span><br><span class="line">| 2  |</span><br><span class="line">| 4  |</span><br><span class="line">+----+</span><br><span class="line">解释：</span><br><span class="line">2015-01-02 的温度比前一天高（10 -&gt; 25）</span><br><span class="line">2015-01-04 的温度比前一天高（20 -&gt; 30）</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> a.id</span><br><span class="line"><span class="keyword">FROM</span> weather a</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> weather b</span><br><span class="line"><span class="keyword">ON</span> datediff(a.recorddate, b.recorddate) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">WHERE</span> a.temperature <span class="operator">&gt;</span> b.temperature</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> a.id</span><br><span class="line"><span class="keyword">FROM</span> weather a</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> weather b</span><br><span class="line"><span class="keyword">ON</span> timestampdiff(<span class="keyword">day</span>, a.recorddate, b.recorddate) <span class="operator">=</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">WHERE</span> a.temperature <span class="operator">&gt;</span> b.temperature</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Average-Time-of-Process-per-Machine-Easy"><a href="#Average-Time-of-Process-per-Machine-Easy" class="headerlink" title="Average Time of Process per Machine - Easy"></a>Average Time of Process per Machine - Easy</h2><p>每台机器的进程平均运行时间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Activity</span><br><span class="line">+----------------+---------+</span><br><span class="line">| Column Name    | Type    |</span><br><span class="line">+----------------+---------+</span><br><span class="line">| machine_id     | int     |</span><br><span class="line">| process_id     | int     |</span><br><span class="line">| activity_type  | enum    |</span><br><span class="line">| timestamp      | float   |</span><br><span class="line">+----------------+---------+</span><br><span class="line">(machine_id, process_id, activity_type) 是当前表的主键。</span><br></pre></td></tr></table></figure>
<p>现在有一个工厂网站由几台机器运行，每台机器上运行着相同数量的进程。计算每台机器各自完成一个进程任务的平均耗时。</p>
<p>完成一个进程任务的时间指进程的 ‘end’ 时间戳减去 ‘start’ 时间戳。平均耗时通过计算每台机器上所有进程任务的总耗费时间除以机器上的总进程数量获得。</p>
<p>结果表必须包含 machine_id（机器ID）和对应的 average time（平均耗时） 别名 processing_time，且四舍五入保留 3 位小数。</p>
<p>以 任意顺序 返回表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Activity table:</span><br><span class="line">+------------+------------+---------------+-----------+</span><br><span class="line">| machine_id | process_id | activity_type | timestamp |</span><br><span class="line">+------------+------------+---------------+-----------+</span><br><span class="line">| 0          | 0          | start         | 0.712     |</span><br><span class="line">| 0          | 0          | end           | 1.520     |</span><br><span class="line">| 0          | 1          | start         | 3.140     |</span><br><span class="line">| 0          | 1          | end           | 4.120     |</span><br><span class="line">| 1          | 0          | start         | 0.550     |</span><br><span class="line">| 1          | 0          | end           | 1.550     |</span><br><span class="line">| 1          | 1          | start         | 0.430     |</span><br><span class="line">| 1          | 1          | end           | 1.420     |</span><br><span class="line">| 2          | 0          | start         | 4.100     |</span><br><span class="line">| 2          | 0          | end           | 4.512     |</span><br><span class="line">| 2          | 1          | start         | 2.500     |</span><br><span class="line">| 2          | 1          | end           | 5.000     |</span><br><span class="line">+------------+------------+---------------+-----------+</span><br><span class="line">Output:</span><br><span class="line">+------------+-----------------+</span><br><span class="line">| machine_id | processing_time |</span><br><span class="line">+------------+-----------------+</span><br><span class="line">| 0          | 0.894           |</span><br><span class="line">| 1          | 0.995           |</span><br><span class="line">| 2          | 1.456           |</span><br><span class="line">+------------+-----------------+</span><br><span class="line">解释：</span><br><span class="line">一共有3台机器,每台机器运行着两个进程.</span><br><span class="line">机器 0 的平均耗时: ((1.520 - 0.712) + (4.120 - 3.140)) &#x2F; 2 &#x3D; 0.894</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    machine_id,</span><br><span class="line">    ROUND(<span class="built_in">AVG</span>(IF(activity_type <span class="operator">=</span> <span class="string">&#x27;start&#x27;</span>, <span class="operator">-</span><span class="type">timestamp</span>, <span class="type">timestamp</span>)) <span class="operator">*</span> <span class="number">2</span>, <span class="number">3</span>) processing_time</span><br><span class="line"><span class="keyword">FROM</span> activity</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> machine_id</span><br></pre></td></tr></table></figure>
<h2 id="Employee-Bonus-Easy"><a href="#Employee-Bonus-Easy" class="headerlink" title="Employee Bonus - Easy"></a>Employee Bonus - Easy</h2><p>选出所有 bonus &lt; 1000 员工的 name 及其 bonus。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employee table:</span><br><span class="line">+-------+--------+------------+--------+</span><br><span class="line">| empId | name   | supervisor | salary |</span><br><span class="line">+-------+--------+------------+--------+</span><br><span class="line">| 3     | Brad   | null       | 4000   |</span><br><span class="line">| 1     | John   | 3          | 1000   |</span><br><span class="line">| 2     | Dan    | 3          | 2000   |</span><br><span class="line">| 4     | Thomas | 3          | 4000   |</span><br><span class="line">+-------+--------+------------+--------+</span><br><span class="line">Bonus table:</span><br><span class="line">+-------+-------+</span><br><span class="line">| empId | bonus |</span><br><span class="line">+-------+-------+</span><br><span class="line">| 2     | 500   |</span><br><span class="line">| 4     | 2000  |</span><br><span class="line">+-------+-------+</span><br><span class="line">Output:</span><br><span class="line">+------+-------+</span><br><span class="line">| name | bonus |</span><br><span class="line">+------+-------+</span><br><span class="line">| Brad | null  |</span><br><span class="line">| John | null  |</span><br><span class="line">| Dan  | 500   |</span><br><span class="line">+------+-------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> name, bonus</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> bonus</span><br><span class="line"><span class="keyword">ON</span> employee.empId <span class="operator">=</span> bonus.empId</span><br><span class="line"><span class="keyword">WHERE</span> bonus <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">OR</span> bonus <span class="operator">&lt;</span> <span class="number">1000</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Students-and-Examinations-Easy"><a href="#Students-and-Examinations-Easy" class="headerlink" title="Students and Examinations - Easy"></a>Students and Examinations - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Table: Students</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| student_id    | int     |</span><br><span class="line">| student_name  | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">student_id is the primary key.</span><br><span class="line"></span><br><span class="line">Table: Subjects</span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| subject_name | varchar |</span><br><span class="line">+--------------+---------+</span><br><span class="line">subject_name is the primary key.</span><br><span class="line"></span><br><span class="line">Table: Examinations</span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| student_id   | int     |</span><br><span class="line">| subject_name | varchar |</span><br><span class="line">+--------------+---------+</span><br><span class="line">无主键，可能会有重复行。</span><br></pre></td></tr></table></figure>
<p>查询出每个学生参加每一门科目测试的次数，结果按 student_id 和 subject_name 排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Students table:</span><br><span class="line">+------------+--------------+</span><br><span class="line">| student_id | student_name |</span><br><span class="line">+------------+--------------+</span><br><span class="line">| 1          | Alice        |</span><br><span class="line">| 2          | Bob          |</span><br><span class="line">| 13         | John         |</span><br><span class="line">| 6          | Alex         |</span><br><span class="line">+------------+--------------+</span><br><span class="line">Subjects table:</span><br><span class="line">+--------------+</span><br><span class="line">| subject_name |</span><br><span class="line">+--------------+</span><br><span class="line">| Math         |</span><br><span class="line">| Physics      |</span><br><span class="line">| Programming  |</span><br><span class="line">+--------------+</span><br><span class="line">Examinations table:</span><br><span class="line">+------------+--------------+</span><br><span class="line">| student_id | subject_name |</span><br><span class="line">+------------+--------------+</span><br><span class="line">| 1          | Math         |</span><br><span class="line">| 1          | Physics      |</span><br><span class="line">| 1          | Programming  |</span><br><span class="line">| 2          | Programming  |</span><br><span class="line">| 1          | Physics      |</span><br><span class="line">| 1          | Math         |</span><br><span class="line">| 13         | Math         |</span><br><span class="line">| 13         | Programming  |</span><br><span class="line">| 13         | Physics      |</span><br><span class="line">| 2          | Math         |</span><br><span class="line">| 1          | Math         |</span><br><span class="line">+------------+--------------+</span><br><span class="line">Output:</span><br><span class="line">+------------+--------------+--------------+----------------+</span><br><span class="line">| student_id | student_name | subject_name | attended_exams |</span><br><span class="line">+------------+--------------+--------------+----------------+</span><br><span class="line">| 1          | Alice        | Math         | 3              |</span><br><span class="line">| 1          | Alice        | Physics      | 2              |</span><br><span class="line">| 1          | Alice        | Programming  | 1              |</span><br><span class="line">| 2          | Bob          | Math         | 1              |</span><br><span class="line">| 2          | Bob          | Physics      | 0              |</span><br><span class="line">| 2          | Bob          | Programming  | 1              |</span><br><span class="line">| 6          | Alex         | Math         | 0              |</span><br><span class="line">| 6          | Alex         | Physics      | 0              |</span><br><span class="line">| 6          | Alex         | Programming  | 0              |</span><br><span class="line">| 13         | John         | Math         | 1              |</span><br><span class="line">| 13         | John         | Physics      | 1              |</span><br><span class="line">| 13         | John         | Programming  | 1              |</span><br><span class="line">+------------+--------------+--------------+----------------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> a.student_id, a.student_name, b.subject_name, <span class="built_in">COUNT</span>(e.subject_name) <span class="keyword">AS</span> attended_exams</span><br><span class="line"><span class="keyword">FROM</span> Students a</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> Subjects b</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Examinations e</span><br><span class="line"><span class="keyword">ON</span> a.student_id <span class="operator">=</span> e.student_id</span><br><span class="line"><span class="keyword">AND</span> b.subject_name <span class="operator">=</span> e.subject_name</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a.student_id, b.subject_name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.student_id, b.subject_name</span><br></pre></td></tr></table></figure>
<h2 id="Managers-with-at-Least-5-Direct-Reports-Medium"><a href="#Managers-with-at-Least-5-Direct-Reports-Medium" class="headerlink" title="Managers with at Least 5 Direct Reports - Medium"></a>Managers with at Least 5 Direct Reports - Medium</h2><p>至少有 5 名直接下属的经理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Employee</span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| id          | int     |</span><br><span class="line">| name        | varchar |</span><br><span class="line">| department  | varchar |</span><br><span class="line">| managerId   | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">id is the primary key column.</span><br></pre></td></tr></table></figure>
<p>查询至少有 5 名直接下属的经理。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employee table:</span><br><span class="line">+-----+-------+------------+-----------+</span><br><span class="line">| id  | name  | department | managerId |</span><br><span class="line">+-----+-------+------------+-----------+</span><br><span class="line">| 101 | John  | A          | None      |</span><br><span class="line">| 102 | Dan   | A          | 101       |</span><br><span class="line">| 103 | James | A          | 101       |</span><br><span class="line">| 104 | Amy   | A          | 101       |</span><br><span class="line">| 105 | Anne  | A          | 101       |</span><br><span class="line">| 106 | Ron   | B          | 101       |</span><br><span class="line">+-----+-------+------------+-----------+</span><br><span class="line">Output:</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| John |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> name</span><br><span class="line"><span class="keyword">FROM</span> employee <span class="keyword">AS</span> t1 <span class="keyword">JOIN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> managerID</span><br><span class="line">    <span class="keyword">FROM</span> employee</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> managerID</span><br><span class="line">    <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(managerID) <span class="operator">&gt;=</span> <span class="number">5</span>) <span class="keyword">AS</span> t2</span><br><span class="line">    <span class="keyword">ON</span> t1.id <span class="operator">=</span> t2.managerID</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Confirmation-Rate-Medium"><a href="#Confirmation-Rate-Medium" class="headerlink" title="Confirmation Rate - Medium"></a>Confirmation Rate - Medium</h2><p>确认率：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Table: Signups</span><br><span class="line">+----------------+----------+</span><br><span class="line">| Column Name    | Type     |</span><br><span class="line">+----------------+----------+</span><br><span class="line">| user_id        | int      |</span><br><span class="line">| time_stamp     | datetime |</span><br><span class="line">+----------------+----------+</span><br><span class="line">user_id is the primary key.</span><br><span class="line"></span><br><span class="line">Table: Confirmations</span><br><span class="line">+----------------+----------+</span><br><span class="line">| Column Name    | Type     |</span><br><span class="line">+----------------+----------+</span><br><span class="line">| user_id        | int      |</span><br><span class="line">| time_stamp     | datetime |</span><br><span class="line">| action         | ENUM     |</span><br><span class="line">+----------------+----------+</span><br><span class="line">(user_id, time_stamp) is the primary key.</span><br><span class="line">user_id is a foreign key.</span><br></pre></td></tr></table></figure>
<p>用户的确认率是 ‘confirmed’ 消息的数量除以请求的确认消息的总数。没有请求任何确认消息的用户的确认率为 0 。确认率四舍五入到小数点后两位。</p>
<p>查找每个用户的确认率。</p>
<p>以任意顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Signups table:</span><br><span class="line">+---------+---------------------+</span><br><span class="line">| user_id | time_stamp          |</span><br><span class="line">+---------+---------------------+</span><br><span class="line">| 3       | 2020-03-21 10:16:13 |</span><br><span class="line">| 7       | 2020-01-04 13:57:59 |</span><br><span class="line">| 2       | 2020-07-29 23:09:44 |</span><br><span class="line">| 6       | 2020-12-09 10:39:37 |</span><br><span class="line">+---------+---------------------+</span><br><span class="line">Confirmations table:</span><br><span class="line">+---------+---------------------+-----------+</span><br><span class="line">| user_id | time_stamp          | action    |</span><br><span class="line">+---------+---------------------+-----------+</span><br><span class="line">| 3       | 2021-01-06 03:30:46 | timeout   |</span><br><span class="line">| 3       | 2021-07-14 14:00:00 | timeout   |</span><br><span class="line">| 7       | 2021-06-12 11:57:29 | confirmed |</span><br><span class="line">| 7       | 2021-06-13 12:58:28 | confirmed |</span><br><span class="line">| 7       | 2021-06-14 13:59:27 | confirmed |</span><br><span class="line">| 2       | 2021-01-22 00:00:00 | confirmed |</span><br><span class="line">| 2       | 2021-02-28 23:59:59 | timeout   |</span><br><span class="line">+---------+---------------------+-----------+</span><br><span class="line">Output:</span><br><span class="line">+---------+-------------------+</span><br><span class="line">| user_id | confirmation_rate |</span><br><span class="line">+---------+-------------------+</span><br><span class="line">| 6       | 0.00              |</span><br><span class="line">| 3       | 0.00              |</span><br><span class="line">| 7       | 1.00              |</span><br><span class="line">| 2       | 0.50              |</span><br><span class="line">+---------+-------------------+</span><br><span class="line">解释:</span><br><span class="line">用户 6 没有请求任何确认消息。确认率为 0。</span><br><span class="line">用户 3 进行了 2 次请求，都超时了。确认率为 0。</span><br><span class="line">用户 7 提出了 3 个请求，所有请求都得到了确认。确认率为 1。</span><br><span class="line">用户 2 做了 2 个请求，其中一个被确认，另一个超时。确认率为 1 &#x2F; 2 &#x3D; 0.5。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> s.user_id, IFNULL(ROUND(<span class="built_in">SUM</span>(action <span class="operator">=</span> <span class="string">&#x27;confirmed&#x27;</span>) <span class="operator">/</span> <span class="built_in">COUNT</span>(c.action), <span class="number">2</span>), <span class="number">0.00</span>) <span class="keyword">AS</span> confirmation_rate</span><br><span class="line"><span class="keyword">FROM</span> signups <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> confirmations <span class="keyword">AS</span> c</span><br><span class="line"><span class="keyword">ON</span> s.user_id <span class="operator">=</span> c.user_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> s.user_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Not-Boring-Movies-Easy"><a href="#Not-Boring-Movies-Easy" class="headerlink" title="Not Boring Movies - Easy"></a>Not Boring Movies - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Cinema table:</span><br><span class="line">+----+------------+-------------+--------+</span><br><span class="line">| id | movie      | description | rating |</span><br><span class="line">+----+------------+-------------+--------+</span><br><span class="line">| 1  | War        | great 3D    | 8.9    |</span><br><span class="line">| 2  | Science    | fiction     | 8.5    |</span><br><span class="line">| 3  | irish      | boring      | 6.2    |</span><br><span class="line">| 4  | Ice song   | Fantacy     | 8.6    |</span><br><span class="line">| 5  | House card | Interesting | 9.1    |</span><br><span class="line">+----+------------+-------------+--------+</span><br><span class="line">Output:</span><br><span class="line">+----+------------+-------------+--------+</span><br><span class="line">| id | movie      | description | rating |</span><br><span class="line">+----+------------+-------------+--------+</span><br><span class="line">| 5  | House card | Interesting | 9.1    |</span><br><span class="line">| 1  | War        | great 3D    | 8.9    |</span><br><span class="line">+----+------------+-------------+--------+</span><br></pre></td></tr></table></figure>
<p>找出所有影片描述为非 boring 的且 id 为奇数的影片，结果请按等级 rating 排列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> cinema</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">MOD</span>(id, <span class="number">2</span>) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> description <span class="operator">!=</span> <span class="string">&#x27;boring&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> rating <span class="keyword">DESC</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> cinema</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">%</span> <span class="number">2</span> <span class="operator">&lt;&gt;</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">AND</span> description <span class="operator">&lt;&gt;</span> <span class="string">&#x27;boring&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> rating <span class="keyword">DESC</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Average-Selling-Price-Easy"><a href="#Average-Selling-Price-Easy" class="headerlink" title="Average Selling Price - Easy"></a>Average Selling Price - Easy</h2><p>平均售价：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Table: Prices</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| product_id    | int     |</span><br><span class="line">| start_date    | date    |</span><br><span class="line">| end_date      | date    |</span><br><span class="line">| price         | int     |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(product_id, start_date, end_date) is the primary key.</span><br><span class="line"></span><br><span class="line">Table: UnitsSold</span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| product_id    | int     |</span><br><span class="line">| purchase_date | date    |</span><br><span class="line">| units         | int     |</span><br><span class="line">+---------------+---------+</span><br><span class="line">There is no primary key for this table, it may contain duplicates.</span><br></pre></td></tr></table></figure>
<p>查找每种产品的平均售价。average_price 应该四舍五入到小数点后两位。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Prices table:</span><br><span class="line">+------------+------------+------------+--------+</span><br><span class="line">| product_id | start_date | end_date   | price  |</span><br><span class="line">+------------+------------+------------+--------+</span><br><span class="line">| 1          | 2019-02-17 | 2019-02-28 | 5      |</span><br><span class="line">| 1          | 2019-03-01 | 2019-03-22 | 20     |</span><br><span class="line">| 2          | 2019-02-01 | 2019-02-20 | 15     |</span><br><span class="line">| 2          | 2019-02-21 | 2019-03-31 | 30     |</span><br><span class="line">+------------+------------+------------+--------+</span><br><span class="line">UnitsSold table:</span><br><span class="line">+------------+---------------+-------+</span><br><span class="line">| product_id | purchase_date | units |</span><br><span class="line">+------------+---------------+-------+</span><br><span class="line">| 1          | 2019-02-25    | 100   |</span><br><span class="line">| 1          | 2019-03-01    | 15    |</span><br><span class="line">| 2          | 2019-02-10    | 200   |</span><br><span class="line">| 2          | 2019-03-22    | 30    |</span><br><span class="line">+------------+---------------+-------+</span><br><span class="line">Output:</span><br><span class="line">+------------+---------------+</span><br><span class="line">| product_id | average_price |</span><br><span class="line">+------------+---------------+</span><br><span class="line">| 1          | 6.96          |</span><br><span class="line">| 2          | 16.96         |</span><br><span class="line">+------------+---------------+</span><br><span class="line"></span><br><span class="line">平均售价 &#x3D; 产品总价 &#x2F; 销售的产品数量。</span><br><span class="line">产品 1 的平均售价 &#x3D; ((100 * 5)+(15 * 20) )&#x2F; 115 &#x3D; 6.96</span><br><span class="line">产品 2 的平均售价 &#x3D; ((200 * 15)+(30 * 30) )&#x2F; 230 &#x3D; 16.96</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    product_id,</span><br><span class="line">    Round(<span class="built_in">SUM</span>(sales) <span class="operator">/</span> <span class="built_in">SUM</span>(units), <span class="number">2</span>) <span class="keyword">AS</span> average_price</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        Prices.product_id <span class="keyword">AS</span> product_id,</span><br><span class="line">        Prices.price <span class="operator">*</span> UnitsSold.units <span class="keyword">AS</span> sales,</span><br><span class="line">        UnitsSold.units <span class="keyword">AS</span> units</span><br><span class="line">    <span class="keyword">FROM</span> Prices</span><br><span class="line">    <span class="keyword">JOIN</span> UnitsSold <span class="keyword">ON</span> Prices.product_id <span class="operator">=</span> UnitsSold.product_id</span><br><span class="line">    <span class="keyword">WHERE</span> UnitsSold.purchase_date <span class="keyword">BETWEEN</span> Prices.start_date <span class="keyword">AND</span> Prices.end_date</span><br><span class="line">) T</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> product_id</span><br></pre></td></tr></table></figure>
<h2 id="Project-Employees-I-Easy"><a href="#Project-Employees-I-Easy" class="headerlink" title="Project Employees I - Easy"></a>Project Employees I - Easy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Table: Project</span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| project_id  | int     |</span><br><span class="line">| employee_id | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">(project_id, employee_id) is the primary key of this table.</span><br><span class="line">employee_id is a foreign key to Employee table.</span><br><span class="line"></span><br><span class="line">Table: Employee</span><br><span class="line">+------------------+---------+</span><br><span class="line">| Column Name      | Type    |</span><br><span class="line">+------------------+---------+</span><br><span class="line">| employee_id      | int     |</span><br><span class="line">| name             | varchar |</span><br><span class="line">| experience_years | int     |</span><br><span class="line">+------------------+---------+</span><br><span class="line">employee_id is the primary key.</span><br></pre></td></tr></table></figure>
<p>查询每一个项目中员工的 平均 工作年限，精确到小数点后两位。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Project table:</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| project_id  | employee_id |</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| 1           | 1           |</span><br><span class="line">| 1           | 2           |</span><br><span class="line">| 1           | 3           |</span><br><span class="line">| 2           | 1           |</span><br><span class="line">| 2           | 4           |</span><br><span class="line">+-------------+-------------+</span><br><span class="line">Employee table:</span><br><span class="line">+-------------+--------+------------------+</span><br><span class="line">| employee_id | name   | experience_years |</span><br><span class="line">+-------------+--------+------------------+</span><br><span class="line">| 1           | Khaled | 3                |</span><br><span class="line">| 2           | Ali    | 2                |</span><br><span class="line">| 3           | John   | 1                |</span><br><span class="line">| 4           | Doe    | 2                |</span><br><span class="line">+-------------+--------+------------------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+---------------+</span><br><span class="line">| project_id  | average_years |</span><br><span class="line">+-------------+---------------+</span><br><span class="line">| 1           | 2.00          |</span><br><span class="line">| 2           | 2.50          |</span><br><span class="line">+-------------+---------------+</span><br><span class="line">第一个项目中，员工的平均工作年限是 (3 + 2 + 1) &#x2F; 3 &#x3D; 2.00；第二个项目中，员工的平均工作年限是 (3 + 2) &#x2F; 2 &#x3D; 2.50</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    p.project_id,</span><br><span class="line">    ROUND(<span class="built_in">AVG</span>(e.experience_years), <span class="number">2</span>) <span class="keyword">AS</span> average_years</span><br><span class="line"><span class="keyword">FROM</span> project p, employee e</span><br><span class="line"><span class="keyword">WHERE</span> p.employee_id <span class="operator">=</span> e.employee_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> p.project_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Percentage-of-Users-Attended-a-Contest-Easy"><a href="#Percentage-of-Users-Attended-a-Contest-Easy" class="headerlink" title="Percentage of Users Attended a Contest - Easy"></a>Percentage of Users Attended a Contest - Easy</h2><p>各赛事的用户注册率：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Table: Users</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| user_id     | int     |</span><br><span class="line">| user_name   | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">user_id is the primary key.</span><br><span class="line"></span><br><span class="line">Table: Register</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| contest_id  | int     |</span><br><span class="line">| user_id     | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">(contest_id, user_id) is the primary key.</span><br></pre></td></tr></table></figure>
<p>查询各赛事的用户注册百分率，保留两位小数。</p>
<p>返回的结果表按 percentage 的 降序 排序，若相同则按 contest_id 的 升序 排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Users table:</span><br><span class="line">+---------+-----------+</span><br><span class="line">| user_id | user_name |</span><br><span class="line">+---------+-----------+</span><br><span class="line">| 6       | Alice     |</span><br><span class="line">| 2       | Bob       |</span><br><span class="line">| 7       | Alex      |</span><br><span class="line">+---------+-----------+</span><br><span class="line">Register table:</span><br><span class="line">+------------+---------+</span><br><span class="line">| contest_id | user_id |</span><br><span class="line">+------------+---------+</span><br><span class="line">| 215        | 6       |</span><br><span class="line">| 209        | 2       |</span><br><span class="line">| 208        | 2       |</span><br><span class="line">| 210        | 6       |</span><br><span class="line">| 208        | 6       |</span><br><span class="line">| 209        | 7       |</span><br><span class="line">| 209        | 6       |</span><br><span class="line">| 215        | 7       |</span><br><span class="line">| 208        | 7       |</span><br><span class="line">| 210        | 2       |</span><br><span class="line">| 207        | 2       |</span><br><span class="line">| 210        | 7       |</span><br><span class="line">+------------+---------+</span><br><span class="line">Output:</span><br><span class="line">+------------+------------+</span><br><span class="line">| contest_id | percentage |</span><br><span class="line">+------------+------------+</span><br><span class="line">| 208        | 100.0      |</span><br><span class="line">| 209        | 100.0      |</span><br><span class="line">| 210        | 100.0      |</span><br><span class="line">| 215        | 66.67      |</span><br><span class="line">| 207        | 33.33      |</span><br><span class="line">+------------+------------+</span><br><span class="line"></span><br><span class="line">解释：</span><br><span class="line">所有用户都注册了 208、209 和 210 赛事，因此这些赛事的注册率为 100% ，我们按 contest_id 的降序排序加入结果表中。</span><br><span class="line">Alice 和 Alex 注册了 215 赛事，注册率为 ((2&#x2F;3) * 100) &#x3D; 66.67%</span><br><span class="line">Bob 注册了 207 赛事，注册率为 ((1&#x2F;3) * 100) &#x3D; 33.33%</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    contest_id,</span><br><span class="line">    ROUND(<span class="built_in">COUNT</span>(user_id) <span class="operator">*</span> <span class="number">100</span> <span class="operator">/</span> (<span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> users), <span class="number">2</span>) percentage</span><br><span class="line"><span class="keyword">FROM</span> Register</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> contest_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> percentage <span class="keyword">desc</span>, contest_id</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    contest_id,</span><br><span class="line">    <span class="keyword">CONVERT</span>(<span class="type">DECIMAL</span>(<span class="number">18</span>, <span class="number">2</span>), <span class="built_in">COUNT</span>(user_id <span class="operator">*</span> <span class="number">1.00</span>) <span class="operator">*</span> <span class="number">100</span> <span class="operator">/</span> (<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">*</span> <span class="number">1.00</span> <span class="keyword">FROM</span> users)) percentage</span><br><span class="line"><span class="keyword">FROM</span> Register</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> contest_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> percentage <span class="keyword">desc</span>, contest_id</span><br></pre></td></tr></table></figure>
<h2 id="Queries-Quality-and-Percentage-Easy"><a href="#Queries-Quality-and-Percentage-Easy" class="headerlink" title="Queries Quality and Percentage - Easy"></a>Queries Quality and Percentage - Easy</h2><p>查询结果的质量和占比：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Table: Queries</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| query_name  | varchar |</span><br><span class="line">| result      | varchar |</span><br><span class="line">| position    | int     |</span><br><span class="line">| rating      | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line"></span><br><span class="line">此表没有主键，并可能有重复的行。</span><br><span class="line">此表包含了一些从数据库中收集的查询信息。</span><br><span class="line">“位置”（position）列的值为 1 到 500 。</span><br><span class="line">“评分”（rating）列的值为 1 到 5 。评分小于 3 的查询被定义为质量很差的查询。</span><br></pre></td></tr></table></figure>
<p>将查询结果的质量 quality 定义为：</p>
<p>各查询结果的评分与其位置之间比率的平均值。</p>
<p>将劣质查询百分比 poor_query_percentage 为：</p>
<p>评分小于 3 的查询结果占全部查询结果的百分比。</p>
<p>编写一组 SQL 来查找每次查询的名称(query_name)、质量(quality) 和 劣质查询百分比(poor_query_percentage)。</p>
<p>质量(quality) 和劣质查询百分比(poor_query_percentage) 都应四舍五入到小数点后两位。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Queries table:</span><br><span class="line">+------------+-------------------+----------+--------+</span><br><span class="line">| query_name | result            | position | rating |</span><br><span class="line">+------------+-------------------+----------+--------+</span><br><span class="line">| Dog        | Golden Retriever  | 1        | 5      |</span><br><span class="line">| Dog        | German Shepherd   | 2        | 5      |</span><br><span class="line">| Dog        | Mule              | 200      | 1      |</span><br><span class="line">| Cat        | Shirazi           | 5        | 2      |</span><br><span class="line">| Cat        | Siamese           | 3        | 3      |</span><br><span class="line">| Cat        | Sphynx            | 7        | 4      |</span><br><span class="line">+------------+-------------------+----------+--------+</span><br><span class="line">Output:</span><br><span class="line">+------------+---------+-----------------------+</span><br><span class="line">| query_name | quality | poor_query_percentage |</span><br><span class="line">+------------+---------+-----------------------+</span><br><span class="line">| Dog        | 2.50    | 33.33                 |</span><br><span class="line">| Cat        | 0.66    | 33.33                 |</span><br><span class="line">+------------+---------+-----------------------+</span><br><span class="line">Dog 查询结果的质量为 ((5 &#x2F; 1) + (5 &#x2F; 2) + (1 &#x2F; 200)) &#x2F; 3 &#x3D; 2.50</span><br><span class="line">Dog 查询结果的劣质查询百分比为 (1 &#x2F; 3) * 100 &#x3D; 33.33</span><br><span class="line"></span><br><span class="line">Cat 查询结果的质量为 ((2 &#x2F; 5) + (3 &#x2F; 3) + (4 &#x2F; 7)) &#x2F; 3 &#x3D; 0.66</span><br><span class="line">Cat 查询结果的劣质查询百分比为 (1 &#x2F; 3) * 100 &#x3D; 33.33</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    query_name,</span><br><span class="line">    ROUND(<span class="built_in">AVG</span>(rating<span class="operator">/</span>position), <span class="number">2</span>) quality,</span><br><span class="line">    ROUND(<span class="built_in">SUM</span>(IF(rating <span class="operator">&lt;</span> <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>)) <span class="operator">*</span> <span class="number">100</span> <span class="operator">/</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>), <span class="number">2</span>) poor_query_percentage</span><br><span class="line"><span class="keyword">FROM</span> Queries</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> query_name</span><br></pre></td></tr></table></figure>
<h2 id="Monthly-Transactions-I-Medium"><a href="#Monthly-Transactions-I-Medium" class="headerlink" title="Monthly Transactions I - Medium"></a>Monthly Transactions I - Medium</h2><p>每月交易 I：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Table: Transactions</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| country       | varchar |</span><br><span class="line">| state         | enum    |</span><br><span class="line">| amount        | int     |</span><br><span class="line">| trans_date    | date    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">id is the primary key</span><br><span class="line">The state column is an enum of type [&quot;approved&quot;, &quot;declined&quot;].</span><br></pre></td></tr></table></figure>
<p>查找每个月和每个国家/地区的事务数及其总金额、已批准的事务数及其总金额。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Transactions table:</span><br><span class="line">+------+---------+----------+--------+------------+</span><br><span class="line">| id   | country | state    | amount | trans_date |</span><br><span class="line">+------+---------+----------+--------+------------+</span><br><span class="line">| 121  | US      | approved | 1000   | 2018-12-18 |</span><br><span class="line">| 122  | US      | declined | 2000   | 2018-12-19 |</span><br><span class="line">| 123  | US      | approved | 2000   | 2019-01-01 |</span><br><span class="line">| 124  | DE      | approved | 2000   | 2019-01-07 |</span><br><span class="line">+------+---------+----------+--------+------------+</span><br><span class="line">Output:</span><br><span class="line">+----------+---------+-------------+----------------+--------------------+-----------------------+</span><br><span class="line">| month    | country | trans_count | approved_count | trans_total_amount | approved_total_amount |</span><br><span class="line">+----------+---------+-------------+----------------+--------------------+-----------------------+</span><br><span class="line">| 2018-12  | US      | 2           | 1              | 3000               | 1000                  |</span><br><span class="line">| 2019-01  | US      | 1           | 1              | 2000               | 2000                  |</span><br><span class="line">| 2019-01  | DE      | 1           | 1              | 2000               | 2000                  |</span><br><span class="line">+----------+---------+-------------+----------------+--------------------+-----------------------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    DATE_FORMAT(trans_date, <span class="string">&#x27;%Y-%m&#x27;</span>) <span class="keyword">AS</span> <span class="keyword">month</span>,</span><br><span class="line">    country,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> trans_count,</span><br><span class="line">    <span class="built_in">COUNT</span>(IF(state <span class="operator">=</span> <span class="string">&#x27;approved&#x27;</span>, <span class="number">1</span>, <span class="keyword">NULL</span>)) <span class="keyword">AS</span> approved_count,</span><br><span class="line">    <span class="built_in">SUM</span>(amount) <span class="keyword">AS</span> trans_total_amount,</span><br><span class="line">    <span class="built_in">SUM</span>(IF(state <span class="operator">=</span> <span class="string">&#x27;approved&#x27;</span>, amount, <span class="number">0</span>)) <span class="keyword">AS</span> approved_total_amount</span><br><span class="line"><span class="keyword">FROM</span> transactions</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">month</span>, country</span><br></pre></td></tr></table></figure>
<h2 id="Immediate-Food-Delivery-II-Medium"><a href="#Immediate-Food-Delivery-II-Medium" class="headerlink" title="Immediate Food Delivery II - Medium"></a>Immediate Food Delivery II - Medium</h2><p>即时食物配送 II：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Delivery</span><br><span class="line"></span><br><span class="line">+-----------------------------+---------+</span><br><span class="line">| Column Name                 | Type    |</span><br><span class="line">+-----------------------------+---------+</span><br><span class="line">| delivery_id                 | int     |</span><br><span class="line">| customer_id                 | int     |</span><br><span class="line">| order_date                  | date    |</span><br><span class="line">| customer_pref_delivery_date | date    |</span><br><span class="line">+-----------------------------+---------+</span><br><span class="line">delivery_id is the primary key</span><br></pre></td></tr></table></figure>
<p>如果顾客期望的配送日期和下单日期相同，则该订单称为 「即时订单」，否则称为「计划订单」。</p>
<p>「首次订单」是顾客最早创建的订单。我们保证一个顾客只会有一个「首次订单」。</p>
<p>写一条 SQL 查询语句获取即时订单在所有用户的首次订单中的比例。保留两位小数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Delivery table:</span><br><span class="line">+-------------+-------------+------------+-----------------------------+</span><br><span class="line">| delivery_id | customer_id | order_date | customer_pref_delivery_date |</span><br><span class="line">+-------------+-------------+------------+-----------------------------+</span><br><span class="line">| 1           | 1           | 2019-08-01 | 2019-08-02                  |</span><br><span class="line">| 2           | 2           | 2019-08-02 | 2019-08-02                  |</span><br><span class="line">| 3           | 1           | 2019-08-11 | 2019-08-12                  |</span><br><span class="line">| 4           | 3           | 2019-08-24 | 2019-08-24                  |</span><br><span class="line">| 5           | 3           | 2019-08-21 | 2019-08-22                  |</span><br><span class="line">| 6           | 2           | 2019-08-11 | 2019-08-13                  |</span><br><span class="line">| 7           | 4           | 2019-08-09 | 2019-08-09                  |</span><br><span class="line">+-------------+-------------+------------+-----------------------------+</span><br><span class="line">Output:</span><br><span class="line">+----------------------+</span><br><span class="line">| immediate_percentage |</span><br><span class="line">+----------------------+</span><br><span class="line">| 50.00                |</span><br><span class="line">+----------------------+</span><br><span class="line"></span><br><span class="line">1 号顾客的 1 号订单是首次订单，并且是计划订单。</span><br><span class="line">2 号顾客的 2 号订单是首次订单，并且是即时订单。</span><br><span class="line">3 号顾客的 5 号订单是首次订单，并且是计划订单。</span><br><span class="line">4 号顾客的 7 号订单是首次订单，并且是即时订单。</span><br><span class="line">因此，一半顾客的首次订单是即时的。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    ROUND(<span class="built_in">SUM</span>(order_date <span class="operator">=</span> customer_pref_delivery_date) <span class="operator">*</span> <span class="number">100</span> <span class="operator">/</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>), <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">AS</span> immediate_percentage</span><br><span class="line"><span class="keyword">FROM</span> delivery</span><br><span class="line"><span class="keyword">WHERE</span> (customer_id, order_date) <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> customer_id, <span class="built_in">min</span>(order_date)</span><br><span class="line">    <span class="keyword">FROM</span> delivery</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="Game-Play-Analysis-IV-Medium"><a href="#Game-Play-Analysis-IV-Medium" class="headerlink" title="Game Play Analysis IV - Medium"></a>Game Play Analysis IV - Medium</h2><p>游戏玩法分析 IV：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Activity</span><br><span class="line"></span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| player_id    | int     |</span><br><span class="line">| device_id    | int     |</span><br><span class="line">| event_date   | date    |</span><br><span class="line">| games_played | int     |</span><br><span class="line">+--------------+---------+</span><br><span class="line">(player_id, event_date) is the primary key</span><br></pre></td></tr></table></figure>
<p>编写一个 SQL 查询，报告在首次登录的第二天再次登录的玩家的比率，四舍五入到小数点后两位。换句话说，您需要计算从首次登录日期开始至少连续两天登录的玩家的数量，然后除以玩家总数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Activity table:</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">| player_id | device_id | event_date | games_played |</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">| 1         | 2         | 2016-03-01 | 5            |</span><br><span class="line">| 1         | 2         | 2016-03-02 | 6            |</span><br><span class="line">| 2         | 3         | 2017-06-25 | 1            |</span><br><span class="line">| 3         | 1         | 2016-03-02 | 0            |</span><br><span class="line">| 3         | 4         | 2018-07-03 | 5            |</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">Output:</span><br><span class="line">+-----------+</span><br><span class="line">| fraction  |</span><br><span class="line">+-----------+</span><br><span class="line">| 0.33      |</span><br><span class="line">+-----------+</span><br><span class="line">只有 ID 为 1 的玩家在第一天登录后才重新登录，所以答案是 1&#x2F;3 &#x3D; 0.33</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="built_in">AVG</span>(a.event_date <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>), <span class="number">2</span>) fraction</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (<span class="keyword">SELECT</span> player_id, <span class="built_in">min</span>(event_date) <span class="keyword">AS</span> login</span><br><span class="line">    <span class="keyword">FROM</span> activity</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> player_id) p</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> activity a</span><br><span class="line"><span class="keyword">ON</span> p.player_id <span class="operator">=</span> a.player_id <span class="keyword">AND</span> datediff(a.event_date, p.login) <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="Number-of-Unique-Subjects-Taught-by-Each-Teacher-Easy"><a href="#Number-of-Unique-Subjects-Taught-by-Each-Teacher-Easy" class="headerlink" title="Number of Unique Subjects Taught by Each Teacher - Easy"></a>Number of Unique Subjects Taught by Each Teacher - Easy</h2><p>每位教师所教授的科目种类的数量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Teacher</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| teacher_id  | int  |</span><br><span class="line">| subject_id  | int  |</span><br><span class="line">| dept_id     | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">(subject_id, dept_id) is the primary key</span><br></pre></td></tr></table></figure>
<p>查询每位老师在大学里教授的科目种类的数量。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Teacher table:</span><br><span class="line">+------------+------------+---------+</span><br><span class="line">| teacher_id | subject_id | dept_id |</span><br><span class="line">+------------+------------+---------+</span><br><span class="line">| 1          | 2          | 3       |</span><br><span class="line">| 1          | 2          | 4       |</span><br><span class="line">| 1          | 3          | 3       |</span><br><span class="line">| 2          | 1          | 1       |</span><br><span class="line">| 2          | 2          | 1       |</span><br><span class="line">| 2          | 3          | 1       |</span><br><span class="line">| 2          | 4          | 1       |</span><br><span class="line">+------------+------------+---------+</span><br><span class="line">Output:</span><br><span class="line">+------------+-----+</span><br><span class="line">| teacher_id | cnt |</span><br><span class="line">+------------+-----+</span><br><span class="line">| 1          | 2   |</span><br><span class="line">| 2          | 4   |</span><br><span class="line">+------------+-----+</span><br><span class="line">解释:</span><br><span class="line">教师 1:</span><br><span class="line">  - 他在 3、4 系教科目 2。</span><br><span class="line">  - 他在 3 系教科目 3。</span><br><span class="line">教师 2:</span><br><span class="line">  - 他在 1 系教科目 1。</span><br><span class="line">  - 他在 1 系教科目 2。</span><br><span class="line">  - 他在 1 系教科目 3。</span><br><span class="line">  - 他在 1 系教科目 4。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> teacher_id, <span class="built_in">COUNT</span>(<span class="keyword">distinct</span> subject_id) <span class="keyword">AS</span> cnt</span><br><span class="line"><span class="keyword">FROM</span> teacher</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> teacher_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="User-Activity-for-the-Past-30-Days-I-Easy"><a href="#User-Activity-for-the-Past-30-Days-I-Easy" class="headerlink" title="User Activity for the Past 30 Days I - Easy"></a>User Activity for the Past 30 Days I - Easy</h2><p>查询近 30 天活跃用户数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Activity</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| user_id       | int     |</span><br><span class="line">| session_id    | int     |</span><br><span class="line">| activity_date | date    |</span><br><span class="line">| activity_type | enum    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">There is no primary key for this table, it may have duplicate rows.</span><br></pre></td></tr></table></figure>
<p>请写SQL查询出截至 2019-07-27（包含2019-07-27），近 30 天的每日活跃用户数（当天只要有一条活动记录，即为活跃用户）。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Activity table:</span><br><span class="line">+---------+------------+---------------+---------------+</span><br><span class="line">| user_id | session_id | activity_date | activity_type |</span><br><span class="line">+---------+------------+---------------+---------------+</span><br><span class="line">| 1       | 1          | 2019-07-20    | open_session  |</span><br><span class="line">| 1       | 1          | 2019-07-20    | scroll_down   |</span><br><span class="line">| 1       | 1          | 2019-07-20    | end_session   |</span><br><span class="line">| 2       | 4          | 2019-07-20    | open_session  |</span><br><span class="line">| 2       | 4          | 2019-07-21    | send_message  |</span><br><span class="line">| 2       | 4          | 2019-07-21    | end_session   |</span><br><span class="line">| 3       | 2          | 2019-07-21    | open_session  |</span><br><span class="line">| 3       | 2          | 2019-07-21    | send_message  |</span><br><span class="line">| 3       | 2          | 2019-07-21    | end_session   |</span><br><span class="line">| 4       | 3          | 2019-06-25    | open_session  |</span><br><span class="line">| 4       | 3          | 2019-06-25    | end_session   |</span><br><span class="line">+---------+------------+---------------+---------------+</span><br><span class="line">Output:</span><br><span class="line">+------------+--------------+</span><br><span class="line">| day        | active_users |</span><br><span class="line">+------------+--------------+</span><br><span class="line">| 2019-07-20 | 2            |</span><br><span class="line">| 2019-07-21 | 2            |</span><br><span class="line">+------------+--------------+</span><br><span class="line">解释：注意非活跃用户的记录不需要展示。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> activity_date <span class="keyword">AS</span> <span class="keyword">day</span>, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span>(user_id)) <span class="keyword">AS</span> active_users</span><br><span class="line"><span class="keyword">FROM</span> Activity</span><br><span class="line"><span class="keyword">WHERE</span> DATEDIFF(<span class="string">&#x27;2019-7-27&#x27;</span>, activity_date) <span class="operator">&lt;</span> <span class="number">30</span> <span class="keyword">AND</span> activity_date <span class="operator">&lt;=</span> <span class="string">&#x27;2019-7-27&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> activity_date</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Sales-Analysis-III-Easy"><a href="#Sales-Analysis-III-Easy" class="headerlink" title="Sales Analysis III - Easy"></a>Sales Analysis III - Easy</h2><p>销售分析III：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Table: Product</span><br><span class="line"></span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| product_id   | int     |</span><br><span class="line">| product_name | varchar |</span><br><span class="line">| unit_price   | int     |</span><br><span class="line">+--------------+---------+</span><br><span class="line">product_id is the primary key</span><br><span class="line"></span><br><span class="line">Table: Sales</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| seller_id   | int     |</span><br><span class="line">| product_id  | int     |</span><br><span class="line">| buyer_id    | int     |</span><br><span class="line">| sale_date   | date    |</span><br><span class="line">| quantity    | int     |</span><br><span class="line">| price       | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">This table has no primary key, it can have repeated rows.</span><br><span class="line">product_id is a foreign key to the Product table.</span><br></pre></td></tr></table></figure>
<p>编写一个SQL查询，报告2019年春季才售出的产品。即仅在2019-01-01至2019-03-31（含）之间出售的商品。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Product table:</span><br><span class="line">+------------+--------------+------------+</span><br><span class="line">| product_id | product_name | unit_price |</span><br><span class="line">+------------+--------------+------------+</span><br><span class="line">| 1          | S8           | 1000       |</span><br><span class="line">| 2          | G4           | 800        |</span><br><span class="line">| 3          | iPhone       | 1400       |</span><br><span class="line">+------------+--------------+------------+</span><br><span class="line">Sales table:</span><br><span class="line">+-----------+------------+----------+------------+----------+-------+</span><br><span class="line">| seller_id | product_id | buyer_id | sale_date  | quantity | price |</span><br><span class="line">+-----------+------------+----------+------------+----------+-------+</span><br><span class="line">| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |</span><br><span class="line">| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |</span><br><span class="line">| 2         | 2          | 3        | 2019-06-02 | 1        | 800   |</span><br><span class="line">| 3         | 3          | 4        | 2019-05-13 | 2        | 2800  |</span><br><span class="line">+-----------+------------+----------+------------+----------+-------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| product_id  | product_name |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| 1           | S8           |</span><br><span class="line">+-------------+--------------+</span><br><span class="line"></span><br><span class="line">解释:</span><br><span class="line">id为1的产品仅在2019年春季销售。</span><br><span class="line">id为2的产品在2019年春季销售，但也在2019年春季之后销售。</span><br><span class="line">id 3的产品在2019年春季之后销售。</span><br><span class="line">我们只退回产品1，因为它是2019年春季才销售的产品。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    sales.product_id <span class="keyword">AS</span> product_id,</span><br><span class="line">    product.product_name <span class="keyword">AS</span> product_name</span><br><span class="line"><span class="keyword">FROM</span> sales</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> product</span><br><span class="line"><span class="keyword">ON</span> sales.product_id <span class="operator">=</span> product.product_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> product_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(sale_date <span class="keyword">BETWEEN</span> <span class="string">&#x27;2019-01-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2019-03-31&#x27;</span> <span class="keyword">OR</span> <span class="keyword">NULL</span>) <span class="operator">=</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Classes-More-Than-5-Students-Easy"><a href="#Classes-More-Than-5-Students-Easy" class="headerlink" title="Classes More Than 5 Students - Easy"></a>Classes More Than 5 Students - Easy</h2><p>超过 5 名学生的课：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Table: Courses</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| student     | varchar |</span><br><span class="line">| class       | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">(student, class) is the primary key column</span><br></pre></td></tr></table></figure>
<p>编写一个SQL查询来报告 至少有5个学生 的所有班级。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Courses table:</span><br><span class="line">+---------+----------+</span><br><span class="line">| student | class    |</span><br><span class="line">+---------+----------+</span><br><span class="line">| A       | Math     |</span><br><span class="line">| B       | English  |</span><br><span class="line">| C       | Math     |</span><br><span class="line">| D       | Biology  |</span><br><span class="line">| E       | Math     |</span><br><span class="line">| F       | Computer |</span><br><span class="line">| G       | Math     |</span><br><span class="line">| H       | Math     |</span><br><span class="line">| I       | Math     |</span><br><span class="line">+---------+----------+</span><br><span class="line">Output:</span><br><span class="line">+---------+</span><br><span class="line">| class   |</span><br><span class="line">+---------+</span><br><span class="line">| Math    |</span><br><span class="line">+---------+</span><br><span class="line"></span><br><span class="line">解释:</span><br><span class="line">-数学课有6个学生，所以我们包括它。</span><br><span class="line">-英语课有1名学生，所以我们不包括它。</span><br><span class="line">-生物课有1名学生，所以我们不包括它。</span><br><span class="line">-计算机课有1个学生，所以我们不包括它。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="comment">-- 方法一：使用 GROUP BY 子句和子查询</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    class</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (<span class="keyword">SELECT</span></span><br><span class="line">        class, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> student) <span class="keyword">AS</span> num</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        courses</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> class) <span class="keyword">AS</span> temp_table</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    num <span class="operator">&gt;=</span> <span class="number">5</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法二：使用 GROUP BY 和 HAVING 条件</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    class</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    courses</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> class</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> student) <span class="operator">&gt;=</span> <span class="number">5</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Find-Followers-Count-Easy"><a href="#Find-Followers-Count-Easy" class="headerlink" title="Find Followers Count - Easy"></a>Find Followers Count - Easy</h2><p>求关注者的数量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Table: Followers</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| user_id     | int  |</span><br><span class="line">| follower_id | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">(user_id, follower_id) is the primary key</span><br></pre></td></tr></table></figure>
<p>对于每一个用户，返回该用户的关注者数量。</p>
<p>按 user_id 的顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Followers table:</span><br><span class="line">+---------+-------------+</span><br><span class="line">| user_id | follower_id |</span><br><span class="line">+---------+-------------+</span><br><span class="line">| 0       | 1           |</span><br><span class="line">| 1       | 0           |</span><br><span class="line">| 2       | 0           |</span><br><span class="line">| 2       | 1           |</span><br><span class="line">+---------+-------------+</span><br><span class="line">Output:</span><br><span class="line">+---------+----------------+</span><br><span class="line">| user_id | followers_count|</span><br><span class="line">+---------+----------------+</span><br><span class="line">| 0       | 1              |</span><br><span class="line">| 1       | 1              |</span><br><span class="line">| 2       | 2              |</span><br><span class="line">+---------+----------------+</span><br><span class="line">解释：</span><br><span class="line">0 的关注者有 &#123;1&#125;</span><br><span class="line">1 的关注者有 &#123;0&#125;</span><br><span class="line">2 的关注者有 &#123;0,1&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> user_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> followers_count</span><br><span class="line"><span class="keyword">FROM</span> followers</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> user_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Biggest-Single-Number-Easy"><a href="#Biggest-Single-Number-Easy" class="headerlink" title="Biggest Single Number - Easy"></a>Biggest Single Number - Easy</h2><p>只出现一次的最大数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Table: MyNumbers</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| num         | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">There is no primary key</span><br></pre></td></tr></table></figure>
<p>单一数字 是在 MyNumbers 表中只出现一次的数字。</p>
<p>请你编写一个 SQL 查询来报告最大的 单一数字 。如果不存在 单一数字 ，查询需报告 null 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">MyNumbers table:</span><br><span class="line">+-----+</span><br><span class="line">| num |</span><br><span class="line">+-----+</span><br><span class="line">| 8   |</span><br><span class="line">| 8   |</span><br><span class="line">| 3   |</span><br><span class="line">| 3   |</span><br><span class="line">| 1   |</span><br><span class="line">| 4   |</span><br><span class="line">| 5   |</span><br><span class="line">| 6   |</span><br><span class="line">+-----+</span><br><span class="line">Output:</span><br><span class="line">+-----+</span><br><span class="line">| num |</span><br><span class="line">+-----+</span><br><span class="line">| 6   |</span><br><span class="line">+-----+</span><br><span class="line">解释：单一数字有 1、4、5 和 6 。</span><br><span class="line">6 是最大的单一数字，返回 6 。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(num) <span class="keyword">AS</span> num</span><br><span class="line"><span class="keyword">FROM</span>(<span class="keyword">SELECT</span> num</span><br><span class="line">    <span class="keyword">FROM</span> mynumbers</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> num</span><br><span class="line">    <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(num) <span class="operator">=</span> <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">AS</span> t</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Customers-Who-Bought-All-Products-Medium"><a href="#Customers-Who-Bought-All-Products-Medium" class="headerlink" title="Customers Who Bought All Products - Medium"></a>Customers Who Bought All Products - Medium</h2><p>买下所有产品的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Table: Customer</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| customer_id | int     |</span><br><span class="line">| product_key | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">There is no primary key</span><br><span class="line">product_key is a foreign key to Product table.</span><br><span class="line"></span><br><span class="line">Table: Product</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| product_key | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">product_key is the primary key</span><br></pre></td></tr></table></figure>
<p>从 Customer 表中查询购买了 Product 表中所有产品的客户的 id。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Customer table:</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| customer_id | product_key |</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| 1           | 5           |</span><br><span class="line">| 2           | 6           |</span><br><span class="line">| 3           | 5           |</span><br><span class="line">| 3           | 6           |</span><br><span class="line">| 1           | 6           |</span><br><span class="line">+-------------+-------------+</span><br><span class="line">Product table:</span><br><span class="line">+-------------+</span><br><span class="line">| product_key |</span><br><span class="line">+-------------+</span><br><span class="line">| 5           |</span><br><span class="line">| 6           |</span><br><span class="line">+-------------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+</span><br><span class="line">| customer_id |</span><br><span class="line">+-------------+</span><br><span class="line">| 1           |</span><br><span class="line">| 3           |</span><br><span class="line">+-------------+</span><br><span class="line">购买了所有产品（5 和 6）的客户的 id 是 1 和 3 。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> customer_id</span><br><span class="line"><span class="keyword">FROM</span> customer</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> product_key) <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> product_key)</span><br><span class="line">    <span class="keyword">FROM</span> product</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="The-Number-of-Employees-Which-Report-to-Each-Employee-Easy"><a href="#The-Number-of-Employees-Which-Report-to-Each-Employee-Easy" class="headerlink" title="The Number of Employees Which Report to Each Employee - Easy"></a>The Number of Employees Which Report to Each Employee - Easy</h2><p>每位经理的下属员工数量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Employees</span><br><span class="line"></span><br><span class="line">+-------------+----------+</span><br><span class="line">| Column Name | Type     |</span><br><span class="line">+-------------+----------+</span><br><span class="line">| employee_id | int      |</span><br><span class="line">| name        | varchar  |</span><br><span class="line">| reports_to  | int      |</span><br><span class="line">| age         | int      |</span><br><span class="line">+-------------+----------+</span><br><span class="line">employee_id is the primary key</span><br></pre></td></tr></table></figure>
<p>对于此问题，我们将至少有一个其他员工需要向他汇报的员工，视为一个经理。</p>
<p>编写SQL查询需要听取汇报的所有经理的ID、名称、直接向该经理汇报的员工人数，以及这些员工的平均年龄，其中该平均年龄需要四舍五入到最接近的整数。</p>
<p>返回的结果集需要按照 employee_id 进行排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employees table:</span><br><span class="line">+-------------+---------+------------+-----+</span><br><span class="line">| employee_id | name    | reports_to | age |</span><br><span class="line">+-------------+---------+------------+-----+</span><br><span class="line">| 9           | Hercy   | null       | 43  |</span><br><span class="line">| 6           | Alice   | 9          | 41  |</span><br><span class="line">| 4           | Bob     | 9          | 36  |</span><br><span class="line">| 2           | Winston | null       | 37  |</span><br><span class="line">+-------------+---------+------------+-----+</span><br><span class="line">Output:</span><br><span class="line">+-------------+-------+---------------+-------------+</span><br><span class="line">| employee_id | name  | reports_count | average_age |</span><br><span class="line">+-------------+-------+---------------+-------------+</span><br><span class="line">| 9           | Hercy | 2             | 39          |</span><br><span class="line">+-------------+-------+---------------+-------------+</span><br><span class="line"></span><br><span class="line">Hercy 有两个需要向他汇报的员工, 他们是 Alice and Bob. 他们的平均年龄是 (41+36)&#x2F;2 &#x3D; 38.5, 四舍五入的结果是 39.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    b.employee_id,</span><br><span class="line">    b.name,</span><br><span class="line">    <span class="built_in">COUNT</span>(a.name) reports_count,</span><br><span class="line">    ROUND(<span class="built_in">AVG</span>(a.age), <span class="number">0</span>) average_age</span><br><span class="line"><span class="keyword">FROM</span> Employees <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">JOIN</span> employees <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.reports_to <span class="operator">=</span> b.employee_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> b.employee_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> b.employee_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Primary-Department-for-Each-Employee-Easy"><a href="#Primary-Department-for-Each-Employee-Easy" class="headerlink" title="Primary Department for Each Employee - Easy"></a>Primary Department for Each Employee - Easy</h2><p>员工的直属部门：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Employee</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   |  Type   |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| employee_id   | int     |</span><br><span class="line">| department_id | int     |</span><br><span class="line">| primary_flag  | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(employee_id, department_id) is the primary key</span><br></pre></td></tr></table></figure>
<p>当一个员工加入超过一个部门的时候，他需要决定哪个部门是他的直属部门。</p>
<p>请注意，当员工只加入一个部门的时候，那这个部门将默认为他的直属部门，虽然表记录的值为’N’.</p>
<p>请编写一段SQL，查出员工所属的直属部门。</p>
<p>返回结果没有顺序要求。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employee table:</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">| employee_id | department_id | primary_flag |</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">| 1           | 1             | N            |</span><br><span class="line">| 2           | 1             | Y            |</span><br><span class="line">| 2           | 2             | N            |</span><br><span class="line">| 3           | 3             | N            |</span><br><span class="line">| 4           | 2             | N            |</span><br><span class="line">| 4           | 3             | Y            |</span><br><span class="line">| 4           | 4             | N            |</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+---------------+</span><br><span class="line">| employee_id | department_id |</span><br><span class="line">+-------------+---------------+</span><br><span class="line">| 1           | 1             |</span><br><span class="line">| 2           | 1             |</span><br><span class="line">| 3           | 3             |</span><br><span class="line">| 4           | 3             |</span><br><span class="line">+-------------+---------------+</span><br><span class="line">Explanation:</span><br><span class="line">- The Primary department for employee 1 is 1.</span><br><span class="line">- The Primary department for employee 2 is 1.</span><br><span class="line">- The Primary department for employee 3 is 3.</span><br><span class="line">- The Primary department for employee 4 is 3.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id, department_id</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> employee_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(department_id) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id, department_id</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> primary_flag <span class="operator">=</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Triangle-Judgement-Easy"><a href="#Triangle-Judgement-Easy" class="headerlink" title="Triangle Judgement - Easy"></a>Triangle Judgement - Easy</h2><p>判断三角形：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Triangle</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| x           | int  |</span><br><span class="line">| y           | int  |</span><br><span class="line">| z           | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">(x, y, z) is the primary key</span><br></pre></td></tr></table></figure>
<p>写一个SQL查询，每三个线段报告它们是否可以形成一个三角形。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Triangle table:</span><br><span class="line">+----+----+----+</span><br><span class="line">| x  | y  | z  |</span><br><span class="line">+----+----+----+</span><br><span class="line">| 13 | 15 | 30 |</span><br><span class="line">| 10 | 20 | 15 |</span><br><span class="line">+----+----+----+</span><br><span class="line">Output:</span><br><span class="line">+----+----+----+----------+</span><br><span class="line">| x  | y  | z  | triangle |</span><br><span class="line">+----+----+----+----------+</span><br><span class="line">| 13 | 15 | 30 | No       |</span><br><span class="line">| 10 | 20 | 15 | Yes      |</span><br><span class="line">+----+----+----+----------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    x,</span><br><span class="line">    y,</span><br><span class="line">    z,</span><br><span class="line">    <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> x <span class="operator">+</span> y <span class="operator">&gt;</span> z <span class="keyword">AND</span> x <span class="operator">+</span> z <span class="operator">&gt;</span> y <span class="keyword">AND</span> y <span class="operator">+</span> z <span class="operator">&gt;</span> x <span class="keyword">THEN</span> <span class="string">&#x27;Yes&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="string">&#x27;No&#x27;</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">&#x27;triangle&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> triangle</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Consecutive-Numbers-Medium"><a href="#Consecutive-Numbers-Medium" class="headerlink" title="Consecutive Numbers - Medium"></a>Consecutive Numbers - Medium</h2><p>连续出现的数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Logs</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| id          | int     |</span><br><span class="line">| num         | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">id is the primary key for this table.</span><br><span class="line">id is an autoincrement column.</span><br></pre></td></tr></table></figure>
<p>编写一个 SQL 查询，查找所有至少连续出现三次的数字。</p>
<p>返回的结果表中的数据可以按 任意顺序 排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Logs table:</span><br><span class="line">+----+-----+</span><br><span class="line">| id | num |</span><br><span class="line">+----+-----+</span><br><span class="line">| 1  | 1   |</span><br><span class="line">| 2  | 1   |</span><br><span class="line">| 3  | 1   |</span><br><span class="line">| 4  | 2   |</span><br><span class="line">| 5  | 1   |</span><br><span class="line">| 6  | 2   |</span><br><span class="line">| 7  | 2   |</span><br><span class="line">+----+-----+</span><br><span class="line">Output:</span><br><span class="line">+-----------------+</span><br><span class="line">| ConsecutiveNums |</span><br><span class="line">+-----------------+</span><br><span class="line">| 1               |</span><br><span class="line">+-----------------+</span><br><span class="line">Explanation: 1 is the only number that appears consecutively for at least three times.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    l1.num <span class="keyword">AS</span> ConsecutiveNums</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Logs l1,</span><br><span class="line">    Logs l2,</span><br><span class="line">    Logs l3</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    l1.id <span class="operator">=</span> l2.id <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span></span><br><span class="line">    l2.id <span class="operator">=</span> l3.id <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span></span><br><span class="line">    l1.num <span class="operator">=</span> l2.num</span><br><span class="line">    <span class="keyword">AND</span></span><br><span class="line">    l2.num <span class="operator">=</span> l3.num</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Product-Price-at-a-Given-Date-Medium"><a href="#Product-Price-at-a-Given-Date-Medium" class="headerlink" title="Product Price at a Given Date - Medium"></a>Product Price at a Given Date - Medium</h2><p>指定日期的产品价格：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Products</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| product_id    | int     |</span><br><span class="line">| new_price     | int     |</span><br><span class="line">| change_date   | date    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(product_id, change_date) is the primary key</span><br></pre></td></tr></table></figure>
<p>写一段 SQL来查找在 2019-08-16 时全部产品的价格，假设所有产品在修改前的价格都是 10 。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Products table:</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line">| product_id | new_price | change_date |</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line">| 1          | 20        | 2019-08-14  |</span><br><span class="line">| 2          | 50        | 2019-08-14  |</span><br><span class="line">| 1          | 30        | 2019-08-15  |</span><br><span class="line">| 1          | 35        | 2019-08-16  |</span><br><span class="line">| 2          | 65        | 2019-08-17  |</span><br><span class="line">| 3          | 20        | 2019-08-18  |</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line">Output:</span><br><span class="line">+------------+-------+</span><br><span class="line">| product_id | price |</span><br><span class="line">+------------+-------+</span><br><span class="line">| 2          | 50    |</span><br><span class="line">| 1          | 35    |</span><br><span class="line">| 3          | 10    |</span><br><span class="line">+------------+-------+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    p1.product_id,</span><br><span class="line">    IFNULL(p2.new_price, <span class="number">10</span>) <span class="keyword">AS</span> price</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> product_id</span><br><span class="line">    <span class="keyword">FROM</span> products</span><br><span class="line">) <span class="keyword">AS</span> p1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> product_id, new_price</span><br><span class="line">    <span class="keyword">FROM</span> products</span><br><span class="line">    <span class="keyword">WHERE</span> (product_id, change_date) <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> product_id, <span class="built_in">MAX</span>(change_date)</span><br><span class="line">        <span class="keyword">FROM</span> products</span><br><span class="line">        <span class="keyword">WHERE</span> change_date <span class="operator">&lt;=</span> <span class="string">&#x27;2019-08-16&#x27;</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_id</span><br><span class="line">    )</span><br><span class="line">) <span class="keyword">AS</span> p2</span><br><span class="line"><span class="keyword">ON</span> p1.product_id <span class="operator">=</span> p2.product_id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Last-Person-to-Fit-in-the-Bus-Medium"><a href="#Last-Person-to-Fit-in-the-Bus-Medium" class="headerlink" title="Last Person to Fit in the Bus - Medium"></a>Last Person to Fit in the Bus - Medium</h2><p>最后一个能进入电梯的人：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Table: Queue</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| person_id   | int     |</span><br><span class="line">| person_name | varchar |</span><br><span class="line">| weight      | int     |</span><br><span class="line">| turn        | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">person_id is the primary key</span><br></pre></td></tr></table></figure>
<p>有一群人在等着上公共汽车。然而，巴士有 1000 公斤的重量限制，所以可能会有一些人不能上。</p>
<p>写一条 SQL 查询语句查找 最后一个 能进入电梯且不超过重量限制的 person_name 。题目确保队列中第一位的人可以进入电梯，不会超重。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Queue table:</span><br><span class="line">+-----------+-------------+--------+------+</span><br><span class="line">| person_id | person_name | weight | turn |</span><br><span class="line">+-----------+-------------+--------+------+</span><br><span class="line">| 5         | Alice       | 250    | 1    |</span><br><span class="line">| 4         | Bob         | 175    | 5    |</span><br><span class="line">| 3         | Alex        | 350    | 2    |</span><br><span class="line">| 6         | John Cena   | 400    | 3    |</span><br><span class="line">| 1         | Winston     | 500    | 6    |</span><br><span class="line">| 2         | Marie       | 200    | 4    |</span><br><span class="line">+-----------+-------------+--------+------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+</span><br><span class="line">| person_name |</span><br><span class="line">+-------------+</span><br><span class="line">| John Cena   |</span><br><span class="line">+-------------+</span><br><span class="line">解释：</span><br><span class="line">为了简化，Queue 表按 turn 列由小到大排序。</span><br><span class="line">上例中 George Washington(id 5), John Adams(id 3) 和 Thomas Jefferson(id 6) 将可以进入电梯,因为他们的体重和为 250 + 350 + 400 &#x3D; 1000。</span><br><span class="line">Thomas Jefferson(id 6) 是最后一个体重合适并进入电梯的人。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="comment">-- 方法一：自连接</span></span><br><span class="line"><span class="keyword">SELECT</span> a.person_name</span><br><span class="line"><span class="keyword">FROM</span> Queue a, Queue b</span><br><span class="line"><span class="keyword">WHERE</span> a.turn <span class="operator">&gt;=</span> b.turn</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a.person_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(b.weight) <span class="operator">&lt;=</span> <span class="number">1000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.turn <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法二：自定义变量</span></span><br><span class="line"><span class="keyword">SELECT</span> a.person_name</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        person_name,</span><br><span class="line">        <span class="variable">@pre</span> :<span class="operator">=</span> <span class="variable">@pre</span> <span class="operator">+</span> weight <span class="keyword">AS</span> weight</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        queue,</span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="variable">@pre</span> :<span class="operator">=</span> <span class="number">0</span>) <span class="keyword">AS</span> tmp</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> turn</span><br><span class="line">) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">WHERE</span> a.weight <span class="operator">&lt;=</span> <span class="number">1000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.weight <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Count-Salary-Categories-Medium"><a href="#Count-Salary-Categories-Medium" class="headerlink" title="Count Salary Categories - Medium"></a>Count Salary Categories - Medium</h2><p>按分类统计薪水：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Table: Accounts</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| account_id  | int  |</span><br><span class="line">| income      | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">account_id is the primary key</span><br></pre></td></tr></table></figure>
<p>写出一个 SQL 查询，来报告每个工资类别的银行账户数量。 工资类别如下：</p>
<p>“Low Salary”：所有工资 严格低于 20000 美元。<br>“Average Salary”： 包含 范围内的所有工资 [$20000, $50000] 。<br>“High Salary”：所有工资 严格大于 50000 美元。</p>
<p>结果表 必须 包含所有三个类别。如果某个类别中没有帐户，则报告 0。</p>
<p>按 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Accounts table:</span><br><span class="line">+------------+--------+</span><br><span class="line">| account_id | income |</span><br><span class="line">+------------+--------+</span><br><span class="line">| 3          | 108939 |</span><br><span class="line">| 2          | 12747  |</span><br><span class="line">| 8          | 87709  |</span><br><span class="line">| 6          | 91796  |</span><br><span class="line">+------------+--------+</span><br><span class="line"></span><br><span class="line">Output:</span><br><span class="line">+----------------+----------------+</span><br><span class="line">| category       | accounts_count |</span><br><span class="line">+----------------+----------------+</span><br><span class="line">| Low Salary     | 1              |</span><br><span class="line">| Average Salary | 0              |</span><br><span class="line">| High Salary    | 3              |</span><br><span class="line">+----------------+----------------+</span><br><span class="line">Explanation:</span><br><span class="line">Low Salary: Account 2.</span><br><span class="line">Average Salary: No accounts.</span><br><span class="line">High Salary: Accounts 3, 6, and 8.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">&#x27;Low Salary&#x27;</span> category,</span><br><span class="line">    <span class="built_in">SUM</span>(income <span class="operator">&lt;</span> <span class="number">20000</span>) accounts_count</span><br><span class="line"><span class="keyword">FROM</span> accounts</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">&#x27;Average Salary&#x27;</span>,</span><br><span class="line">    <span class="built_in">SUM</span>(income <span class="operator">&gt;=</span> <span class="number">20000</span> <span class="keyword">AND</span> income <span class="operator">&lt;=</span> <span class="number">50000</span>)</span><br><span class="line"><span class="keyword">FROM</span> accounts</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">&#x27;High Salary&#x27;</span>,</span><br><span class="line">    <span class="built_in">SUM</span>(income <span class="operator">&gt;</span> <span class="number">50000</span>)</span><br><span class="line"><span class="keyword">FROM</span> accounts</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Employees-Whose-Manager-Left-the-Company-Easy"><a href="#Employees-Whose-Manager-Left-the-Company-Easy" class="headerlink" title="Employees Whose Manager Left the Company - Easy"></a>Employees Whose Manager Left the Company - Easy</h2><p>上级经理已离职的公司员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Table: Employees</span><br><span class="line"></span><br><span class="line">+-------------+----------+</span><br><span class="line">| Column Name | Type     |</span><br><span class="line">+-------------+----------+</span><br><span class="line">| employee_id | int      |</span><br><span class="line">| name        | varchar  |</span><br><span class="line">| manager_id  | int      |</span><br><span class="line">| salary      | int      |</span><br><span class="line">+-------------+----------+</span><br><span class="line"></span><br><span class="line">employee_id is the primary key</span><br><span class="line">Some employees do not have a manager (manager_id is null)</span><br></pre></td></tr></table></figure>
<p>查找这些员工的id，他们的薪水严格少于$30000 并且他们的上级经理已离职。当一个经理离开公司时，他们的信息需要从员工表中删除掉，但是表中的员工的manager_id  这一列还是设置的离职经理的id 。</p>
<p>返回的结果按照employee_id 从小到大排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Employees table:</span><br><span class="line">+-------------+-----------+------------+--------+</span><br><span class="line">| employee_id | name      | manager_id | salary |</span><br><span class="line">+-------------+-----------+------------+--------+</span><br><span class="line">| 3           | Mila      | 9          | 60301  |</span><br><span class="line">| 12          | Antonella | null       | 31000  |</span><br><span class="line">| 13          | Emery     | null       | 67084  |</span><br><span class="line">| 1           | Kalel     | 11         | 21241  |</span><br><span class="line">| 9           | Mikaela   | null       | 50937  |</span><br><span class="line">| 11          | Joziah    | 6          | 28485  |</span><br><span class="line">+-------------+-----------+------------+--------+</span><br><span class="line">Output:</span><br><span class="line">+-------------+</span><br><span class="line">| employee_id |</span><br><span class="line">+-------------+</span><br><span class="line">| 11          |</span><br><span class="line">+-------------+</span><br><span class="line"></span><br><span class="line">Explanation:</span><br><span class="line">薪水少于 30000 美元的员工有 1 号(Kalel) 和 11号 (Joziah)。</span><br><span class="line">Kalel 的上级经理是 11 号员工，他还在公司上班(他是 Joziah )。</span><br><span class="line">Joziah 的上级经理是 6 号员工，他已经离职，因为员工表里面已经没有 6 号员工的信息了，它被删除了。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"><span class="comment">--方法一：左连接</span></span><br><span class="line"><span class="keyword">select</span> e1.employee_id</span><br><span class="line"><span class="keyword">from</span> Employees e1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> Employees e2</span><br><span class="line"><span class="keyword">on</span> e1.manager_id <span class="operator">=</span> e2.employee_id</span><br><span class="line"><span class="keyword">where</span> e1.salary <span class="operator">&lt;</span> <span class="number">30000</span> <span class="keyword">and</span> e1.manager_id <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> e2.employee_id <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e1.employee_id</span><br><span class="line"></span><br><span class="line"><span class="comment">--方法二：not in + 子查询</span></span><br><span class="line"><span class="keyword">select</span> employee_id</span><br><span class="line"><span class="keyword">from</span> Employees</span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&lt;</span> <span class="number">30000</span></span><br><span class="line">	<span class="keyword">and</span> manager_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> employee_id <span class="keyword">from</span> Employees)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> employee_id</span><br></pre></td></tr></table></figure>
<h2 id="Exchange-Seats-Medium"><a href="#Exchange-Seats-Medium" class="headerlink" title="Exchange Seats - Medium"></a>Exchange Seats - Medium</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table: Seat</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| id          | int     |</span><br><span class="line">| student     | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">id is the primary key (unique value) column</span><br><span class="line">id is a continuous increment. 「连续增量」</span><br></pre></td></tr></table></figure>
<p>编写解决方案来交换每两个连续的学生的座位号。如果学生的数量是奇数，则最后一个学生的id不交换。</p>
<p>按 id 升序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Seat table:</span><br><span class="line">+----+---------+</span><br><span class="line">| id | student |</span><br><span class="line">+----+---------+</span><br><span class="line">| 1  | Abbot   |</span><br><span class="line">| 2  | Doris   |</span><br><span class="line">| 3  | Emerson |</span><br><span class="line">| 4  | Green   |</span><br><span class="line">| 5  | Jeames  |</span><br><span class="line">+----+---------+</span><br><span class="line">Output:</span><br><span class="line">+----+---------+</span><br><span class="line">| id | student |</span><br><span class="line">+----+---------+</span><br><span class="line">| 1  | Doris   |</span><br><span class="line">| 2  | Abbot   |</span><br><span class="line">| 3  | Green   |</span><br><span class="line">| 4  | Emerson |</span><br><span class="line">| 5  | Jeames  |</span><br><span class="line">+----+---------+</span><br><span class="line">Explanation:</span><br><span class="line">如果学生人数为奇数，则不需要更换最后一名学生的座位。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line">方法一：使用 <span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> counts</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    seat</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    (<span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> <span class="built_in">MOD</span>(id, <span class="number">2</span>) <span class="operator">!=</span> <span class="number">0</span> <span class="keyword">AND</span> counts <span class="operator">!=</span> id <span class="keyword">THEN</span> id <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">WHEN</span> <span class="built_in">MOD</span>(id, <span class="number">2</span>) <span class="operator">!=</span> <span class="number">0</span> <span class="keyword">AND</span> counts <span class="operator">=</span> id <span class="keyword">THEN</span> id</span><br><span class="line">        <span class="keyword">ELSE</span> id <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> id,</span><br><span class="line">    student</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    seat,</span><br><span class="line">    (<span class="keyword">SELECT</span></span><br><span class="line">        <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> counts</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        seat) <span class="keyword">AS</span> seat_counts</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> id <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line">方法二：使用位操作和 <span class="built_in">COALESCE</span>()</span><br><span class="line"><span class="keyword">SELECT</span> id, (id<span class="operator">+</span><span class="number">1</span>)<span class="operator">^</span><span class="number">1</span><span class="number">-1</span>, student <span class="keyword">FROM</span> seat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    seat s1</span><br><span class="line">        <span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">    seat s2 <span class="keyword">ON</span> (s1.id<span class="operator">+</span><span class="number">1</span>)<span class="operator">^</span><span class="number">1</span><span class="number">-1</span> <span class="operator">=</span> s2.id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> s1.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    s1.id, <span class="built_in">COALESCE</span>(s2.student, s1.student) <span class="keyword">AS</span> student</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    seat s1</span><br><span class="line">        <span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">    seat s2 <span class="keyword">ON</span> ((s1.id <span class="operator">+</span> <span class="number">1</span>) <span class="operator">^</span> <span class="number">1</span>) <span class="operator">-</span> <span class="number">1</span> <span class="operator">=</span> s2.id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> s1.id;</span><br></pre></td></tr></table></figure>
<h2 id="Movie-Rating-Medium"><a href="#Movie-Rating-Medium" class="headerlink" title="Movie Rating - Medium"></a>Movie Rating - Medium</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Table: Movies</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| movie_id      | int     |</span><br><span class="line">| title         | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">movie_id is the primary key</span><br><span class="line"></span><br><span class="line">Table: Users</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| user_id       | int     |</span><br><span class="line">| name          | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">user_id is the primary key</span><br><span class="line"></span><br><span class="line">Table: MovieRating</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| movie_id      | int     |</span><br><span class="line">| user_id       | int     |</span><br><span class="line">| rating        | int     |</span><br><span class="line">| created_at    | date    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(movie_id, user_id) is the primary key</span><br></pre></td></tr></table></figure>
<p>查找评论电影数量最多的用户名。如果出现平局，返回字典序较小的用户名。<br>查找在 February 2020 平均评分最高 的电影名称。如果出现平局，返回字典序较小的电影名称。</p>
<p>字典序 ，即按字母在字典中出现顺序对字符串排序，字典序较小则意味着排序靠前。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">Movies table:</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| movie_id    |  title       |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| 1           | Avengers     |</span><br><span class="line">| 2           | Frozen 2     |</span><br><span class="line">| 3           | Joker        |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">Users table:</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| user_id     |  name        |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| 1           | Daniel       |</span><br><span class="line">| 2           | Monica       |</span><br><span class="line">| 3           | Maria        |</span><br><span class="line">| 4           | James        |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">MovieRating table:</span><br><span class="line">+-------------+--------------+--------------+-------------+</span><br><span class="line">| movie_id    | user_id      | rating       | created_at  |</span><br><span class="line">+-------------+--------------+--------------+-------------+</span><br><span class="line">| 1           | 1            | 3            | 2020-01-12  |</span><br><span class="line">| 1           | 2            | 4            | 2020-02-11  |</span><br><span class="line">| 1           | 3            | 2            | 2020-02-12  |</span><br><span class="line">| 1           | 4            | 1            | 2020-01-01  |</span><br><span class="line">| 2           | 1            | 5            | 2020-02-17  |</span><br><span class="line">| 2           | 2            | 2            | 2020-02-01  |</span><br><span class="line">| 2           | 3            | 2            | 2020-03-01  |</span><br><span class="line">| 3           | 1            | 3            | 2020-02-22  |</span><br><span class="line">| 3           | 2            | 4            | 2020-02-25  |</span><br><span class="line">+-------------+--------------+--------------+-------------+</span><br><span class="line">Output:</span><br><span class="line">+--------------+</span><br><span class="line">| results      |</span><br><span class="line">+--------------+</span><br><span class="line">| Daniel       |</span><br><span class="line">| Frozen 2     |</span><br><span class="line">+--------------+</span><br><span class="line">Explanation:</span><br><span class="line">Daniel 和 Monica 都点评了 3 部电影（&quot;Avengers&quot;, &quot;Frozen 2&quot; 和 &quot;Joker&quot;） 但是 Daniel 字典序比较小。</span><br><span class="line">Frozen 2 和 Joker 在 2 月的评分都是 3.5，但是 Frozen 2 的字典序比较小。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL</span></span><br><span class="line"># 评论电影数量最多且字典序较小的用户名</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">select</span> Users.name <span class="keyword">as</span> results</span><br><span class="line">    <span class="keyword">FROM</span> MovieRating</span><br><span class="line">        <span class="keyword">JOIN</span> Users <span class="keyword">ON</span> MovieRating.user_id <span class="operator">=</span> Users.user_id</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> MovieRating.user_id</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">        <span class="built_in">count</span>(MovieRating.user_id) <span class="keyword">desc</span>,</span><br><span class="line">        Users.name</span><br><span class="line">    LIMIT <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span>(</span><br><span class="line"># <span class="number">2020</span>年<span class="number">2</span>月份平均评分最高且字典序较小的电影名</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        Movies.title <span class="keyword">as</span> results</span><br><span class="line">    <span class="keyword">FROM</span> MovieRating</span><br><span class="line">        <span class="keyword">JOIN</span> Movies <span class="keyword">ON</span> MovieRating.movie_id <span class="operator">=</span> Movies.movie_id</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        MovieRating.created_at <span class="operator">&gt;=</span> <span class="string">&#x27;2020-02-01&#x27;</span></span><br><span class="line">        <span class="keyword">AND</span> MovieRating.created_at <span class="operator">&lt;</span> <span class="string">&#x27;2020-03-01&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> MovieRating.movie_id</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">        <span class="built_in">avg</span>(MovieRating.rating) <span class="keyword">desc</span>,</span><br><span class="line">        Movies.title</span><br><span class="line">    LIMIT <span class="number">1</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="Restaurant-Growth-Medium"><a href="#Restaurant-Growth-Medium" class="headerlink" title="Restaurant Growth - Medium"></a>Restaurant Growth - Medium</h2><p>餐馆营业额变化增长</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">该表包含一家餐馆的顾客交易数据。</span><br><span class="line">visited_on 表示 (customer_id) 的顾客在 visited_on 那天访问了餐馆。</span><br><span class="line">amount 是一个顾客某一天的消费总额。</span><br></pre></td></tr></table></figure>
<p>分析一下可能的营业额变化增长（每天至少有一位顾客）。</p>
<p>计算以 7 天（某日期 + 该日期前的 6 天）为一个时间段的顾客消费平均值。average_amount 要 保留两位小数。</p>
<p>结果按 visited_on 升序排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">第一个七天消费平均值从 2019-01-01 到 2019-01-07 是restaurant-growth&#x2F;restaurant-growth&#x2F; (100 + 110 + 120 + 130 + 110 + 140 + 150)&#x2F;7 &#x3D; 122.86</span><br><span class="line">第二个七天消费平均值从 2019-01-02 到 2019-01-08 是 (110 + 120 + 130 + 110 + 140 + 150 + 80)&#x2F;7 &#x3D; 120</span><br><span class="line">第三个七天消费平均值从 2019-01-03 到 2019-01-09 是 (120 + 130 + 110 + 140 + 150 + 80 + 110)&#x2F;7 &#x3D; 120</span><br><span class="line">第四个七天消费平均值从 2019-01-04 到 2019-01-10 是 (130 + 110 + 140 + 150 + 80 + 110 + 130 + 150)&#x2F;7 &#x3D; 142.86</span><br></pre></td></tr></table></figure>


<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>好友申请 II ：谁有最多的好友</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>找出拥有最多的好友的人和他拥有的好友数目。</p>
<p>生成的测试用例保证拥有最多好友数目的只有 1 个人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">编号为 3 的人是编号为 1 ，2 和 4 的人的好友，所以他总共有 3 个好友，比其他人都多。</span><br></pre></td></tr></table></figure>





<h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">表中的每一行都包含一条保险信息，其中：</span><br><span class="line">pid 是投保人的投保编号。</span><br><span class="line">tiv_2015 是该投保人在 2015 年的总投保金额，tiv_2016 是该投保人在 2016 年的总投保金额。</span><br><span class="line">lat 是投保人所在城市的纬度。题目数据确保 lat 不为空。</span><br><span class="line">lon 是投保人所在城市的经度。题目数据确保 lon 不为空。</span><br></pre></td></tr></table></figure>
<p>报告 2016 年 (tiv_2016) 所有满足下述条件的投保人的投保金额之和：</p>
<p>他在 2015 年的投保额 (tiv_2015) 至少跟一个其他投保人在 2015 年的投保额相同。<br>他所在的城市必须与其他投保人都不同（也就是说 (lat, lon) 不能跟其他任何一个投保人完全相同）。<br>tiv_2016 四舍五入的 两位小数 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">表中的第一条记录和最后一条记录都满足两个条件。</span><br><span class="line">tiv_2015 值为 10 与第三条和第四条记录相同，且其位置是唯一的。</span><br><span class="line"></span><br><span class="line">第二条记录不符合任何一个条件。其 tiv_2015 与其他投保人不同，并且位置与第三条记录相同，这也导致了第三条记录不符合题目要求。</span><br><span class="line">因此，结果是第一条记录和最后一条记录的 tiv_2016 之和，即 45 。</span><br></pre></td></tr></table></figure>





<h2 id="-2"><a href="#-2" class="headerlink" title=""></a></h2><p>公司的主管们感兴趣的是公司每个部门中谁赚的钱最多。一个部门的 高收入者 是指一个员工的工资在该部门的 不同 工资中 排名前三 。</p>
<p>编写解决方案，找出每个部门中 收入高的员工 。</p>
<p>以 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">在IT部门:</span><br><span class="line">- Max的工资最高</span><br><span class="line">- 兰迪和乔都赚取第二高的独特的薪水</span><br><span class="line">- 威尔的薪水是第三高的</span><br><span class="line"></span><br><span class="line">在销售部:</span><br><span class="line">- 亨利的工资最高</span><br><span class="line">- 山姆的薪水第二高</span><br><span class="line">- 没有第三高的工资，因为只有两名员工</span><br></pre></td></tr></table></figure>




<h2 id="-3"><a href="#-3" class="headerlink" title=""></a></h2><p>修复表中的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">该表包含用户的 ID 和名字。名字仅由小写和大写字符组成。</span><br></pre></td></tr></table></figure>
<p>修复名字，使得只有第一个字符是大写的，其余都是小写的。</p>
<p>返回按 user_id 排序的结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="-4"><a href="#-4" class="headerlink" title=""></a></h2><p>患某种疾病的患者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&#39;conditions&#39; （疾病）包含 0 个或以上的疾病代码，以空格分隔。</span><br></pre></td></tr></table></figure>
<p>查询患有 I 类糖尿病的患者 ID （patient_id）、患者姓名（patient_name）以及其患有的所有疾病代码（conditions）。I 类糖尿病的代码总是包含前缀 DIAB1 。</p>
<p>按 任意顺序 返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">Bob 和 George 都患有代码以 DIAB1 开头的疾病。</span><br></pre></td></tr></table></figure>



<h2 id="-5"><a href="#-5" class="headerlink" title=""></a></h2><p>删除重复的电子邮箱</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">该表的每一行包含一封电子邮件。电子邮件将不包含大写字母。</span><br></pre></td></tr></table></figure>
<p>删除 所有重复的电子邮件，只保留一个具有最小 id 的唯一电子邮件。</p>
<p>（对于 SQL 用户，请注意你应该编写一个 DELETE 语句而不是 SELECT 语句。）</p>
<p>（对于 Pandas 用户，请注意你应该直接修改 Person 表。）</p>
<p>运行脚本后，显示的答案是 Person 表。驱动程序将首先编译并运行您的代码片段，然后再显示 Person 表。Person 表的最终顺序 无关紧要 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">john@example.com重复两次。我们保留最小的Id &#x3D; 1。</span><br></pre></td></tr></table></figure>





<h2 id="-6"><a href="#-6" class="headerlink" title=""></a></h2><p>第二高的薪水</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>查询并返回 Employee 表中第二高的薪水 。如果不存在第二高的薪水，查询应该返回 null(Pandas 则返回 None) 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="-7"><a href="#-7" class="headerlink" title=""></a></h2><p>按日期分组销售产品</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>找出每个日期、销售的不同产品的数量及其名称。<br>每个日期的销售产品名称应按词典序排列。<br>返回按 sell_date 排序的结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">对于2020-05-30，出售的物品是 (Headphone, Basketball, T-shirt)，按词典序排列，并用逗号 &#39;,&#39; 分隔。</span><br><span class="line">对于2020-06-01，出售的物品是 (Pencil, Bible)，按词典序排列，并用逗号分隔。</span><br><span class="line">对于2020-06-02，出售的物品是 (Mask)，只需返回该物品名。</span><br></pre></td></tr></table></figure>


<h2 id="-8"><a href="#-8" class="headerlink" title=""></a></h2><p>列出指定时间段内所有的下单产品</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">该表可能包含重复行。</span><br><span class="line">unit 是在日期 order_date 内下单产品的数目。</span><br></pre></td></tr></table></figure>
<p>获取在 2020 年 2 月份下单的数量不少于 100 的产品的名字和数目。</p>
<p>返回结果表单的 顺序无要求 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">2020 年 2 月份下单 product_id &#x3D; 1 的产品的数目总和为 (60 + 70) &#x3D; 130 。</span><br><span class="line">2020 年 2 月份下单 product_id &#x3D; 2 的产品的数目总和为 80 。</span><br><span class="line">2020 年 2 月份下单 product_id &#x3D; 3 的产品的数目总和为 (2 + 3) &#x3D; 5 。</span><br><span class="line">2020 年 2 月份 product_id &#x3D; 4 的产品并没有下单。</span><br><span class="line">2020 年 2 月份下单 product_id &#x3D; 5 的产品的数目总和为 (50 + 50) &#x3D; 100 。</span><br></pre></td></tr></table></figure>


<h2 id="-9"><a href="#-9" class="headerlink" title=""></a></h2><p>查找拥有有效邮箱的用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">该表包含了网站已注册用户的信息。有一些电子邮件是无效的。</span><br></pre></td></tr></table></figure>
<p>查找具有有效电子邮件的用户。</p>
<p>一个有效的电子邮件具有前缀名称和域，其中：</p>
<p> 前缀 名称是一个字符串，可以包含字母（大写或小写），数字，下划线 ‘_’ ，点 ‘.’ 和/或破折号 ‘-‘ 。前缀名称 必须 以字母开头。<br>域 为 ‘@leetcode.com’ 。<br>以任何顺序返回结果表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">用户 2 的电子邮件没有域。</span><br><span class="line">用户 5 的电子邮件带有不允许的 &#39;#&#39; 符号。</span><br><span class="line">用户 6 的电子邮件没有 leetcode 域。</span><br><span class="line">用户 7 的电子邮件以点开头。</span><br></pre></td></tr></table></figure>



<h1 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h1><p><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/studyplan/primers-list" >「新」动计划 · 编程入门<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/studyplan/sql-free-50" >高频 SQL 50 题（基础版）<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/studyplan/top-100-liked" >LeetCode 热题 100<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://algo.itcharge.cn/" >算法通关手册<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://www.programmercarl.com/" >代码随想录<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/top-interview-questions-easy/" >1.初级算法<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/all-about-array/" >2.数组类算法<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/array-and-string/" >3.数组和字符串<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/linked-list/" >4.链表图文学<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/queue-stack/" >5.队列 &amp; 栈图文学<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/binary-search/" >6.二分查找<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/data-structure-binary-tree/" >7.二叉树<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/introduction-to-data-structure-binary-search-tree/" >8.二叉搜索树<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/n-ary-tree/" >9.N 叉树<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/trie/" >10.前缀树<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/top-interview-questions-medium/" >11.中级算法<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/top-interview-questions-hard/" >12.高级算法<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/path-problems-in-dynamic-programming/" >13.动态规划路径问题<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/top-interview-questions/" >14.算法面试题汇总<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/2020-top-interview-questions/" >2020 名企高频面试题<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/illustration-of-algorithm/" >图解算法数据结构<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/designing-data-structures/" >设计数据结构<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://leetcode.cn/leetbook/detail/shu-ju-jie-gou-jiao-cheng-di-6-ban-zai-xian-bian-c/" >数据结构教程(第 6 版) - 在线编程实训<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://codetop.cc/" >CodeTop 企业题库<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h1><p>期待有一天 LeetCode 基本刷遍……</p>

        </div>

        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2023/05/21/code_algorithm/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Data Structure &amp; Algorithm</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2023/05/16/work_basis/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">找工作那些事</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'GHjr9A7BcsjDCu8fuLv3Yev2-MdYXbMMI',
                    appKey: 'BwohkTMPdjQcGRYeFq6huB1E',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 Thanks for reading. Please feel free to write.',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'xcbyao';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2025&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">xcbyao</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pref"><span class="nav-number">1.</span> <span class="nav-text">Pref</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Convert-the-Temperature-Easy"><span class="nav-number">2.</span> <span class="nav-text">Convert the Temperature - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Smallest-Even-Multiple-Easy"><span class="nav-number">3.</span> <span class="nav-text">Smallest Even Multiple - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#XOR-Operation-in-an-Array-Easy"><span class="nav-number">4.</span> <span class="nav-text">XOR Operation in an Array - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Number-of-Good-Pairs-Easy"><span class="nav-number">5.</span> <span class="nav-text">Number of Good Pairs - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Count-Good-Triplets-Easy"><span class="nav-number">6.</span> <span class="nav-text">Count Good Triplets - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Add-Digits-Easy"><span class="nav-number">7.</span> <span class="nav-text">Add Digits - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Subtract-the-Product-and-Sum-of-Digits-of-an-Integer-Easy"><span class="nav-number">8.</span> <span class="nav-text">Subtract the Product and Sum of Digits of an Integer - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Power-of-Two-Easy"><span class="nav-number">9.</span> <span class="nav-text">Power of Two - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Power-of-Three-Easy"><span class="nav-number">10.</span> <span class="nav-text">Power of Three - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ugly-Number-Easy"><span class="nav-number">11.</span> <span class="nav-text">Ugly Number - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Shuffle-the-Array-Easy"><span class="nav-number">12.</span> <span class="nav-text">Shuffle the Array - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transpose-Matrix-Easy"><span class="nav-number">13.</span> <span class="nav-text">Transpose Matrix - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Maximum-Score-After-Splitting-a-String-Easy"><span class="nav-number">14.</span> <span class="nav-text">Maximum Score After Splitting a String - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Count-the-Number-of-Vowel-Strings-in-Range-Easy"><span class="nav-number">15.</span> <span class="nav-text">Count the Number of Vowel Strings in Range - Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Peak-Index-in-a-Mountain-Array-Medium"><span class="nav-number">16.</span> <span class="nav-text">Peak Index in a Mountain Array - Medium</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Database"><span class="nav-number">17.</span> <span class="nav-text">Database</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Find-Customer-Referee-Easy"><span class="nav-number">17.1.</span> <span class="nav-text">Find Customer Referee - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Recyclable-and-Low-Fat-Products-Easy"><span class="nav-number">17.2.</span> <span class="nav-text">Recyclable and Low Fat Products - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Big-Countries-Easy"><span class="nav-number">17.3.</span> <span class="nav-text">Big Countries - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Article-Views-I-Easy"><span class="nav-number">17.4.</span> <span class="nav-text">Article Views I - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Invalid-Tweets-Easy"><span class="nav-number">17.5.</span> <span class="nav-text">Invalid Tweets - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Replace-Employee-ID-With-The-Unique-Identifier-Easy"><span class="nav-number">17.6.</span> <span class="nav-text">Replace Employee ID With The Unique Identifier - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Product-Sales-Analysis-I-Easy"><span class="nav-number">17.7.</span> <span class="nav-text">Product Sales Analysis I - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Customer-Who-Visited-but-Did-Not-Make-Any-Transactions-Easy"><span class="nav-number">17.8.</span> <span class="nav-text">Customer Who Visited but Did Not Make Any Transactions - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rising-Temperature-Easy"><span class="nav-number">17.9.</span> <span class="nav-text">Rising Temperature - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Average-Time-of-Process-per-Machine-Easy"><span class="nav-number">17.10.</span> <span class="nav-text">Average Time of Process per Machine - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Employee-Bonus-Easy"><span class="nav-number">17.11.</span> <span class="nav-text">Employee Bonus - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Students-and-Examinations-Easy"><span class="nav-number">17.12.</span> <span class="nav-text">Students and Examinations - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Managers-with-at-Least-5-Direct-Reports-Medium"><span class="nav-number">17.13.</span> <span class="nav-text">Managers with at Least 5 Direct Reports - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Confirmation-Rate-Medium"><span class="nav-number">17.14.</span> <span class="nav-text">Confirmation Rate - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Not-Boring-Movies-Easy"><span class="nav-number">17.15.</span> <span class="nav-text">Not Boring Movies - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Average-Selling-Price-Easy"><span class="nav-number">17.16.</span> <span class="nav-text">Average Selling Price - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Project-Employees-I-Easy"><span class="nav-number">17.17.</span> <span class="nav-text">Project Employees I - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Percentage-of-Users-Attended-a-Contest-Easy"><span class="nav-number">17.18.</span> <span class="nav-text">Percentage of Users Attended a Contest - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Queries-Quality-and-Percentage-Easy"><span class="nav-number">17.19.</span> <span class="nav-text">Queries Quality and Percentage - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Monthly-Transactions-I-Medium"><span class="nav-number">17.20.</span> <span class="nav-text">Monthly Transactions I - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Immediate-Food-Delivery-II-Medium"><span class="nav-number">17.21.</span> <span class="nav-text">Immediate Food Delivery II - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Game-Play-Analysis-IV-Medium"><span class="nav-number">17.22.</span> <span class="nav-text">Game Play Analysis IV - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Number-of-Unique-Subjects-Taught-by-Each-Teacher-Easy"><span class="nav-number">17.23.</span> <span class="nav-text">Number of Unique Subjects Taught by Each Teacher - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#User-Activity-for-the-Past-30-Days-I-Easy"><span class="nav-number">17.24.</span> <span class="nav-text">User Activity for the Past 30 Days I - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sales-Analysis-III-Easy"><span class="nav-number">17.25.</span> <span class="nav-text">Sales Analysis III - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes-More-Than-5-Students-Easy"><span class="nav-number">17.26.</span> <span class="nav-text">Classes More Than 5 Students - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Find-Followers-Count-Easy"><span class="nav-number">17.27.</span> <span class="nav-text">Find Followers Count - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Biggest-Single-Number-Easy"><span class="nav-number">17.28.</span> <span class="nav-text">Biggest Single Number - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Customers-Who-Bought-All-Products-Medium"><span class="nav-number">17.29.</span> <span class="nav-text">Customers Who Bought All Products - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-Number-of-Employees-Which-Report-to-Each-Employee-Easy"><span class="nav-number">17.30.</span> <span class="nav-text">The Number of Employees Which Report to Each Employee - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Primary-Department-for-Each-Employee-Easy"><span class="nav-number">17.31.</span> <span class="nav-text">Primary Department for Each Employee - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Triangle-Judgement-Easy"><span class="nav-number">17.32.</span> <span class="nav-text">Triangle Judgement - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Consecutive-Numbers-Medium"><span class="nav-number">17.33.</span> <span class="nav-text">Consecutive Numbers - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Product-Price-at-a-Given-Date-Medium"><span class="nav-number">17.34.</span> <span class="nav-text">Product Price at a Given Date - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Last-Person-to-Fit-in-the-Bus-Medium"><span class="nav-number">17.35.</span> <span class="nav-text">Last Person to Fit in the Bus - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Count-Salary-Categories-Medium"><span class="nav-number">17.36.</span> <span class="nav-text">Count Salary Categories - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Employees-Whose-Manager-Left-the-Company-Easy"><span class="nav-number">17.37.</span> <span class="nav-text">Employees Whose Manager Left the Company - Easy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exchange-Seats-Medium"><span class="nav-number">17.38.</span> <span class="nav-text">Exchange Seats - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Movie-Rating-Medium"><span class="nav-number">17.39.</span> <span class="nav-text">Movie Rating - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Restaurant-Growth-Medium"><span class="nav-number">17.40.</span> <span class="nav-text">Restaurant Growth - Medium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">17.41.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-1"><span class="nav-number">17.42.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-2"><span class="nav-number">17.43.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-3"><span class="nav-number">17.44.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-4"><span class="nav-number">17.45.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-5"><span class="nav-number">17.46.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-6"><span class="nav-number">17.47.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-7"><span class="nav-number">17.48.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-8"><span class="nav-number">17.49.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-9"><span class="nav-number">17.50.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Refer"><span class="nav-number">18.</span> <span class="nav-text">Refer</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PS"><span class="nav-number">19.</span> <span class="nav-text">PS</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
