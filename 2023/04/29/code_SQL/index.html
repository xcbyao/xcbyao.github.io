<!DOCTYPE html>
<html lang="en">
<head>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "axm7ymo5bk");
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3JRCY1BFK"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1764421546773661" crossorigin="anonymous"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J3JRCY1BFK');
</script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="xcbyao,pwn,crypto,reverse,hack,信息熵洞,踏雪无痕">
    <meta name="description" content="凡心所向 素履以往 生如逆旅 一苇以航">
    <meta name="author" content="xcbyao">
    
    <title>
        
            SQL 数据库系列笔记 |
        
        Xcbyao&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"xcbyao.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#CC3333","avatar":"/images/avatar.png","favicon":"/images/favicon.ico","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.jpg","description":"我曾当年失意客，烟花依旧笑星空"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Xcbyao&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">SQL 数据库系列笔记</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.png">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">xcbyao</span>
                        
                            <span class="author-label">小妖</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2023-04-29 21:56:54</span>
        <span class="mobile">2023-04-29 21:56</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Programming/">Programming</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>13.1k Words</span>
        </span>
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="Pref"><a href="#Pref" class="headerlink" title="Pref"></a>Pref</h1><p>主要整理 SQL 语言，其次是 DBMS 等数据库知识，求职必备啊，欠下的知识迟早要补上，往后定要化被动为主动，学得太赶了，头秃……</p>
<h1 id="Basis"><a href="#Basis" class="headerlink" title="Basis"></a>Basis</h1><p>数据库（database）保存有组织的数据的容器（通常是一个或一组文件）</p>
<p>表（table）某种特定类型数据的结构化清单。</p>
<p>模式（schema）关于数据库和表的布局及特性的信息。</p>
<p>列（column）表中的一个字段。表都是由一个或多个列组成的。</p>
<p>数据类型（datatype）定义了列可以存储哪些数据种类。</p>
<p>行（row）表中的一个记录。也称记录（record），行才是正确术语。</p>
<p>主键（primary key）一列或几列，其值能够唯一标识表中每一行。</p>
<blockquote>
<p>注：应总是定义主键，可能不需要，但保证创建的每个表具有一个主键，便于以后的数据操作管理。</p>
</blockquote>
<p>满足条件：</p>
<ul>
<li>任意两行都不具有相同的主键值；</li>
<li>每一行都必须具有一个主键值（主键列不允许空值 NULL）；</li>
<li>主键列中的值不允许修改或更新；</li>
<li>主键值不能重用（若某行从表中删除，其主键不能再赋给新行）</li>
</ul>
<p>SQL（发音 sequel）（Structured Query Language）结构化查询语言。</p>
<p>多条 SQL 语句必须以分号（；）分隔，部分 DBMS 需要单条语句后都加。</p>
<p>SQL 语句不区分大小写。</p>
<p>处理 SQL 语句时，空格都被忽略。</p>
<p>SQL 语句一般返回无格式的数据。</p>
<p>子句（clause）SQL 语句由子句构成。一个子句通常由一个关键字加上所提供的数据组成。</p>
<p>可移植（portable）可在多个系统上运行。</p>
<p>查询（query）任何 SQL 语句都是查询。但一般指 SELECT 语句。</p>
<p>子查询（subquery）即嵌套在其他查询中的查询。</p>
<p>结果集（result set）SQL 查询所检索出的结果。</p>
<h1 id="检索数据"><a href="#检索数据" class="headerlink" title="检索数据"></a>检索数据</h1><h2 id="检索单个列"><a href="#检索单个列" class="headerlink" title="检索单个列"></a>检索单个列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p>从 Products 表中检索 prod_name 列。</p>
<p><img src="/images/select_1_column.png"></p>
<p>根据具体 DBMS 和客户端，会得出检索行数和时间。<br>如 MySQL——<code>9 rows in set (0.01 sec)</code></p>
<h2 id="检索多个列"><a href="#检索多个列" class="headerlink" title="检索多个列"></a>检索多个列</h2><blockquote>
<p>选择多列时，列名之间加逗号，最后一个不加，否则报错。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_2_column.png"></p>
<h2 id="检索所有列"><a href="#检索所有列" class="headerlink" title="检索所有列"></a>检索所有列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<h2 id="检索不同值"><a href="#检索不同值" class="headerlink" title="检索不同值"></a>检索不同值</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_id</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_id.png"></p>
<p>返回 9 行（即使表中只有 3 个产品供应商），因为 Products 表中有 9 种产品。</p>
<p>DISTINCT 关键字，指示数据库只返回不同的值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> vend_id</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_id2.png"></p>
<blockquote>
<p>注：不能部分使用 DISTINCT。作用于所有列，不单是跟在其后的那一列。</p>
</blockquote>
<h2 id="限制结果（DBMS-实现不同）"><a href="#限制结果（DBMS-实现不同）" class="headerlink" title="限制结果（DBMS 实现不同）"></a>限制结果（DBMS 实现不同）</h2><h3 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TOP <span class="number">5</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_top.png"></p>
<h3 id="DB2"><a href="#DB2" class="headerlink" title="DB2"></a>DB2</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">5</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><p>ROWNUM（行计数器）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> ROWNUM <span class="operator">&lt;=</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="MySQL、MariaDB、PostgreSQL-或-SQLite"><a href="#MySQL、MariaDB、PostgreSQL-或-SQLite" class="headerlink" title="MySQL、MariaDB、PostgreSQL 或 SQLite"></a>MySQL、MariaDB、PostgreSQL 或 SQLite</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line">LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<p>第一个数字是检索的行数，第二个数字是指从哪开始。<br>如下：返回从第 5 行起的 5 行数据。只有 9 种产品，所以只返回了 4 行数据。</p>
<blockquote>
<p>注：第一个被检索的行是第 0 行。<code>LIMIT 1 OFFSET 1</code> 会检索第 2 行。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line">LIMIT <span class="number">5</span> <span class="keyword">OFFSET</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_offset.png"></p>
<h4 id="MySQL、MariaDB-和-SQLite-捷径"><a href="#MySQL、MariaDB-和-SQLite-捷径" class="headerlink" title="MySQL、MariaDB 和 SQLite 捷径"></a>MySQL、MariaDB 和 SQLite 捷径</h4><p>可以把 <code>LIMIT 4 OFFSET 3</code> 简化为 <code>LIMIT 3,4</code></p>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 多行注释 */</span></span><br><span class="line"><span class="keyword">SELECT</span> prod_name <span class="comment">-- 注释，都支持</span></span><br><span class="line"><span class="keyword">FROM</span> Products; # 注释，有些不支持</span><br></pre></td></tr></table></figure>
<h1 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h1><h2 id="按单-多列排序"><a href="#按单-多列排序" class="headerlink" title="按单/多列排序"></a>按单/多列排序</h2><p>该子句取一个或多个列名，以字母顺序排序数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name; <span class="comment">-- 按单列排序</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price, prod_name; <span class="comment">-- 按多列排序</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注： ORDER BY 子句的位置应该是 SELECT 语句中最后一条子句，否则会报错。</p>
</blockquote>
<p><img src="/images/select_order.jpeg"></p>
<p><img src="/images/select_order2.png"></p>
<p>仅在多个行具有相同的 prod_price 值时，才对产品按 prod_name 进行排序。如果 prod_price 列中所有的值都是唯一的，则不会按 prod_name 排序。</p>
<h2 id="按列位置排序"><a href="#按列位置排序" class="headerlink" title="按列位置排序"></a>按列位置排序</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name <span class="comment">-- 按列位置排序</span></span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span>, <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_order3.jpeg"></p>
<p><code>ORDER BY 2，3</code> 表示先按 prod_price，再按 prod_name 进行排序。</p>
<h2 id="指定排序方向"><a href="#指定排序方向" class="headerlink" title="指定排序方向"></a>指定排序方向</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>; <span class="comment">-- 降序，默认是升序 A-Z</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/select_order4.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>, prod_name; <span class="comment">-- 多列分别排序</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/select_order5.jpeg"></p>
<p>prod_price 列以降序排序，prod_name 列（在每个价格内）按升序排序。</p>
<blockquote>
<p>注：若想在多列上进行降序排序，必须对每一列指定 DESC。<br>DESCENDING 是全写，亦可使用。<br>ASCENDING「ASC」升序，默认无需指定。<br>区分大小写和排序顺序：<br>在字典（dictionary）排序顺序中，大小写相同，是多数 DBMS 默认做法，同时允许改变。</p>
</blockquote>
<h1 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h1><h2 id="WHERE-子句"><a href="#WHERE-子句" class="headerlink" title="WHERE 子句"></a>WHERE 子句</h2><p>搜索条件（search criteria）也称过滤条件（filter condition）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="operator">=</span> <span class="number">3.49</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_where.png"></p>
<blockquote>
<p>ORDER BY 位于 WHERE 之后，否则将报错。</p>
</blockquote>
<h2 id="WHERE-操作符"><a href="#WHERE-操作符" class="headerlink" title="WHERE 操作符"></a>WHERE 操作符</h2><p>操作符（operator）用来联结或改变 WHERE 子句中的子句的关键字，也称为逻辑操作符（logical operator）。</p>
<table>
<thead>
<tr>
<th>操 作 符</th>
<th>说 明</th>
<th>操 作 符</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>等于</td>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&lt; &gt;</td>
<td>不等于</td>
<td>&gt;=</td>
<td>大于等于</td>
</tr>
<tr>
<td>!=</td>
<td>不等于</td>
<td>!&gt;</td>
<td>不大于</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
<td>BETWEEN</td>
<td>指定两个值之间（都包括）</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
<td>IS NULL</td>
<td>为NULL值</td>
</tr>
<tr>
<td>!&lt;</td>
<td>不小于</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="operator">&lt;</span> <span class="number">10</span>; <span class="comment">-- 检查单个值</span></span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">&lt;&gt;</span> <span class="string">&#x27;DLL01&#x27;</span>; <span class="comment">-- 不匹配检查</span></span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="keyword">BETWEEN</span> <span class="number">5</span> <span class="keyword">AND</span> <span class="number">10</span>; <span class="comment">-- 范围值检查</span></span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="keyword">IS</span> <span class="keyword">NULL</span>; <span class="comment">-- 空值检查</span></span><br></pre></td></tr></table></figure>
<p>NULL 无值（no value），与字段包含 0、空字符串或仅空格不同。<br>如上，返回空 prod_price 字段，不是价格为 0。</p>
<p><img src="/images/select_where2.png"></p>
<p><img src="/images/select_where3.png"></p>
<p><img src="/images/select_where4.png"></p>
<h1 id="高级数据过滤"><a href="#高级数据过滤" class="headerlink" title="高级数据过滤"></a>高级数据过滤</h1><h2 id="组合-WHERE-子句，AND-OR-IN-NOT-操作符"><a href="#组合-WHERE-子句，AND-OR-IN-NOT-操作符" class="headerlink" title="组合 WHERE 子句，AND OR IN NOT 操作符"></a>组合 WHERE 子句，AND OR IN NOT 操作符</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="keyword">AND</span> prod_price <span class="operator">&lt;=</span> <span class="number">4</span>;</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="keyword">OR</span> vend_id <span class="operator">=</span> <span class="string">&#x27;BRS01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_where_and.png"></p>
<p>许多 DBMS 在 OR WHERE 子句的第一个条件满足时，就不再计算第二个条件了。</p>
<p><img src="/images/select_where_or.png"></p>
<h3 id="求值顺序，-明确分组"><a href="#求值顺序，-明确分组" class="headerlink" title="求值顺序，() 明确分组"></a>求值顺序，() 明确分组</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> (vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="keyword">OR</span> vend_id <span class="operator">=</span> <span class="string">&#x27;BRS01&#x27;</span>)</span><br><span class="line">   <span class="keyword">AND</span> prod_price <span class="operator">&gt;=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_where_().png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="keyword">IN</span> (<span class="string">&#x27;DLL01&#x27;</span>,<span class="string">&#x27;BRS01&#x27;</span>) <span class="comment">-- IN 与 OR 功能相当</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="keyword">OR</span> vend_id <span class="operator">=</span> <span class="string">&#x27;BRS01&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>
<p>检索由供应商 DLL01 和 BRS01 制造的所有产品，以上两种表达一样。</p>
<p><img src="/images/select_where_in.png"></p>
<ul>
<li>IN 优点：<br>IN 操作符的语法更直观；<br>在与 AND 和 OR 组合使用 IN 时，求值顺序更容易管理；<br>IN 一般比一组 OR 执行更快；<br>IN 最大优点是可包含其他 SELECT 语句，能更动态地建立 WHERE 子句。</li>
</ul>
<p>NOT 从不单独使用（总是与其他操作符一起使用），所以它的语法与其他操作符不同。可以用在要过滤的列前，而不仅是在其后。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="comment">-- NOT 与 &lt;&gt; 功能相当</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">&lt;&gt;</span> <span class="string">&#x27;DLL01&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/select_where_not.png"></p>
<blockquote>
<p>MariaDB 支持使用 NOT 否定 IN、BETWEEN 和 EXISTS 子句。大多数<br>DBMS 允许使用 NOT 否定任何条件。</p>
</blockquote>
<h1 id="通配符过滤-LINK"><a href="#通配符过滤-LINK" class="headerlink" title="通配符过滤 LINK"></a>通配符过滤 LINK</h1><p>通配符（wildcard）用来匹配值的一部分的特殊字符。</p>
<p>搜索模式（search pattern）由字面值、通配符或两者组合构成的搜索条件。</p>
<p>谓词（predicate）即操作符作为谓词时。从技术上说，LIKE 是谓词。虽然最终的结果是相同的。</p>
<p>通配符搜索只能用于文本字段（字符串）。</p>
<h2 id="通配符"><a href="#通配符" class="headerlink" title="通配符 % _ []"></a>通配符 % _ []</h2><p><code>%</code> 表示任何字符出现任意次数（包括 0）。<br>子句 <code>WHERE prod_name LIKE &#39;%&#39;</code> 不会匹配产品名称为 NULL 的行。</p>
<p><code>_</code> 只匹配单个字符。（DB2 不支持通配符 <code>_</code>）</p>
<p><code>[]</code> 用来指定一个字符集，必须匹配指定位置的一个字符。<br>（SQL Server 支持集合，MySQL，Oracle，DB2，SQLite 都不支持。）<br>此通配符可以用前缀字符 <code>^</code>（脱字号）来否定。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;Fish%&#x27;</span>; <span class="comment">-- 所有以 Fish 开头产品，大小写区分根据 DBMS 配置</span></span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;%bean bag%&#x27;</span>; <span class="comment">-- 可使用多个通配符</span></span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;__ inch teddy bear&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/link_%25.png"></p>
<p><img src="/images/link_%252.png"></p>
<p><img src="/images/link__.png"></p>
<blockquote>
<p>注：字符串后面可能用空格填充，故匹配以某字母结尾，需要后面加百分号 <code>y%</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_contact <span class="keyword">LIKE</span> <span class="string">&#x27;[JM]%&#x27;</span> <span class="comment">-- 找出名字以 J 或 M 起头的联系人</span></span><br><span class="line"># <span class="keyword">WHERE</span> cust_contact <span class="keyword">LIKE</span> <span class="string">&#x27;[^JM]%&#x27;</span> <span class="comment">-- 更简化</span></span><br><span class="line"># <span class="keyword">WHERE</span> <span class="keyword">NOT</span> cust_contact <span class="keyword">LIKE</span> <span class="string">&#x27;[JM]%&#x27;</span> <span class="comment">-- 与 ^ 结果相同</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_contact;</span><br></pre></td></tr></table></figure>
<p><img src="/images/link_%5B%5D.png"></p>
<h2 id="通配符技巧"><a href="#通配符技巧" class="headerlink" title="通配符技巧"></a>通配符技巧</h2><p>不要过度使用通配符。耗时长，优先使用其他能达到相同目的的操作符。<br>尽量不要把它们用在搜索模式的开始处，这样搜索起来是最慢的。</p>
<h1 id="创建计算字段"><a href="#创建计算字段" class="headerlink" title="创建计算字段"></a>创建计算字段</h1><h2 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h2><p>计算字段是运行时在 SELECT 语句内创建的。</p>
<p>字段（field）基本上与列的意思相同，经常互换使用，不过数据库列一般称为列，而字段这个术语通常在计算字段这种场合下使用。</p>
<h2 id="拼接字段"><a href="#拼接字段" class="headerlink" title="拼接字段"></a>拼接字段</h2><p>拼接（concatenate）将值联结到一起（将一个值附加到另一个值）构成单个值。</p>
<p>SQL Server 使用 <code>+</code> 号。<br>DB2、Oracle、PostgreSQL 和 SQLite 使用 <code>||</code>。<br>MySQL 和 MariaDB 使用特殊函数 <code>Concat</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name <span class="operator">+</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">+</span> vend_country <span class="operator">+</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line"># <span class="keyword">SELECT</span> vend_name <span class="operator">||</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">||</span> vend_country <span class="operator">||</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line"># <span class="keyword">SELECT</span> Concat(vend_name, <span class="string">&#x27; (&#x27;</span>, vend_country, <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/+.png"></p>
<p>许多数据库保存填充为列宽的文本值，不需要这些空格时如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RTRIM(vend_name) <span class="operator">+</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">+</span> RTRIM(vend_country) <span class="operator">+</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/+2.png"></p>
<h2 id="别名-AS"><a href="#别名-AS" class="headerlink" title="别名 AS"></a>别名 AS</h2><p>别名（alias）有时也称导出列（derived column）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RTRIM(vend_name) <span class="operator">+</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">+</span> RTRIM(vend_country) <span class="operator">+</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line"> <span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/alias.png"></p>
<h2 id="执行算术计算"><a href="#执行算术计算" class="headerlink" title="执行算术计算"></a>执行算术计算</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id,</span><br><span class="line">    quantity,</span><br><span class="line">    item_price,</span><br><span class="line">    quantity<span class="operator">*</span>item_price <span class="keyword">AS</span> expanded_price</span><br><span class="line"><span class="keyword">FROM</span> OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">20008</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/expanded.png"></p>
<p>操作符：<code>+</code> 加 <code>-</code> 减 <code>*</code> 乘 <code>/</code> 除</p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><table>
<thead>
<tr>
<th>函 数</th>
<th>语 法</th>
</tr>
</thead>
<tbody><tr>
<td>提取字符串的组成部分</td>
<td>DB2、Oracle、PostgreSQL 和 SQLite 使用 SUBSTR()；MariaDB、MySQL 和 SQL Server 使用 SUBSTRING()</td>
</tr>
<tr>
<td>数据类型转换</td>
<td>Oracle 每种类型的转换有一个函数；DB2 和 PostgreSQL 使用 CAST()；MariaDB、MySQL 和 SQL Server 使用 CONVERT()</td>
</tr>
<tr>
<td>取当前日期</td>
<td>DB2 和 PostgreSQL 使用 CURRENT_DATE；MariaDB 和 MySQL 使用 CURDATE()；Oracle 使用 SYSDATE；SQL Server 使用 GETDATE()；SQLite 使用 DATE()</td>
</tr>
</tbody></table>
<p>多数 SQL 支持以下类型函数：</p>
<ul>
<li>处理文本字符串的文本函数；</li>
<li>数值数据上进行算术操作的数值函数；</li>
<li>处理日期时间并提取特定成分的日期和时间函数；</li>
<li>格式化函数，如货币符号和千分位表示金额；</li>
<li>返回 DBMS 正使用的特殊信息的系统函数。</li>
</ul>
<h2 id="文本处理函数"><a href="#文本处理函数" class="headerlink" title="文本处理函数"></a>文本处理函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, <span class="built_in">UPPER</span>(vend_name) <span class="keyword">AS</span> vend_name_upcase</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/upper.jpeg"></p>
<table>
<thead>
<tr>
<th>函 数</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>LEFT()（或使用子字符串函数）</td>
<td>返回字符串左边的字符 DB2, PostgreSQL, MySQL, SQL Server</td>
</tr>
<tr>
<td>RIGHT()（或使用子字符串函数）</td>
<td>返回字符串右边的字符</td>
</tr>
<tr>
<td>LENGTH() DATALENGTH() LEN()</td>
<td>返回字符串的长度</td>
</tr>
<tr>
<td>LOWER()</td>
<td>将字符串转换为小写</td>
</tr>
<tr>
<td>UPPER()</td>
<td>将字符串转换为大写</td>
</tr>
<tr>
<td>LTRIM()</td>
<td>去掉字符串左边的空格</td>
</tr>
<tr>
<td>RTRIM()</td>
<td>去掉字符串右边的空格</td>
</tr>
<tr>
<td>TRIM()</td>
<td>去掉字符串两边的空格</td>
</tr>
<tr>
<td>SUBSTR() SUBSTRING()</td>
<td>提取字符串的组成部分 Oracle, SQLite</td>
</tr>
<tr>
<td>SOUNDEX()</td>
<td>返回字符串的 SOUNDEX值</td>
</tr>
</tbody></table>
<p>SOUNDEX 是一个将任何文本串转换为描述其语音表示的字母数字模式的算法。能对字符串进行发音比较而不是字母比较。虽然 SOUNDEX 不是 SQL 概念，但多数 DBMS 都提供支持。</p>
<blockquote>
<p>PostgreSQL 不支持 SOUNDEX()。<br>如果在创建 SQLite 时使用了 SQLITE_SOUNDEX 编译时选项，那么 SOUNDEX() 才可用。因为 SQLITE_SOUNDEX 不是默认编译时选项，所以多数 SQLite 实现不支持 SOUNDEX()。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"># <span class="keyword">WHERE</span> cust_contact <span class="operator">=</span> <span class="string">&#x27;Michael Green&#x27;</span>; <span class="comment">-- 用正确拼写无法检索</span></span><br><span class="line"><span class="keyword">WHERE</span> SOUNDEX(cust_contact) <span class="operator">=</span> SOUNDEX(<span class="string">&#x27;Michael Green&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>表中的联系名是 Michelle Green 有误，正确拼写是 Michael Green。</p>
<h2 id="日期和时间函数"><a href="#日期和时间函数" class="headerlink" title="日期和时间函数"></a>日期和时间函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> order_num</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">WHERE</span> DATEPART(yy, order_date) <span class="operator">=</span> <span class="number">2020</span>; <span class="comment">-- SQL Server。参数：返回的成分和从中返回成分的日期。</span></span><br><span class="line"># <span class="keyword">WHERE</span> DATE_PART(<span class="string">&#x27;year&#x27;</span>, order_date) <span class="operator">=</span> <span class="number">2020</span>; <span class="comment">-- PostgreSQL</span></span><br><span class="line"># <span class="keyword">WHERE</span> <span class="built_in">EXTRACT</span>(<span class="keyword">year</span> <span class="keyword">FROM</span> order_date) <span class="operator">=</span> <span class="number">2020</span>; <span class="comment">-- Oracle, PostgreSQL</span></span><br><span class="line"># <span class="keyword">WHERE</span> order_date <span class="keyword">BETWEEN</span> to_date(<span class="string">&#x27;2020-01-01&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span> to_date(<span class="string">&#x27;2020-12-31&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>); <span class="comment">-- Oracle，将两个字符串转换为日期；SQL Server 不支持 to_date()，但这里换成 DATEPART() 支持</span></span><br><span class="line"># <span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(order_date) <span class="operator">=</span> <span class="number">2020</span>; <span class="comment">-- DB2，MySQL 和 MariaDB 具有各种日期处理函数，但没有 DATEPART()</span></span><br><span class="line"># <span class="keyword">WHERE</span> strftime(<span class="string">&#x27;%Y&#x27;</span>, order_date) <span class="operator">=</span> <span class="string">&#x27;2020&#x27;</span>; <span class="comment">-- SQLite</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/date.png"></p>
<h2 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h2><table>
<thead>
<tr>
<th>函 数</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>ABS()</td>
<td>返回一个数的绝对值</td>
</tr>
<tr>
<td>SIN()</td>
<td>返回一个角度的正弦</td>
</tr>
<tr>
<td>COS()</td>
<td>返回一个角度的余弦</td>
</tr>
<tr>
<td>TAN()</td>
<td>返回一个角度的正切</td>
</tr>
<tr>
<td>EXP()</td>
<td>返回一个数的指数值</td>
</tr>
<tr>
<td>SQRT()</td>
<td>返回一个数的平方根</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率 π 的值</td>
</tr>
</tbody></table>
<h1 id="汇总数据"><a href="#汇总数据" class="headerlink" title="汇总数据"></a>汇总数据</h1><h2 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h2><p>聚集函数（aggregate function）对某些行运行的函数，计算并返回一个值。</p>
<table>
<thead>
<tr>
<th>函 数</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>返回某列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回某列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列值之和</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(prod_price) <span class="keyword">AS</span> avg_price <span class="comment">-- AVG() 只用于单列，忽略列值为 NULL 的行。</span></span><br><span class="line"><span class="keyword">FROM</span> Products; <span class="comment">-- 表中所有产品</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/avg().png"></p>
<p>使用 COUNT(*) 对表中行的数目进行计数，包括空值（NULL）。<br>使用 COUNT(column) 对特定列中具有值的行进行计数，忽略 NULL 值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_cust</span><br><span class="line"># <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(cust_email) <span class="keyword">AS</span> num_cust</span><br><span class="line"><span class="keyword">FROM</span> Customers;</span><br></pre></td></tr></table></figure>
<p><img src="/images/count().png"></p>
<p>MAX() 一般用来找出最大的数值或日期值；用于文本数据时，返回按该列排序后的最后一行，忽略列值为 NULL 的行。MIN() 相反。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(item_price<span class="operator">*</span>quantity) <span class="keyword">AS</span> total_price <span class="comment">-- 计算总价钱</span></span><br><span class="line"><span class="keyword">FROM</span> OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">20005</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/sum().png"></p>
<h2 id="聚集不同值"><a href="#聚集不同值" class="headerlink" title="聚集不同值"></a>聚集不同值</h2><p>对所有行执行计算，指定 ALL 参数（默认）或不指定参数。<br>只包含不同的值，指定 DISTINCT 参数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(<span class="keyword">DISTINCT</span> prod_price) <span class="keyword">AS</span> avg_price <span class="comment">-- 平均值只考虑各个不同的价格，相同价格会排除</span></span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span>;</span><br><span class="line"># 输出：<span class="number">4.2400</span></span><br></pre></td></tr></table></figure>
<p>DISTINCT 不能用于 COUNT(*)，只能用于 COUNT()。<br>DISTINCT 必须使用列名，不能用于计算或表达式。</p>
<h2 id="组合聚集函数"><a href="#组合聚集函数" class="headerlink" title="组合聚集函数"></a>组合聚集函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_items,</span><br><span class="line">    <span class="built_in">MIN</span>(prod_price) <span class="keyword">AS</span> price_min,</span><br><span class="line">    <span class="built_in">MAX</span>(prod_price) <span class="keyword">AS</span> price_max,</span><br><span class="line">    <span class="built_in">AVG</span>(prod_price) <span class="keyword">AS</span> price_avg</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
<p><img src="/images/count()2.png"></p>
<blockquote>
<p>注：最好指定别名以包含某个聚集函数的结果。否则许多 SQL 可能会产生错误消息。</p>
</blockquote>
<h1 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h1><h2 id="创建分组-GROUP-BY"><a href="#创建分组-GROUP-BY" class="headerlink" title="创建分组 GROUP BY"></a>创建分组 GROUP BY</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_prods</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id; <span class="comment">-- 按 vend_id 排序并分组数据</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/group.png"></p>
<p>GROUP BY 子句可以包含任意数目的列，还可以嵌套，但不能是聚集函数。<br>如果在 SELECT 中使用表达式，则必须在 GROUP BY 中指定相同的表达式，不能使用别名。<br>多数 SQL 实现不允许 GROUP BY 列带有长度可变的数据类型（如文本或备注型字段）<br>除聚集计算语句外，SELECT 语句中的每一列都必须在 GROUP BY 中给出。<br>如果分组列中包含具有 NULL 值的行，则 NULL 将作为一个分组返回。列中多行 NULL 值，将分为一组。<br>GROUP BY 必须出现在 WHERE 之后，ORDER BY 之前。</p>
<blockquote>
<p>SQL Server 等有些 SQL 实现在 GROUP BY 中支持可选的 ALL 子句。用来返回所有分组，即使是没有匹配行的分组也返回（在此情况下，聚集将返回 NULL）。</p>
</blockquote>
<blockquote>
<p>通过相对位置指定列：<br>有些 SQL 实现允许根据 SELECT 列表中的位置指定 GROUP BY 的列。<br>如 <code>GROUP BY 2, 1</code> 表示按选择的第二个列分组，再按第一个列分组。</p>
</blockquote>
<h2 id="过滤分组"><a href="#过滤分组" class="headerlink" title="过滤分组"></a>过滤分组</h2><p>WHERE 过滤行，HAVING 过滤分组。HAVING 支持所有 WHERE 操作符。<br>WHERE 在数据分组前进行过滤，HAVING 在分组后过滤。<br>WHERE 排除的行不包括在分组中，可能会改变计算值，从而影响 HAVING 中基于这些值过滤掉的分组。<br>使用 HAVING 时应该结合 GROUP BY，而 WHERE 用于标准的行级过滤。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> orders</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cust_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/having.png"></p>
<h2 id="分组和排序"><a href="#分组和排序" class="headerlink" title="分组和排序"></a>分组和排序</h2><table>
<thead>
<tr>
<th>ORDER BY</th>
<th>GROUP BY</th>
</tr>
</thead>
<tbody><tr>
<td>对产生的输出排序</td>
<td>对行分组，输出可能不是分组的顺序</td>
</tr>
<tr>
<td>任意列都可用（甚至非选择的列）</td>
<td>只能使用选择列或表达式列，且必须使用每个选择列表达式</td>
</tr>
<tr>
<td>不一定需要</td>
<td>如果与聚集函数一起使用列（或表达式），则必须使用</td>
</tr>
</tbody></table>
<blockquote>
<p>一般在使用 GROUP BY 时，也给出 ORDER BY。这是保证数据正确排序的唯一方法。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> order_num, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> items</span><br><span class="line"><span class="keyword">FROM</span> OrderItems</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> order_num</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> items, order_num;</span><br></pre></td></tr></table></figure>
<p><img src="/images/group2.png"></p>
<h2 id="SELECT-子句顺序"><a href="#SELECT-子句顺序" class="headerlink" title="SELECT 子句顺序"></a>SELECT 子句顺序</h2><table>
<thead>
<tr>
<th>子 句</th>
<th>说 明</th>
<th>是否必须使用</th>
</tr>
</thead>
<tbody><tr>
<td>SELECT</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>FROM</td>
<td>从中检索数据的表</td>
<td>仅在从表选择数据时使用</td>
</tr>
<tr>
<td>WHERE</td>
<td>行级过滤</td>
<td>否</td>
</tr>
<tr>
<td>GROUP BY</td>
<td>分组说明</td>
<td>仅在按组计算聚集时使用</td>
</tr>
<tr>
<td>HAVING</td>
<td>组级过滤</td>
<td>否</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>输出排序顺序</td>
<td>否</td>
</tr>
</tbody></table>
<h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><h2 id="子查询过滤"><a href="#子查询过滤" class="headerlink" title="子查询过滤"></a>子查询过滤</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> cust_id</span><br><span class="line">                  <span class="keyword">FROM</span> Orders</span><br><span class="line">                  <span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">                                      <span class="keyword">FROM</span> OrderItems</span><br><span class="line">                                      <span class="keyword">WHERE</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>));</span><br></pre></td></tr></table></figure>
<p><img src="/images/subquery.png"></p>
<p>子查询的 SELECT 语句只能查询单个列。</p>
<h2 id="作为计算字段使用"><a href="#作为计算字段使用" class="headerlink" title="作为计算字段使用"></a>作为计算字段使用</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,</span><br><span class="line">       cust_state,</span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">        <span class="keyword">FROM</span> Orders</span><br><span class="line">        <span class="keyword">WHERE</span> Orders.cust_id <span class="operator">=</span> Customers.cust_id) <span class="keyword">AS</span> orders</span><br><span class="line">        <span class="comment">-- 完全限定列名，指定表名和列名，比较 Orders 表中的 cust_id 和正从 Customers 表中检索的 cust_id</span></span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/subquery2.png"></p>
<p>SELECT 对 Customers 表中每个顾客返回三列： cust_name、<br>cust_state 和 orders。<br>orders 是一个计算字段，由括号中子查询建立。该子查询对检索出的每个顾客执行一次。</p>
<h1 id="联结表"><a href="#联结表" class="headerlink" title="联结表"></a>联结表</h1><p><strong>联结（join）</strong>是一种机制，用来在一条 SELECT 语句中关联表。要保证所有联结都有 WHERE 子句。</p>
<p><strong>关系表</strong>的设计就是要把信息分解成多个表，一类数据一个表。各表通过某些共同的值互相关联（所以才叫关系数据库）。</p>
<p><strong>可伸缩（scale）</strong>能够适应不断增加的工作量而不失败。设计良好的数据库或应用程序称为可伸缩性好（scale well）</p>
<h2 id="创建联结"><a href="#创建联结" class="headerlink" title="创建联结"></a>创建联结</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Vendors, Products</span><br><span class="line"><span class="keyword">WHERE</span> Vendors.vend_id <span class="operator">=</span> Products.vend_id; <span class="comment">-- 指示 DBMS 将 Vendors 表中的 vend_id 与 Products 表中的匹配起来。</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/join.png"></p>
<p><strong>笛卡儿积（cartesian product）</strong>由没有联结条件的表关系返回的结果为笛卡儿积。检索出的行的数目将是第一个表中的行数乘以第二个表中的行数。返回笛卡儿积的联结，也称<strong>叉联结（cross join）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Vendors, Products; <span class="comment">-- 返回笛卡尔积</span></span><br></pre></td></tr></table></figure>
<h2 id="内联结"><a href="#内联结" class="headerlink" title="内联结"></a>内联结</h2><p>以上联结称为<strong>等值联结（equijoin）</strong>，基于两个表之间的相等测试。也称为<strong>内联结（inner join）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Products <span class="keyword">ON</span> Vendors.vend_id <span class="operator">=</span> Products.vend_id;</span><br></pre></td></tr></table></figure>
<p>两个表之间的关系是以 INNER JOIN 指定的部分 FROM 子句。联结条件用特定的 ON 子句而不是 WHERE 子句给出。传递给 ON 的实际条件与传递给 WHERE 的相同。</p>
<blockquote>
<p>ANSI SQL 规范首选 INNER JOIN 语法。</p>
</blockquote>
<h2 id="联结多个表"><a href="#联结多个表" class="headerlink" title="联结多个表"></a>联结多个表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, vend_name, prod_price, quantity</span><br><span class="line"><span class="keyword">FROM</span> OrderItems, Products, Vendors</span><br><span class="line"><span class="keyword">WHERE</span> Products.vend_id <span class="operator">=</span> Vendors.vend_id</span><br><span class="line"> <span class="keyword">AND</span> OrderItems.prod_id <span class="operator">=</span> Products.prod_id</span><br><span class="line"> <span class="keyword">AND</span> order_num <span class="operator">=</span> <span class="number">20007</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/join2.png"></p>
<p>这个例子显示订单 20007 中的物品。订单物品存储在 OrderItems 表中。<br>每个产品按其产品 ID 存储，它引用 Products 表中的产品。这些产品通<br>过供应商 ID 联结到 Vendors 表中相应的供应商，供应商 ID 存储在每个<br>产品的记录中。</p>
<blockquote>
<p>DBMS 对联结中表的最大数目有限制。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> cust_id</span><br><span class="line">                  <span class="keyword">FROM</span> Orders</span><br><span class="line">                  <span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">                                      <span class="keyword">FROM</span> OrderItems</span><br><span class="line">                                      <span class="keyword">WHERE</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>));</span><br><span class="line"></span><br><span class="line"># 联结更有效</span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers, Orders, OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id</span><br><span class="line"> <span class="keyword">AND</span> Orders.order_num <span class="operator">=</span> OrderItems.order_num</span><br><span class="line"> <span class="keyword">AND</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/join3.png"></p>
<h1 id="高级联结"><a href="#高级联结" class="headerlink" title="高级联结"></a>高级联结</h1><h2 id="表别名"><a href="#表别名" class="headerlink" title="表别名"></a>表别名</h2><p>表别名只在查询执行中使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> C, Orders <span class="keyword">AS</span> O, OrderItems <span class="keyword">AS</span> OI</span><br><span class="line"><span class="keyword">WHERE</span> C.cust_id <span class="operator">=</span> O.cust_id</span><br><span class="line"> <span class="keyword">AND</span> O.order_num <span class="operator">=</span> OI.order_num</span><br><span class="line"> <span class="keyword">AND</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Oracle 不支持 AS 关键字，直接指定即可 <code>Customers C</code></p>
</blockquote>
<h2 id="不同类型的联结"><a href="#不同类型的联结" class="headerlink" title="不同类型的联结"></a>不同类型的联结</h2><h3 id="自联结（self-join）"><a href="#自联结（self-join）" class="headerlink" title="自联结（self-join）"></a>自联结（self-join）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id, cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name <span class="operator">=</span> (<span class="keyword">SELECT</span> cust_name</span><br><span class="line">                   <span class="keyword">FROM</span> Customers</span><br><span class="line">                   <span class="keyword">WHERE</span> cust_contact <span class="operator">=</span> <span class="string">&#x27;Jim Jones&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 使用联结的相同查询</span><br><span class="line"><span class="keyword">SELECT</span> c1.cust_id, c1.cust_name, c1.cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> c1, Customers <span class="keyword">AS</span> c2</span><br><span class="line"><span class="keyword">WHERE</span> c1.cust_name <span class="operator">=</span> c2.cust_name</span><br><span class="line"><span class="keyword">AND</span> c2.cust_contact <span class="operator">=</span> <span class="string">&#x27;Jim Jones&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/join4.png"></p>
<p>此查询中需要的两个表实际上是相同的表，因此 Customers 表在 FROM<br>子句中出现了两次。虽然这是完全合法的，但对 Customers 的引用具有<br>歧义性，因此使用表别名。</p>
<ul>
<li>用自联结而不用子查询<br>自联结通常作为外部语句，用来替代从相同表中检索数据的使用子查询语句。许多 DBMS 处理联结远比子查询快。</li>
</ul>
<h3 id="自然联结（natural-join）"><a href="#自然联结（natural-join）" class="headerlink" title="自然联结（natural join）"></a>自然联结（natural join）</h3><p>标准联结（内联结）返回所有数据，相同的列甚至多次出现。<br>自然联结排除多次出现，使每一列只返回一次。</p>
<p>自然联结只能选择唯一的列，一般通过对一个表使用通配符（SELECT *），而对其他表的列使用明确的子集来完成。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> C.<span class="operator">*</span>, O.order_num, O.order_date,</span><br><span class="line">       OI.prod_id, OI.quantity, OI.item_price</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> C, Orders <span class="keyword">AS</span> O, OrderItems <span class="keyword">AS</span> OI</span><br><span class="line"><span class="keyword">WHERE</span> C.cust_id <span class="operator">=</span> O.cust_id</span><br><span class="line"> <span class="keyword">AND</span> OI.order_num <span class="operator">=</span> O.order_num</span><br><span class="line"> <span class="keyword">AND</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>很可能永远都不会用到不是自然联结的内联结。</p>
</blockquote>
<h3 id="外联结（outer-join）"><a href="#外联结（outer-join）" class="headerlink" title="外联结（outer join）"></a>外联结（outer join）</h3><p>联结包含了那些在相关表中没有关联行的行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"> <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders <span class="keyword">ON</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id;</span><br></pre></td></tr></table></figure>
<p><img src="/images/join5.jpeg"></p>
<p>使用 OUTER JOIN 时，必须使用 RIGHT 或 LEFT 关键字指定包括其所有行的表。RIGHT 指出的是 OUTER JOIN 右边的表，LEFT 指左边。</p>
<blockquote>
<p>SQLite 支持 LEFT OUTER JOIN，但不支持 RIGHT OUTER JOIN。</p>
</blockquote>
<p><strong>全外联结（full outer join）</strong>检索两个表中的所有行并关联那些可以关联的行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"> <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders <span class="keyword">ON</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>MariaDB、MySQL 和 SQLite 不支持全外联结。</p>
</blockquote>
<h2 id="带聚集函数的联结"><a href="#带聚集函数的联结" class="headerlink" title="带聚集函数的联结"></a>带聚集函数的联结</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id,</span><br><span class="line">       <span class="built_in">COUNT</span>(Orders.order_num) <span class="keyword">AS</span> num_ord</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"> <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders <span class="keyword">ON</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Customers.cust_id;</span><br></pre></td></tr></table></figure>
<p><img src="/images/join6.png"></p>
<blockquote>
<p>一般使用内联结，但使用外联结也有效。<br>总是提供联结条件，否则会得出笛卡儿积。</p>
</blockquote>
<h1 id="组合查询-UNION"><a href="#组合查询-UNION" class="headerlink" title="组合查询 UNION"></a>组合查询 UNION</h1><p>组合查询通常称为<strong>并（union）</strong>或<strong>复合查询（compound query）</strong></p>
<p>使用情况：<br>在一个查询中从不同的表返回结构数据；<br>对一个表执行多个查询，按一个查询返回数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;IL&#x27;</span>,<span class="string">&#x27;IN&#x27;</span>,<span class="string">&#x27;MI&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name <span class="operator">=</span> <span class="string">&#x27;Fun4All&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">WHERE</span> 相同结果</span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;IL&#x27;</span>,<span class="string">&#x27;IN&#x27;</span>,<span class="string">&#x27;MI&#x27;</span>) <span class="keyword">OR</span> cust_name <span class="operator">=</span> <span class="string">&#x27;Fun4All&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/union.png"></p>
<h2 id="UNION-规则"><a href="#UNION-规则" class="headerlink" title="UNION 规则"></a>UNION 规则</h2><p>UNION 必须由两条或以上的 SELECT 语句组成，语句之间用 UNION 分隔；<br>UNION 中每个查询必须包含相同的列、表达式或聚集函数；<br>列数据类型必须兼容：类型不必完全相同，但必须是 DBMS 可以隐含转换的类型（如，不同数值类型或不同日期类型）。</p>
<blockquote>
<p>注：结合 UNION 使用的 SELECT 语句遇到不同的列名，会返回第一个名字，其他语句使用时也必须以第一个为准，否则报错。</p>
</blockquote>
<h2 id="包含或取消重复的行-UNION-ALL"><a href="#包含或取消重复的行-UNION-ALL" class="headerlink" title="包含或取消重复的行 UNION ALL"></a>包含或取消重复的行 UNION ALL</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;IL&#x27;</span>,<span class="string">&#x27;IN&#x27;</span>,<span class="string">&#x27;MI&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="comment">-- 返回所有匹配行，可能有重复</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name <span class="operator">=</span> <span class="string">&#x27;Fun4All&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/union_all.png"></p>
<h2 id="对组合查询结果排序"><a href="#对组合查询结果排序" class="headerlink" title="对组合查询结果排序"></a>对组合查询结果排序</h2><p>使用 UNION 时，只能使用一条 ORDER BY，必须位于最后一条 SELECT 语句之后。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;IL&#x27;</span>,<span class="string">&#x27;IN&#x27;</span>,<span class="string">&#x27;MI&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name <span class="operator">=</span> <span class="string">&#x27;Fun4All&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name, cust_contact;</span><br></pre></td></tr></table></figure>
<p><img src="/images/union2.png"></p>
<blockquote>
<p>某些 DBMS 还支持其他 UNION：<code>EXCEPT</code>（有时称为 <code>MINUS</code>）用来检索只在第一个表中存在而在第二个表中不存在的行；而 <code>INTERSECT</code> 用来检索两个表中都存在的行。实际上这两种很少使用，因为相同结果可用联结得到。</p>
</blockquote>
<h1 id="插入数据-INSERT"><a href="#插入数据-INSERT" class="headerlink" title="插入数据 INSERT"></a>插入数据 INSERT</h1><h2 id="插入完整行"><a href="#插入完整行" class="headerlink" title="插入完整行"></a>插入完整行</h2><p>必须给每一列提供一个值，没有值则指定 NULL。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 不安全，避免使用，次序要和表一致。</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1000000006</span>,</span><br><span class="line">       <span class="string">&#x27;Toy Land&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;123 Any Street&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;New York&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;NY&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11111&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;USA&#x27;</span>,</span><br><span class="line">       <span class="keyword">NULL</span>,</span><br><span class="line">       <span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 更安全，次序随意，以列名匹配。</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country,</span><br><span class="line">                      cust_contact,</span><br><span class="line">                      cust_email)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1000000006</span>,</span><br><span class="line">       <span class="string">&#x27;Toy Land&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;123 Any Street&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;New York&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;NY&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11111&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;USA&#x27;</span>,</span><br><span class="line">       <span class="keyword">NULL</span>,</span><br><span class="line">       <span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不能插入同一条记录两次，主键（cust_id）的值必须有唯一性。</p>
</blockquote>
<h2 id="插入部分行"><a href="#插入部分行" class="headerlink" title="插入部分行"></a>插入部分行</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1000000006</span>,</span><br><span class="line">       <span class="string">&#x27;Toy Land&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;123 Any Street&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;New York&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;NY&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;11111&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;USA&#x27;</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>省略列<br>该列定义为允许 NULL 值（无值或空值）；<br>在表定义中给出默认值。</li>
</ul>
<h2 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据"></a>插入检索出的数据</h2><p>从 CustNew 表中读出数据并插入到 Customers 表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_contact,</span><br><span class="line">                      cust_email,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country)</span><br><span class="line"><span class="keyword">SELECT</span> cust_id,</span><br><span class="line">       cust_contact,</span><br><span class="line">       cust_email,</span><br><span class="line">       cust_name,</span><br><span class="line">       cust_address,</span><br><span class="line">       cust_city,</span><br><span class="line">       cust_state,</span><br><span class="line">       cust_zip,</span><br><span class="line">       cust_country</span><br><span class="line"><span class="keyword">FROM</span> CustNew;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：INSERT SELECT 中的列名，这里不一定要求列名匹配，以两个表对应的列位置匹配。</p>
</blockquote>
<p>INSERT 通常只插入一行。要插入多行，必须执行多个 INSERT 语句。INSERT SELECT 是例外。</p>
<h2 id="一个表复制到另一个表"><a href="#一个表复制到另一个表" class="headerlink" title="一个表复制到另一个表"></a>一个表复制到另一个表</h2><p>CREATE SELECT 语句（SQL Server 也可用 SELECT INTO）（DB2 不支持 CREATE SELECT）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> CustCopy <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Customers; <span class="comment">-- MySQL, MariaDB, Oracle, PostgreSQL, SQLite</span></span><br><span class="line"># <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">INTO</span> CustCopy <span class="keyword">FROM</span> Customers; <span class="comment">-- SQL Server</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>SELECT INTO 是试验新 SQL 语句前进行表复制的很好工具，不影响实际数据。</p>
</blockquote>
<h3 id="SELECT-INTO-注意事项"><a href="#SELECT-INTO-注意事项" class="headerlink" title="SELECT INTO 注意事项"></a>SELECT INTO 注意事项</h3><p>任何 SELECT 选项和子句都可使用；<br>可利用联结从多个表插入数据；<br>不管从多少表中检索数据，数据只能插入到一个表中。</p>
<h1 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h1><p>不要省略 WHERE 子句。UPDATE 语句以 WHERE 结束，它告诉 DBMS 更新哪一行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UPDATE Customers <span class="comment">-- 要更新的表</span></span><br><span class="line"><span class="keyword">SET</span> cust_contact <span class="operator">=</span> <span class="string">&#x27;Sam Roberts&#x27;</span>,</span><br><span class="line">    cust_email <span class="operator">=</span> <span class="string">&#x27;kim@thetoystore.com&#x27;</span> <span class="comment">-- 列名和新值</span></span><br><span class="line">    # cust_email <span class="operator">=</span> <span class="keyword">NULL</span> <span class="comment">-- 删除值</span></span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="number">1000000005</span>; <span class="comment">-- 过滤条件</span></span><br></pre></td></tr></table></figure>
<h1 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="number">1000000006</span>;</span><br></pre></td></tr></table></figure>
<p>使用外键确保引用完整性的一个好处是 DBMS 通常可以防止删除某数据与其他表相关联的行。<br>如，要从 Products 表中删除一个产品，而这个产品用在 OrderItems 的已有订单中，那么 DELETE 语句将抛出错误并中止。这是总要定义外键的另一个理由。</p>
<p>DELETE 删除整行而不是列。删除指定列，用 UPDATE 语句。</p>
<p>想从表中删除所有行，可使用 <code>TRUNCATE TABLE</code> 语句速度更快（因为不记录数据的变动）。</p>
<h2 id="更新和删除指导原则"><a href="#更新和删除指导原则" class="headerlink" title="更新和删除指导原则"></a>更新和删除指导原则</h2><p>除非打算更新和删除每一行，否则绝对带着 WHERE 子句。</p>
<p>在 UPDATE 或 DELETE 语句使用 WHERE 子句前，应先用 SELECT 进行测试，保证它过滤的是正确的记录，以防编写的 WHERE 子句不正确。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="number">1000000042</span>;</span><br><span class="line"><span class="keyword">DELETE</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="operator">=</span> <span class="number">1000000042</span>;</span><br></pre></td></tr></table></figure>
<h1 id="表"><a href="#表" class="headerlink" title="表"></a>表</h1><h2 id="创建表-CREATE-TABLE"><a href="#创建表-CREATE-TABLE" class="headerlink" title="创建表 CREATE TABLE"></a>创建表 CREATE TABLE</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Products <span class="comment">-- 新表名</span></span><br><span class="line">( <span class="comment">-- 表列的名字和定义，逗号分隔</span></span><br><span class="line">    prod_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    vend_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    prod_name <span class="type">CHAR</span>(<span class="number">254</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    prod_price <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    prod_desc <span class="type">VARCHAR</span>(<span class="number">1000</span>) <span class="keyword">NULL</span> <span class="comment">-- DB2 必须从最后一列中去掉 NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>允许 NULL 值的列也允许在插入行时不给出该列的值。<br>不允许的列不接受没有列值的行，即插入或更新行时，该列必须有值。<br>只有不允许 NULL 值的列可作为主键。</p>
<p>NULL 值不是空字符串，如果指定 <code>&#39;&#39;</code>（其间无字符），这在 NOT NULL 列中是允许的。空字符串是一个有效的值，它不是无值。</p>
<h2 id="指定默认值-DEFAULT"><a href="#指定默认值-DEFAULT" class="headerlink" title="指定默认值 DEFAULT"></a>指定默认值 DEFAULT</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> OrderItems</span><br><span class="line">(</span><br><span class="line">    order_num <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    order_item <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    prod_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    quantity <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    item_price <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>获得系统日期<table>
<thead>
<tr>
<th>DBMS</th>
<th>函数/变量</th>
</tr>
</thead>
<tbody><tr>
<td>DB2</td>
<td>CURRENT_DATE</td>
</tr>
<tr>
<td>MySQL</td>
<td>CURRENT_DATE()</td>
</tr>
<tr>
<td>Oracle</td>
<td>SYSDATE</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>CURRENT_DATE</td>
</tr>
<tr>
<td>SQL Server</td>
<td>GETDATE()</td>
</tr>
<tr>
<td>SQLite</td>
<td>date(‘now’)</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="更新表-ALTER-TABLE"><a href="#更新表-ALTER-TABLE" class="headerlink" title="更新表 ALTER TABLE"></a>更新表 ALTER TABLE</h2><p>许多 DBMS 不允许删除或更改表中的列，允许重命名；<br>限制对已经填有数据的列进行更改，对未填有数据的列几乎无限制。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line"><span class="keyword">ADD</span> vend_phone <span class="type">CHAR</span>(<span class="number">20</span>);</span><br><span class="line"># <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> vend_phone; <span class="comment">-- 部分 DBMS 支持</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>SQLite 不支持用 ALTER TABLE 定义主键和外键，必须在最初创建表时指定。</p>
</blockquote>
<ul>
<li>复杂的表结构更改一般需要手动删除：</li>
</ul>
<ol>
<li>创建一个新表；</li>
<li>用 INSERT SELECT 语句从旧表复制数据到新表，按需要修改；</li>
<li>检验包含所需数据的新表；</li>
<li>重命名旧表（若确定，可删除它）；</li>
<li>用旧表名字重命名新表；</li>
<li>重新创建触发器、存储过程、索引和外键。</li>
</ol>
<h2 id="删除表-DROP-TABLE"><a href="#删除表-DROP-TABLE" class="headerlink" title="删除表 DROP TABLE"></a>删除表 DROP TABLE</h2><p>删除表没有确认步骤，不能撤销，将永久删除。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> CustCopy;</span><br></pre></td></tr></table></figure>
<h2 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h2><p>DB2、MariaDB、MySQL、Oracle、PostgreSQL 使用 RENAME 语句；<br>SQL Server 使用 sp_rename 存储过程；<br>SQLite 使用 ALTER TABLE 语句。</p>
<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><p>视图是虚拟的表。表包含数据，视图只包含使用时动态检索数据的查询。</p>
<blockquote>
<p>SQLite 仅支持只读视图，所以视图可以创建、读，但内容不能更改。<br>所有 DBMS 一致支持视图创建语法。</p>
</blockquote>
<p>删除视图，<code>DROP VIEW viewname;</code><br>覆盖或更新视图，必须先删除再重新创建。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers, Orders, OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id</span><br><span class="line"><span class="keyword">AND</span> OrderItems.order_num <span class="operator">=</span> Orders.order_num</span><br><span class="line"><span class="keyword">AND</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把上面查询包装成虚拟表 ProductCustomers</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> ProductCustomers</span><br><span class="line"><span class="keyword">WHERE</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="视图应用"><a href="#视图应用" class="headerlink" title="视图应用"></a>视图应用</h2><p>重用 SQL 语句。<br>简化复杂的 SQL 操作。<br>使用表的一部分而不是整个表。<br>保护数据。可以授予用户访问表的特定部分的权限，而不是整个表的访问权限。<br>更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。</p>
<h2 id="视图规则和限制"><a href="#视图规则和限制" class="headerlink" title="视图规则和限制"></a>视图规则和限制</h2><p>视图必须唯一命名，不能和其他表名重复。<br>创建的视图数目没有限制，必须具有足够的访问权限。<br>视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造视图。所允许的嵌套层数在不同的 DBMS 中有所不同（嵌套视图可能会严重降低查询性能，因此使用前应进行全面测试）。<br>许多 DBMS 禁止在视图查询中使用 ORDER BY 子句。<br>有些 DBMS 要求对返回的所有列进行命名，如果列是计算字段，则需要使用别名。<br>视图不能索引，也不能有关联的触发器或默认值。<br>有些 DBMS 把视图作为只读的查询，这表示可以从视图检索数据，但不能将数据写回底层表。<br>有些 DBMS 允许创建这样的视图，它不能进行导致行不再属于视图的插入或更新。例如有一个视图，只检索带有邮件地址的顾客。如果更新某个顾客，删除他的电子邮件地址，将使该顾客不再属于视图。这是允许的默认行为，但有的 DBMS 可能会阻止。</p>
<h2 id="用视图简化复杂的联结"><a href="#用视图简化复杂的联结" class="headerlink" title="用视图简化复杂的联结"></a>用视图简化复杂的联结</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ProductCustomers <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, prod_id</span><br><span class="line"><span class="keyword">FROM</span> Customers, Orders, OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id</span><br><span class="line"> <span class="keyword">AND</span> OrderItems.order_num <span class="operator">=</span> Orders.order_num;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> ProductCustomers</span><br><span class="line"><span class="keyword">WHERE</span> prod_id <span class="operator">=</span> <span class="string">&#x27;RGAN01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/view.png"></p>
<h2 id="用视图重新格式化检索出的数据"><a href="#用视图重新格式化检索出的数据" class="headerlink" title="用视图重新格式化检索出的数据"></a>用视图重新格式化检索出的数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RTRIM(vend_name) <span class="operator">+</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">+</span> RTRIM(vend_country) <span class="operator">+</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
<p><img src="/images/view2.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 视图格式化</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> VendorLocations <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> RTRIM(vend_name) <span class="operator">+</span> <span class="string">&#x27; (&#x27;</span> <span class="operator">+</span> RTRIM(vend_country) <span class="operator">+</span> <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> Vendors;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检索数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> VendorLocations;</span><br></pre></td></tr></table></figure>
<h2 id="用视图过滤不想要的数据"><a href="#用视图过滤不想要的数据" class="headerlink" title="用视图过滤不想要的数据"></a>用视图过滤不想要的数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> CustomerEMailList <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_id, cust_name, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_email <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> CustomerEMailList;</span><br></pre></td></tr></table></figure>
<p><img src="/images/view3.png"></p>
<h2 id="使用视图与计算字段"><a href="#使用视图与计算字段" class="headerlink" title="使用视图与计算字段"></a>使用视图与计算字段</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> OrderItemsExpanded <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> order_num,</span><br><span class="line">       prod_id,</span><br><span class="line">       quantity,</span><br><span class="line">       item_price,</span><br><span class="line">       quantity<span class="operator">*</span>item_price <span class="keyword">AS</span> expanded_price</span><br><span class="line"><span class="keyword">FROM</span> OrderItems</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> OrderItemsExpanded</span><br><span class="line"><span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">20008</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/view4.png"></p>
<h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><p>存储过程就是为以后使用而保存的一条或多条 SQL 语句。可将其视为批文件。通常以编译过的形式存储，所以 DBMS 处理命令所需的工作量少，提高了性能。</p>
<blockquote>
<p>SQLite 不支持存储过程。</p>
</blockquote>
<h2 id="执行存储过程"><a href="#执行存储过程" class="headerlink" title="执行存储过程"></a>执行存储过程</h2><p>EXECUTE 接受存储过程名和需要传递给它的任何参数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> AddNewProduct(<span class="string">&#x27;JTS01&#x27;</span>, <span class="comment">-- 供应商 ID（Vendors 表的主键）</span></span><br><span class="line">                      <span class="string">&#x27;Stuffed Eiffel Tower&#x27;</span>, <span class="comment">-- 产品名</span></span><br><span class="line">                      <span class="number">6.49</span>, <span class="comment">-- 价格</span></span><br><span class="line">                      <span class="string">&#x27;Description&#x27;</span>); <span class="comment">-- 描述</span></span><br></pre></td></tr></table></figure>
<p>这 4 个参数匹配存储过程中 4 个预期变量（定义为存储过程自身的组成部分）。此存储过程将新行添加到 Products 表，并将传入的属性赋给相应的列。<br>另一个需要值的 prod_id 列是这个表的主键，最好是使生成此 ID 的过程自动化（而不是依赖于最终用户的输入）。</p>
<ul>
<li><p>存储过程所完成的工作：<br>验证传递的数据，保证所有参数都有值；<br>生成用作主键的唯一 ID；<br>将新产品插入表，在合适的列中存储生成的主键和传递的数据。</p>
</li>
<li><p>具体可选项：<br>参数可选，具有不提供参数时的默认值。<br>不按次序给出参数，以「参数=值」方式给出参数值。<br>输出参数，允许存储过程在正执行的应用程序中更新所用的参数。<br>用 SELECT 语句检索数据。<br>返回代码，允许存储过程返回一个值到正在执行的应用程序。</p>
</li>
</ul>
<h2 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Oracle 版本，对邮件发送清单中具有邮件地址的顾客进行计数。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> MailingListCount (</span><br><span class="line">    ListCount <span class="keyword">OUT</span> <span class="type">INTEGER</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">v_rows <span class="type">INTEGER</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> v_rows</span><br><span class="line">    <span class="keyword">FROM</span> Customers</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="keyword">NOT</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line">    ListCount :<span class="operator">=</span> v_rows;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ListCount 参数从存储过程返回一个值。关键字 OUT 用来指示这种行为。</span></span><br><span class="line"><span class="comment">Oracle 支持 IN（传递值给存储过程）、OUT（从存储过程返回值）、INOUT（既传递又返回值）类型的参数。</span></span><br><span class="line"><span class="comment">存储过程的代码括在 BEGIN 和 END 语句中，用检索出的行数设置 ListCount（要传递的输出参数）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL Server 版本</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> MailingListCount</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@cnt</span> <span class="type">INTEGER</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@cnt</span> <span class="operator">=</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">RETURN</span> <span class="variable">@cnt</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">此存储过程没有参数。调用程序检索 SQL Server 返回代码提供的值。</span></span><br><span class="line"><span class="comment">用 DECLARE 语句声明了一个局部变量（SQL Server 中所有局部变量名都以@ 起头）；在 SELECT 语句中让它包含 COUNT() 函数返回的值；最后用 RETURN @cnt 语句将计数返回给调用程序。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 调用 Oracle 版本</span></span><br><span class="line">var ReturnValue NUMBER</span><br><span class="line"><span class="keyword">EXEC</span> MailingListCount(:ReturnValue);</span><br><span class="line"><span class="keyword">SELECT</span> ReturnValue;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用 SQL Server 版本</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@ReturnValue</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="variable">@ReturnValue</span><span class="operator">=</span>MailingListCount;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@ReturnValue</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> NewOrder <span class="variable">@cust</span>_id <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="comment">-- 插入新订单</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="variable">@cust</span>_id)</span><br><span class="line"><span class="comment">-- 返回订单号</span></span><br><span class="line"><span class="keyword">SELECT</span> order_num <span class="operator">=</span> @<span class="variable">@IDENTITY</span>;</span><br></pre></td></tr></table></figure>
<p>SQL Server 中称这些自动增量的列为标识字段（identity field）<br>其他 DBMS 称之为自动编号（auto number）或序列（sequence）<br>DBMS 对日期使用默认值（GETDATE() 函数），订单号自动生成。<br>在 SQL Server 上可在全局变量 @@IDENTITY 中得到，它返回到调用程序（这里的 SELECT）。</p>
<h1 id="事务处理"><a href="#事务处理" class="headerlink" title="事务处理"></a>事务处理</h1><p>使用事务处理（transaction processing），通过确保成批的 SQL 操作完全执行或完全不执行，来维护数据库完整性。</p>
<p>事务（transaction）一组 SQL 语句；<br>回退（rollback）撤销指定 SQL 语句的过程；<br>提交（commit）将未存储的 SQL 语句结果写入数据库表；<br>保留点（savepoint）事务处理中设置的临时占位符（placeholder），可以对它发布回退（与回退整个事务处理不同）。</p>
<p>事务处理用来管理 INSERT、UPDATE 和 DELETE 语句。不能回退 SELECT 语句，也没必要，也不能回退 CREATE 或 DROP 操作。进行回退时，这些操作也不撤销。</p>
<h2 id="控制事务处理"><a href="#控制事务处理" class="headerlink" title="控制事务处理"></a>控制事务处理</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line"><span class="keyword">BEGIN</span> TRANSACTION <span class="comment">-- 明确事务处理块的开始和结束</span></span><br><span class="line">... <span class="comment">-- 实际代码</span></span><br><span class="line"><span class="keyword">COMMIT</span> TRANSACTION</span><br><span class="line"></span><br><span class="line"><span class="comment">-- MariaDB 和 MySQL</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Oracle</span></span><br><span class="line"><span class="keyword">SET</span> TRANSACTION</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">-- PostgreSQL 使用 ANSI SQL 语法</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="ROLLBACK"><a href="#ROLLBACK" class="headerlink" title="ROLLBACK"></a>ROLLBACK</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Orders;</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>
<h2 id="COMMIT"><a href="#COMMIT" class="headerlink" title="COMMIT"></a>COMMIT</h2><p>一般 SQL 语句都是针对数据库表直接执行和编写的，即隐式提交（implicit commit），提交（写或保存）操作是自动进行的。<br>在事务处理块中，提交不会隐式进行。有的 DBMS 按隐式提交处理事务端。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line"><span class="keyword">BEGIN</span> TRANSACTION <span class="comment">-- 利用事务保证完全删除订单</span></span><br><span class="line"><span class="keyword">DELETE</span> OrderItems <span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">12345</span></span><br><span class="line"><span class="keyword">DELETE</span> Orders <span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">12345</span></span><br><span class="line"><span class="keyword">COMMIT</span> TRANSACTION</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Oracle</span></span><br><span class="line"><span class="keyword">SET</span> TRANSACTION</span><br><span class="line"><span class="keyword">DELETE</span> OrderItems <span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">12345</span>;</span><br><span class="line"><span class="keyword">DELETE</span> Orders <span class="keyword">WHERE</span> order_num <span class="operator">=</span> <span class="number">12345</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
<h2 id="保留点"><a href="#保留点" class="headerlink" title="保留点"></a>保留点</h2><p>每个保留点都要取能够标识它的唯一名字。保留点越多越好。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MariaDB、MySQL 和 Oracle</span></span><br><span class="line"><span class="keyword">SAVEPOINT</span> delete1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> delete1; <span class="comment">-- 回退</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line">SAVE TRANSACTION delete1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ROLLBACK</span> TRANSACTION delete1; <span class="comment">-- 回退</span></span><br></pre></td></tr></table></figure>
<h1 id="游标-cursor"><a href="#游标-cursor" class="headerlink" title="游标 cursor"></a>游标 cursor</h1><p>游标是一个存储在 DBMS 服务器上的数据库查询，它不是一条 SELECT 语句，而是被该语句检索出来的结果集。在存储了游标之后，应用程序可以根据需要滚动或浏览其中的数据。</p>
<blockquote>
<p>SQLite 支持的游标称为步骤（step）</p>
</blockquote>
<h2 id="常见特性"><a href="#常见特性" class="headerlink" title="常见特性"></a>常见特性</h2><p>能标记游标为只读；<br>能控制可以执行的定向操作（向前、向后、第一、最后、绝对位置和相对位置等）；<br>能标记某些列为可编辑的，某些不可编辑；<br>规定范围，使游标对创建它的特定请求（如存储过程）或对所有请求可访问；<br>指示 DBMS 对检索出的数据进行复制，使数据在游标打开和访问期间不变化。</p>
<h2 id="使用游标"><a href="#使用游标" class="headerlink" title="使用游标"></a>使用游标</h2><p>使用游标前，必须声明。这个过程实际上没有检索数据，只是定义要使用的 SELECT 语句和游标选项；<br>一旦声明，就必须打开游标以供使用。这个过程用前面定义的 SELECT 语句把数据实际检索出来；<br>对于填有数据的游标，根据需要检索各行；<br>结束游标使用时，必须关闭游标，可能的话，释放游标（有赖于具体 DBMS）。</p>
<h2 id="创建游标-DECLARE"><a href="#创建游标-DECLARE" class="headerlink" title="创建游标 DECLARE"></a>创建游标 DECLARE</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DB2、MariaDB、MySQL 和 SQL Server</span></span><br><span class="line"><span class="keyword">DECLARE</span> CustCursor <span class="keyword">CURSOR</span></span><br><span class="line"><span class="keyword">FOR</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Oracle 和 PostgreSQL</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">CURSOR</span> CustCursor</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>
<h2 id="使用游标-OPEN-CURSOR"><a href="#使用游标-OPEN-CURSOR" class="headerlink" title="使用游标 OPEN CURSOR"></a>使用游标 OPEN CURSOR</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">OPEN</span> <span class="keyword">CURSOR</span> CustCursor</span><br></pre></td></tr></table></figure>
<p>FETCH 指出要检索哪些行，从何处检索它们以及将它们放于何处（如变量名）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Oracle</span></span><br><span class="line"><span class="keyword">DECLARE</span> TYPE CustCursor <span class="keyword">IS</span> <span class="keyword">REF</span> <span class="keyword">CURSOR</span></span><br><span class="line">    <span class="keyword">RETURN</span> Customers<span class="operator">%</span>ROWTYPE;</span><br><span class="line"><span class="keyword">DECLARE</span> CustRecord Customers<span class="operator">%</span>ROWTYPE</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">OPEN</span> CustCursor;</span><br><span class="line">    LOOP</span><br><span class="line">    <span class="keyword">FETCH</span> CustCursor <span class="keyword">INTO</span> CustRecord; <span class="comment">-- 自动从第一行开始检索</span></span><br><span class="line">    EXIT <span class="keyword">WHEN</span> CustCursor<span class="operator">%</span>NOTFOUND; <span class="comment">-- 取不出行时退出循环</span></span><br><span class="line">        ... <span class="comment">-- 具体处理代码</span></span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">    <span class="keyword">CLOSE</span> CustCursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>
<h2 id="关闭游标-CLOSE"><a href="#关闭游标-CLOSE" class="headerlink" title="关闭游标 CLOSE"></a>关闭游标 CLOSE</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DB2、 Oracle 和 PostgreSQL</span></span><br><span class="line"><span class="keyword">CLOSE</span> CustCursor</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line"><span class="keyword">CLOSE</span> CustCursor</span><br><span class="line"><span class="keyword">DEALLOCATE</span> <span class="keyword">CURSOR</span> CustCursor</span><br></pre></td></tr></table></figure>
<h1 id="高级-SQL-特性"><a href="#高级-SQL-特性" class="headerlink" title="高级 SQL 特性"></a>高级 SQL 特性</h1><h2 id="约束-constraint"><a href="#约束-constraint" class="headerlink" title="约束 constraint"></a>约束 constraint</h2><p>约束：管理如何插入或处理数据库数据的规则。<br>大多数约束是在表定义中定义的。</p>
<h3 id="主键"><a href="#主键" class="headerlink" title="主键"></a>主键</h3><p>主键是一种特殊的约束，用来保证一列（或一组列）中的值是唯一的，而且永不改动。</p>
<p>表中任意列只要满足以下条件，都可用于主键。<br>任意两行的主键值都不相同。<br>每行都具有一个主键值（即列中不允许 NULL 值）。<br>包含主键值的列从不修改或更新。（大多数 DBMS 不允许这么做）<br>主键值不能重用。如果从表中删除某一行，其主键值不分配给新行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line">(</span><br><span class="line">    vend_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- 通过创建定义主键</span></span><br><span class="line">    vend_name <span class="type">CHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    vend_address <span class="type">CHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    vend_city <span class="type">CHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    vend_state <span class="type">CHAR</span>(<span class="number">5</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    vend_zip <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    vend_country <span class="type">CHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 另一种定义主键</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="keyword">PRIMARY</span> KEY (vend_id);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>SQLite 不允许使用 ALTER TABLE 定义键，要求在初始的 CREATE TABLE 语句中定义它们。</p>
</blockquote>
<h3 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h3><p>外键是表中的一列，其值必须列在另一表的主键中。</p>
<p>REFERENCES 关键字，表示 cust_id 中的任何值都必须是 Customers 表的 cust_id 中的值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">    order_num <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    order_date DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    cust_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">REFERENCES</span> Customers(cust_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 相同工作</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span></span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (cust_id) <span class="keyword">REFERENCES</span> Customers (cust_id);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>有的 DBMS 支持级联删除（cascading delete）特性。如果启用，该特性在从一个表中删除行时删除所有相关的数据。如，从 Customers 表中删除某个顾客，则任何关联的订单行也会被自动删除。</p>
</blockquote>
<h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p>唯一约束用来保证一列（或一组列）中的数据是唯一的。类似于主键，但存在以下重要区别：</p>
<ul>
<li>表可包含多个唯一约束，但每个表只允许一个主键。</li>
<li>唯一约束列可包含 NULL 值。</li>
<li>唯一约束列可修改或更新。</li>
<li>唯一约束列的值可重复使用。</li>
<li>与主键不一样，唯一约束不能用来定义外键。</li>
</ul>
<p>唯一约束既可以用 UNIQUE 关键字在表定义中定义，也可以用单独的 CONSTRAINT 定义。</p>
<h3 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h3><p>检查约束用来保证一列（或一组列）中的数据满足一组指定的条件。</p>
<p>常见用途：</p>
<ul>
<li>检查最小或最大值。如，防止 0 个物品的订单。</li>
<li>指定范围。</li>
<li>只允许特定的值。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> OrderItems</span><br><span class="line">(</span><br><span class="line">    order_num <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    order_item <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    prod_id <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    quantity <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line">    item_price MONEY <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查 gender 列只包含 M 或 F</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="keyword">CHECK</span> (gender <span class="keyword">LIKE</span> <span class="string">&#x27;[MF]&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="索引-CREATE-INDEX"><a href="#索引-CREATE-INDEX" class="headerlink" title="索引 CREATE INDEX"></a>索引 CREATE INDEX</h2><p>索引用来排序数据以加快搜索和排序操作的速度。</p>
<p>开始创建索引前：</p>
<ul>
<li>索引改善检索操作的性能，但降低了数据插入、修改和删除的性能。在执行这些操作时，DBMS 必须动态地更新索引。</li>
<li>索引数据可能要占用大量的存储空间。</li>
<li>并非所有数据都适合做索引。</li>
<li>索引用于数据过滤和排序。</li>
<li>可在索引中定义多个列（如州加上城市）。这样的索引仅在以州加城市的顺序排序时有用。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 不同 DBMS 创建索引的语句变化很大</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX prod_name_ind <span class="comment">-- 索引必须唯一命名</span></span><br><span class="line"><span class="keyword">ON</span> Products (prod_name);</span><br></pre></td></tr></table></figure>
<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>触发器是特殊的存储过程，它在特定的数据库活动发生时自动执行。<br>触发器可与特定表上的 INSERT、UPDATE 和 DELETE 操作相关联。</p>
<p>与存储过程不一样，触发器与单个的表相关联。与 Orders 表上的 INSERT 操作相关联的触发器只在 Orders 表中插入行时执行。</p>
<p>触发器内的代码具有以下数据的访问权：</p>
<ul>
<li>INSERT 操作中的所有新数据；</li>
<li>UPDATE 操作中的所有新旧数据；</li>
<li>DELETE 操作中删除的数据。</li>
</ul>
<p>常见用途：</p>
<ul>
<li>保证数据一致。如，在 INSERT 操作中将所有州名转换为大写。</li>
<li>基于某个表的变动在其他表上执行活动。如，每当更新或删除一行时将审计跟踪记录写入某个日志表。</li>
<li>进行额外的验证并根据需要回退数据。如，保证某个顾客的可用资金不超限定，如果已经超出，则阻塞插入。</li>
<li>计算计算列的值或更新时间戳。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL Server</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> customer_state</span><br><span class="line"><span class="keyword">ON</span> Customers</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">INSERT</span>, UPDATE</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">UPDATE Customers</span><br><span class="line"><span class="keyword">SET</span> cust_state <span class="operator">=</span> <span class="built_in">Upper</span>(cust_state)</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id <span class="operator">=</span> inserted.cust_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Oracle 和 PostgreSQL</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> customer_state</span><br><span class="line">AFTER <span class="keyword">INSERT</span> <span class="keyword">OR</span> UPDATE</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">UPDATE Customers</span><br><span class="line"><span class="keyword">SET</span> cust_state <span class="operator">=</span> <span class="built_in">Upper</span>(cust_state)</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id <span class="operator">=</span> :OLD.cust_id</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般来说，约束处理比触发器快，因此应该尽量使用约束。</p>
</blockquote>
<h2 id="数据库安全"><a href="#数据库安全" class="headerlink" title="数据库安全"></a>数据库安全</h2><p>一般说来，需要保护的操作：</p>
<ul>
<li>对数据库管理功能（创建表、更改或删除已存在的表等）的访问；</li>
<li>对特定数据库或表的访问；</li>
<li>访问的类型（只读、对特定列的访问等）；</li>
<li>仅通过视图或存储过程对表进行访问；</li>
<li>创建多层次的安全措施，从而允许多种基于登录的访问和控制；</li>
<li>限制管理用户账号的能力。</li>
</ul>
<p>安全性使用 SQL 的 GRANT 和 REVOKE 语句来管理，不过大多数 DBMS 提供了交互式的管理实用程序，在内部使用 GRANT 和 REVOKE。</p>
<h1 id="样例表脚本"><a href="#样例表脚本" class="headerlink" title="样例表脚本"></a>样例表脚本</h1><h2 id="Vendors-表"><a href="#Vendors-表" class="headerlink" title="Vendors 表"></a>Vendors 表</h2><p>列 说 明<br>vend_id（主键） 唯一的供应商ID<br>vend_name 供应商名<br>vend_address 供应商的地址<br>vend_city 供应商所在城市<br>vend_state 供应商所在州<br>vend_zip 供应商地址邮政编码<br>vend_country 供应商所在国家</p>
<h2 id="Products-表"><a href="#Products-表" class="headerlink" title="Products 表"></a>Products 表</h2><p>列 说 明<br>prod_id（主键） 唯一的产品ID<br>vend_id 产品供应商ID（关联到Vendors表的vend_id）<br>prod_name 产品名<br>prod_price 产品价格<br>prod_desc 产品描述</p>
<blockquote>
<p>为实施引用完整性，在 vend_id 上定义一个外键，关联到 Vendors 的 vend_id 列。</p>
</blockquote>
<h2 id="Customers-表"><a href="#Customers-表" class="headerlink" title="Customers 表"></a>Customers 表</h2><p>列 说 明<br>cust_id（主键） 唯一的顾客ID<br>cust_name 顾客名<br>cust_address 顾客的地址<br>cust_city 顾客所在城市<br>cust_state 顾客所在州<br>cust_zip 顾客地址邮政编码<br>cust_country 顾客所在国家<br>cust_contact 顾客的联系名<br>cust_email 顾客的电子邮件地址</p>
<h2 id="Orders-表"><a href="#Orders-表" class="headerlink" title="Orders 表"></a>Orders 表</h2><p>列 说 明<br>order_num 唯一的订单号<br>order_date 订单日期<br>cust_id 订单顾客ID（关联到Customers表的cust_id）</p>
<blockquote>
<p>cust_id 上定义外键，关联到 Customers 的 cust_id 列。</p>
</blockquote>
<h2 id="OrderItems-表"><a href="#OrderItems-表" class="headerlink" title="OrderItems 表"></a>OrderItems 表</h2><p>列 说 明<br>order_num（主键） 订单号（关联到Orders表的order_num）<br>order_item（主键） 订单物品号（订单内的顺序）<br>prod_id 产品ID（关联到Products表的prod_id）<br>quantity 物品数量<br>item_price 物品价格</p>
<blockquote>
<p>关联 order_num 到 Orders 的 order_num 列；<br>关联 prod_id 到 Products的 prod_id 列。</p>
</blockquote>
<p><img src="/images/five_tables.bmp"></p>
<p>create.txt 包含创建 5 个数据库表（包括定义所有主键和外键约束）的 SQL 语句。<br>populate.txt 包含用来填充这些表的 SQL INSERT 语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Example table creation scripts for MySQL &amp; MariaDB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create Customers table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Customers</span><br><span class="line">(</span><br><span class="line">  cust_id      <span class="type">char</span>(<span class="number">10</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_name    <span class="type">char</span>(<span class="number">50</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_address <span class="type">char</span>(<span class="number">50</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_city    <span class="type">char</span>(<span class="number">50</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_state   <span class="type">char</span>(<span class="number">5</span>)   <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_zip     <span class="type">char</span>(<span class="number">10</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_country <span class="type">char</span>(<span class="number">50</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_contact <span class="type">char</span>(<span class="number">50</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_email   <span class="type">char</span>(<span class="number">255</span>) <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create OrderItems table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> OrderItems</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="type">int</span>          <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  order_item <span class="type">int</span>          <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  prod_id    <span class="type">char</span>(<span class="number">10</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  quantity   <span class="type">int</span>          <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  item_price <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create Orders table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="type">int</span>      <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  order_date datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  cust_id    <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create Products table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Products</span><br><span class="line">(</span><br><span class="line">  prod_id    <span class="type">char</span>(<span class="number">10</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_id    <span class="type">char</span>(<span class="number">10</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  prod_name  <span class="type">char</span>(<span class="number">255</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  prod_price <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  prod_desc  text          <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create Vendors table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line">(</span><br><span class="line">  vend_id      <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_name    <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_address <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_city    <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_state   <span class="type">char</span>(<span class="number">5</span>)  <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_zip     <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NULL</span> ,</span><br><span class="line">  vend_country <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Define primary keys</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Customers <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (cust_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> OrderItems <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (order_num, order_item);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (order_num);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Products <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (prod_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Vendors <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (vend_id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Define foreign keys</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> OrderItems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_OrderItems_Orders <span class="keyword">FOREIGN</span> KEY (order_num) <span class="keyword">REFERENCES</span> Orders (order_num);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> OrderItems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_OrderItems_Products <span class="keyword">FOREIGN</span> KEY (prod_id) <span class="keyword">REFERENCES</span> Products (prod_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_Orders_Customers <span class="keyword">FOREIGN</span> KEY (cust_id) <span class="keyword">REFERENCES</span> Customers (cust_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Products <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_Products_Vendors <span class="keyword">FOREIGN</span> KEY (vend_id) <span class="keyword">REFERENCES</span> Vendors (vend_id);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Example table population scripts for MySQL &amp; MariaDB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Populate Customers table</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1000000001&#x27;</span>, <span class="string">&#x27;Village Toys&#x27;</span>, <span class="string">&#x27;200 Maple Lane&#x27;</span>, <span class="string">&#x27;Detroit&#x27;</span>, <span class="string">&#x27;MI&#x27;</span>, <span class="string">&#x27;44444&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;sales@villagetoys.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1000000002&#x27;</span>, <span class="string">&#x27;Kids Place&#x27;</span>, <span class="string">&#x27;333 South Lake Drive&#x27;</span>, <span class="string">&#x27;Columbus&#x27;</span>, <span class="string">&#x27;OH&#x27;</span>, <span class="string">&#x27;43333&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>, <span class="string">&#x27;Michelle Green&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1000000003&#x27;</span>, <span class="string">&#x27;Fun4All&#x27;</span>, <span class="string">&#x27;1 Sunny Place&#x27;</span>, <span class="string">&#x27;Muncie&#x27;</span>, <span class="string">&#x27;IN&#x27;</span>, <span class="string">&#x27;42222&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>, <span class="string">&#x27;Jim Jones&#x27;</span>, <span class="string">&#x27;jjones@fun4all.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1000000004&#x27;</span>, <span class="string">&#x27;Fun4All&#x27;</span>, <span class="string">&#x27;829 Riverside Drive&#x27;</span>, <span class="string">&#x27;Phoenix&#x27;</span>, <span class="string">&#x27;AZ&#x27;</span>, <span class="string">&#x27;88888&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>, <span class="string">&#x27;Denise L. Stephens&#x27;</span>, <span class="string">&#x27;dstephens@fun4all.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1000000005&#x27;</span>, <span class="string">&#x27;The Toy Store&#x27;</span>, <span class="string">&#x27;4545 53rd Street&#x27;</span>, <span class="string">&#x27;Chicago&#x27;</span>, <span class="string">&#x27;IL&#x27;</span>, <span class="string">&#x27;54545&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>, <span class="string">&#x27;Kim Howard&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Populate Vendors table</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BRS01&#x27;</span>,<span class="string">&#x27;Bears R Us&#x27;</span>,<span class="string">&#x27;123 Main Street&#x27;</span>,<span class="string">&#x27;Bear Town&#x27;</span>,<span class="string">&#x27;MI&#x27;</span>,<span class="string">&#x27;44444&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BRE02&#x27;</span>,<span class="string">&#x27;Bear Emporium&#x27;</span>,<span class="string">&#x27;500 Park Street&#x27;</span>,<span class="string">&#x27;Anytown&#x27;</span>,<span class="string">&#x27;OH&#x27;</span>,<span class="string">&#x27;44333&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;DLL01&#x27;</span>,<span class="string">&#x27;Doll House Inc.&#x27;</span>,<span class="string">&#x27;555 High Street&#x27;</span>,<span class="string">&#x27;Dollsville&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>,<span class="string">&#x27;99999&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;FRB01&#x27;</span>,<span class="string">&#x27;Furball Inc.&#x27;</span>,<span class="string">&#x27;1000 5th Avenue&#x27;</span>,<span class="string">&#x27;New York&#x27;</span>,<span class="string">&#x27;NY&#x27;</span>,<span class="string">&#x27;11111&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;FNG01&#x27;</span>,<span class="string">&#x27;Fun and Games&#x27;</span>,<span class="string">&#x27;42 Galaxy Road&#x27;</span>,<span class="string">&#x27;London&#x27;</span>, <span class="keyword">NULL</span>,<span class="string">&#x27;N16 6PS&#x27;</span>, <span class="string">&#x27;England&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Vendors(vend_id, vend_name, vend_address, vend_city, vend_state, vend_zip, vend_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;JTS01&#x27;</span>,<span class="string">&#x27;Jouets et ours&#x27;</span>,<span class="string">&#x27;1 Rue Amusement&#x27;</span>,<span class="string">&#x27;Paris&#x27;</span>, <span class="keyword">NULL</span>,<span class="string">&#x27;45678&#x27;</span>, <span class="string">&#x27;France&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Populate Products table</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BR01&#x27;</span>, <span class="string">&#x27;BRS01&#x27;</span>, <span class="string">&#x27;8 inch teddy bear&#x27;</span>, <span class="number">5.99</span>, <span class="string">&#x27;8 inch teddy bear, comes with cap and jacket&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BR02&#x27;</span>, <span class="string">&#x27;BRS01&#x27;</span>, <span class="string">&#x27;12 inch teddy bear&#x27;</span>, <span class="number">8.99</span>, <span class="string">&#x27;12 inch teddy bear, comes with cap and jacket&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BR03&#x27;</span>, <span class="string">&#x27;BRS01&#x27;</span>, <span class="string">&#x27;18 inch teddy bear&#x27;</span>, <span class="number">11.99</span>, <span class="string">&#x27;18 inch teddy bear, comes with cap and jacket&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BNBG01&#x27;</span>, <span class="string">&#x27;DLL01&#x27;</span>, <span class="string">&#x27;Fish bean bag toy&#x27;</span>, <span class="number">3.49</span>, <span class="string">&#x27;Fish bean bag toy, complete with bean bag worms with which to feed it&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BNBG02&#x27;</span>, <span class="string">&#x27;DLL01&#x27;</span>, <span class="string">&#x27;Bird bean bag toy&#x27;</span>, <span class="number">3.49</span>, <span class="string">&#x27;Bird bean bag toy, eggs are not included&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;BNBG03&#x27;</span>, <span class="string">&#x27;DLL01&#x27;</span>, <span class="string">&#x27;Rabbit bean bag toy&#x27;</span>, <span class="number">3.49</span>, <span class="string">&#x27;Rabbit bean bag toy, comes with bean bag carrots&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;RGAN01&#x27;</span>, <span class="string">&#x27;DLL01&#x27;</span>, <span class="string">&#x27;Raggedy Ann&#x27;</span>, <span class="number">4.99</span>, <span class="string">&#x27;18 inch Raggedy Ann doll&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;RYL01&#x27;</span>, <span class="string">&#x27;FNG01&#x27;</span>, <span class="string">&#x27;King doll&#x27;</span>, <span class="number">9.49</span>, <span class="string">&#x27;12 inch king doll with royal garments and crown&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Products(prod_id, vend_id, prod_name, prod_price, prod_desc)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;RYL02&#x27;</span>, <span class="string">&#x27;FNG01&#x27;</span>, <span class="string">&#x27;Queen doll&#x27;</span>, <span class="number">9.49</span>, <span class="string">&#x27;12 inch queen doll with royal garments and crown&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Populate Orders table</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20005</span>, <span class="string">&#x27;2020-05-01&#x27;</span>, <span class="string">&#x27;1000000001&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20006</span>, <span class="string">&#x27;2020-01-12&#x27;</span>, <span class="string">&#x27;1000000003&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="string">&#x27;2020-01-30&#x27;</span>, <span class="string">&#x27;1000000004&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="string">&#x27;2020-02-03&#x27;</span>, <span class="string">&#x27;1000000005&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20009</span>, <span class="string">&#x27;2020-02-08&#x27;</span>, <span class="string">&#x27;1000000001&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Populate OrderItems table</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20005</span>, <span class="number">1</span>, <span class="string">&#x27;BR01&#x27;</span>, <span class="number">100</span>, <span class="number">5.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20005</span>, <span class="number">2</span>, <span class="string">&#x27;BR03&#x27;</span>, <span class="number">100</span>, <span class="number">10.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20006</span>, <span class="number">1</span>, <span class="string">&#x27;BR01&#x27;</span>, <span class="number">20</span>, <span class="number">5.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20006</span>, <span class="number">2</span>, <span class="string">&#x27;BR02&#x27;</span>, <span class="number">10</span>, <span class="number">8.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20006</span>, <span class="number">3</span>, <span class="string">&#x27;BR03&#x27;</span>, <span class="number">10</span>, <span class="number">11.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="number">1</span>, <span class="string">&#x27;BR03&#x27;</span>, <span class="number">50</span>, <span class="number">11.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="number">2</span>, <span class="string">&#x27;BNBG01&#x27;</span>, <span class="number">100</span>, <span class="number">2.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="number">3</span>, <span class="string">&#x27;BNBG02&#x27;</span>, <span class="number">100</span>, <span class="number">2.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="number">4</span>, <span class="string">&#x27;BNBG03&#x27;</span>, <span class="number">100</span>, <span class="number">2.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20007</span>, <span class="number">5</span>, <span class="string">&#x27;RGAN01&#x27;</span>, <span class="number">50</span>, <span class="number">4.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="number">1</span>, <span class="string">&#x27;RGAN01&#x27;</span>, <span class="number">5</span>, <span class="number">4.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="number">2</span>, <span class="string">&#x27;BR03&#x27;</span>, <span class="number">5</span>, <span class="number">11.99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="number">3</span>, <span class="string">&#x27;BNBG01&#x27;</span>, <span class="number">10</span>, <span class="number">3.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="number">4</span>, <span class="string">&#x27;BNBG02&#x27;</span>, <span class="number">10</span>, <span class="number">3.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20008</span>, <span class="number">5</span>, <span class="string">&#x27;BNBG03&#x27;</span>, <span class="number">10</span>, <span class="number">3.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20009</span>, <span class="number">1</span>, <span class="string">&#x27;BNBG01&#x27;</span>, <span class="number">250</span>, <span class="number">2.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20009</span>, <span class="number">2</span>, <span class="string">&#x27;BNBG02&#x27;</span>, <span class="number">250</span>, <span class="number">2.49</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20009</span>, <span class="number">3</span>, <span class="string">&#x27;BNBG03&#x27;</span>, <span class="number">250</span>, <span class="number">2.49</span>);</span><br></pre></td></tr></table></figure>
<h1 id="SQL-语句语法"><a href="#SQL-语句语法" class="headerlink" title="SQL 语句语法"></a>SQL 语句语法</h1><h2 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h2><p>| 符号指出多选择之一；<br>[] 包含关键字或子句是可选的。</p>
<h2 id="ALTER-TABLE"><a href="#ALTER-TABLE" class="headerlink" title="ALTER TABLE"></a>ALTER TABLE</h2><p>更新已存在表结构。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">ADD</span><span class="operator">|</span><span class="keyword">DROP</span>    <span class="keyword">column</span>    datatype    [<span class="keyword">NULL</span><span class="operator">|</span><span class="keyword">NOT</span> <span class="keyword">NULL</span>]    [CONSTRAINTS],</span><br><span class="line">    <span class="keyword">ADD</span><span class="operator">|</span><span class="keyword">DROP</span>    <span class="keyword">column</span>    datatype    [<span class="keyword">NULL</span><span class="operator">|</span><span class="keyword">NOT</span> <span class="keyword">NULL</span>]    [CONSTRAINTS],</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="COMMIT-1"><a href="#COMMIT-1" class="headerlink" title="COMMIT"></a>COMMIT</h2><p>将事务写入数据库。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COMMIT</span> [TRANSACTION]</span><br></pre></td></tr></table></figure>
<h2 id="CREATE-INDEX"><a href="#CREATE-INDEX" class="headerlink" title="CREATE INDEX"></a>CREATE INDEX</h2><p>再一个或多个列上创建索引。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX indexname</span><br><span class="line"><span class="keyword">ON</span> tablename (<span class="keyword">column</span>, ...);</span><br></pre></td></tr></table></figure>
<h2 id="CREATE-PROCEDURE"><a href="#CREATE-PROCEDURE" class="headerlink" title="CREATE PROCEDURE"></a>CREATE PROCEDURE</h2><p>创建存储过程。Oracle 语法不同。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> procedurename [parameters] [options]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SQL</span> statement;</span><br></pre></td></tr></table></figure>
<h2 id="CREATE-TABLE"><a href="#CREATE-TABLE" class="headerlink" title="CREATE TABLE"></a>CREATE TABLE</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tablename</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">column</span>    datatype    [<span class="keyword">NULL</span><span class="operator">|</span><span class="keyword">NOT</span> <span class="keyword">NULL</span>]    [CONSTRAINTS],</span><br><span class="line">    <span class="keyword">column</span>    datatype    [<span class="keyword">NULL</span><span class="operator">|</span><span class="keyword">NOT</span> <span class="keyword">NULL</span>]    [CONSTRAINTS],</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="CREATE-VIEW"><a href="#CREATE-VIEW" class="headerlink" title="CREATE VIEW"></a>CREATE VIEW</h2><p>创建一个或多个表上的视图。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> viewname <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> columns, ...</span><br><span class="line"><span class="keyword">FROM</span> tables, ...</span><br><span class="line">[<span class="keyword">WHERE</span> ...]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> ...]</span><br><span class="line">[<span class="keyword">HAVING</span> ...];</span><br></pre></td></tr></table></figure>
<h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><p>从表中删除一行或多行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tablename</span><br><span class="line">[<span class="keyword">WHERE</span> ...];</span><br></pre></td></tr></table></figure>
<h2 id="DROP"><a href="#DROP" class="headerlink" title="DROP"></a>DROP</h2><p>永久删除数据库对象（表、视图、索引等）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX<span class="operator">|</span><span class="keyword">PROCEDURE</span><span class="operator">|</span><span class="keyword">TABLE</span><span class="operator">|</span><span class="keyword">VIEW</span> indexname<span class="operator">|</span><span class="keyword">procedure</span><span class="operator">|</span>tablename<span class="operator">|</span>viewname;</span><br></pre></td></tr></table></figure>
<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><p>为表添加一行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tablename [(columns, ...)]</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="keyword">values</span>, ...);</span><br></pre></td></tr></table></figure>
<h2 id="INSERT-SELECT"><a href="#INSERT-SELECT" class="headerlink" title="INSERT SELECT"></a>INSERT SELECT</h2><p>将 SELECT 的结果插入到一个表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tablename [(columns, ...)]</span><br><span class="line"><span class="keyword">SELECT</span> columns, ... <span class="keyword">FROM</span> tablename, ...</span><br><span class="line">[<span class="keyword">WHERE</span> ...];</span><br></pre></td></tr></table></figure>
<h2 id="ROLLBACK-1"><a href="#ROLLBACK-1" class="headerlink" title="ROLLBACK"></a>ROLLBACK</h2><p>撤销一个事务块。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLBACK</span> [<span class="keyword">TO</span> savepointname];</span><br><span class="line">或</span><br><span class="line"><span class="keyword">ROLLBACK</span> TRANSACTION;</span><br></pre></td></tr></table></figure>
<h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><p>从一个或多个表（视图）中检索数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> columnname, ...</span><br><span class="line"><span class="keyword">FROM</span> tablename, ...</span><br><span class="line">[<span class="keyword">WHERE</span> ...]</span><br><span class="line">[<span class="keyword">UNION</span> ...]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> ...]</span><br><span class="line">[<span class="keyword">HAVING</span> ...]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...];</span><br></pre></td></tr></table></figure>
<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><p>更新表中的一行或多行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE tablename</span><br><span class="line"><span class="keyword">SET</span> columnname <span class="operator">=</span> <span class="keyword">value</span>, ...</span><br><span class="line">[<span class="keyword">WHERE</span> ...];</span><br></pre></td></tr></table></figure>
<h1 id="SQL-数据类型"><a href="#SQL-数据类型" class="headerlink" title="SQL 数据类型"></a>SQL 数据类型</h1><h2 id="字符串（单引号内）"><a href="#字符串（单引号内）" class="headerlink" title="字符串（单引号内）"></a>字符串（单引号内）</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR</td>
<td>1～ 255 个字符的定长字符串。它的长度必须在创建时规定</td>
</tr>
<tr>
<td>NCHAR</td>
<td>CHAR的特殊形式，用来支持多字节或 Unicode 字符（此类型的不同实现变化很大）</td>
</tr>
<tr>
<td>NVARCHAR</td>
<td>TEXT 的特殊形式，用来支持多字节或 Unicode 字符</td>
</tr>
<tr>
<td>TEXT（也称为LONG、 MEMO 或 VARCHAR）</td>
<td>变长文本</td>
</tr>
</tbody></table>
<p>定长字符串的长度在创建表时指定，空余字符用空格填充，或根据需要补为 NULL。</p>
<h2 id="数值（不用引号）"><a href="#数值（不用引号）" class="headerlink" title="数值（不用引号）"></a>数值（不用引号）</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>BIT</td>
<td>单个二进制位值，或者为0或者为1，主要用于开/关标志</td>
</tr>
<tr>
<td>DECIMAL（或NUMERIC）</td>
<td>定点或精度可变的浮点值</td>
</tr>
<tr>
<td>FLOAT（或NUMBER）</td>
<td>浮点值</td>
</tr>
<tr>
<td>INT（或INTEGER）</td>
<td>4 字节整数值，支持 −2147483648～2147483647</td>
</tr>
<tr>
<td>REAL</td>
<td>4 字节浮点值</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2 字节整数值，支持−32768～32767</td>
</tr>
<tr>
<td>TINYINT</td>
<td>1 字节整数值，支持0～255</td>
</tr>
</tbody></table>
<h3 id="货币数据类型"><a href="#货币数据类型" class="headerlink" title="货币数据类型"></a>货币数据类型</h3><p>MONEY 或 CURRENCY，有特定取值范围的 DECIMAL 数据类型。</p>
<h2 id="日期和时间"><a href="#日期和时间" class="headerlink" title="日期和时间"></a>日期和时间</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>DATE</td>
<td>日期值</td>
</tr>
<tr>
<td>DATETIME（或TIMESTAMP）</td>
<td>日期时间值</td>
</tr>
<tr>
<td>SMALLDATETIME</td>
<td>日期时间值，精确到分（无秒或毫秒）</td>
</tr>
<tr>
<td>TIME</td>
<td>时间值</td>
</tr>
</tbody></table>
<h3 id="ODBC-日期"><a href="#ODBC-日期" class="headerlink" title="ODBC 日期"></a>ODBC 日期</h3><p>该格式对每种数据库都起作用。</p>
<p>日期 <code>&#123;d &#39;2020-12-30&#39;&#125;</code><br>时间 <code>&#123;t &#39;12:30:59&#39;&#125;</code><br>日期时间 <code>&#123;ts &#39;2020-12-30 12:30:59&#39;&#125;</code></p>
<h2 id="二进制"><a href="#二进制" class="headerlink" title="二进制"></a>二进制</h2><p>兼容性最差，最少使用，可包含任何数据。</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>BINARY</td>
<td>定长二进制数据（最大长度从255 B到8000 B，有赖于具体的实现）</td>
</tr>
<tr>
<td>LONG RAW</td>
<td>变长二进制数据，最长2 GB</td>
</tr>
<tr>
<td>RAW（某些实现为BINARY）</td>
<td>定长二进制数据，最多255 B</td>
</tr>
<tr>
<td>VARBINARY</td>
<td>变长二进制数据（最大长度一般在255 B到8000 B间变化，依赖于具体的实现）</td>
</tr>
</tbody></table>
<h1 id="SQL-关键字"><a href="#SQL-关键字" class="headerlink" title="SQL 关键字"></a>SQL 关键字</h1><details><summary>保留字</summary>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br></pre></td><td class="code"><pre><span class="line">ABORT</span><br><span class="line">ABSOLUTE</span><br><span class="line">ACTION</span><br><span class="line">ACTIVE</span><br><span class="line"><span class="keyword">ADD</span></span><br><span class="line">AFTER</span><br><span class="line"><span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">ALLOCATE</span></span><br><span class="line"><span class="keyword">ALTER</span></span><br><span class="line">ANALYZE</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line"><span class="keyword">ANY</span></span><br><span class="line"><span class="keyword">ARE</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">ASC</span></span><br><span class="line">ASCENDING</span><br><span class="line">ASSERTION</span><br><span class="line"><span class="keyword">AT</span></span><br><span class="line"><span class="keyword">AUTHORIZATION</span></span><br><span class="line">AUTO</span><br><span class="line">AUTO<span class="operator">-</span>INCREMENT</span><br><span class="line">AUTOINC</span><br><span class="line">AVG</span><br><span class="line">BACKUP</span><br><span class="line">BEFORE</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">BETWEEN</span></span><br><span class="line"><span class="type">BIGINT</span></span><br><span class="line"><span class="type">BINARY</span></span><br><span class="line">BIT</span><br><span class="line"><span class="type">BLOB</span></span><br><span class="line"><span class="type">BOOLEAN</span></span><br><span class="line"><span class="keyword">BOTH</span></span><br><span class="line">BREAK</span><br><span class="line">BROWSE</span><br><span class="line">BULK</span><br><span class="line"><span class="keyword">BY</span></span><br><span class="line">BYTES</span><br><span class="line">CACHE</span><br><span class="line"><span class="keyword">CALL</span></span><br><span class="line">CASCADE</span><br><span class="line"><span class="keyword">CASCADED</span></span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">CAST</span><br><span class="line">CATALOG</span><br><span class="line">CHANGE</span><br><span class="line"><span class="type">CHAR</span></span><br><span class="line"><span class="type">CHARACTER</span></span><br><span class="line"><span class="keyword">CHARACTER_LENGTH</span></span><br><span class="line"><span class="keyword">CHECK</span></span><br><span class="line">CHECKPOINT</span><br><span class="line"><span class="keyword">CLOSE</span></span><br><span class="line">CLUSTER</span><br><span class="line">CLUSTERED</span><br><span class="line">COALESCE</span><br><span class="line"><span class="keyword">COLLATE</span></span><br><span class="line"><span class="keyword">COLUMN</span></span><br><span class="line">COLUMNS</span><br><span class="line">COMMENT</span><br><span class="line"><span class="keyword">COMMIT</span></span><br><span class="line">COMMITTED</span><br><span class="line">COMPUTE</span><br><span class="line">COMPUTED</span><br><span class="line">CONDITIONAL</span><br><span class="line">CONFIRM</span><br><span class="line"><span class="keyword">CONNECT</span></span><br><span class="line">CONNECTION</span><br><span class="line"><span class="keyword">CONSTRAINT</span></span><br><span class="line">CONSTRAINTS</span><br><span class="line">CONTAINING</span><br><span class="line"><span class="keyword">CONTAINS</span></span><br><span class="line">CONTAINSTABLE</span><br><span class="line">CONTINUE</span><br><span class="line">CONTROLROW</span><br><span class="line"><span class="keyword">CONVERT</span></span><br><span class="line"><span class="keyword">COPY</span></span><br><span class="line">COUNT</span><br><span class="line"><span class="keyword">CREATE</span></span><br><span class="line"><span class="keyword">CROSS</span></span><br><span class="line">CSTRING</span><br><span class="line"><span class="keyword">CUBE</span></span><br><span class="line"><span class="keyword">CURRENT</span></span><br><span class="line"><span class="built_in">CURRENT_DATE</span></span><br><span class="line"><span class="built_in">CURRENT_TIME</span></span><br><span class="line"><span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line"><span class="built_in">CURRENT_USER</span></span><br><span class="line"><span class="keyword">CURSOR</span></span><br><span class="line">DATABASE</span><br><span class="line">DATABASES</span><br><span class="line"><span class="type">DATE</span></span><br><span class="line">DATETIME</span><br><span class="line"><span class="keyword">DAY</span></span><br><span class="line">DBCC</span><br><span class="line"><span class="keyword">DEALLOCATE</span></span><br><span class="line">DEBUG</span><br><span class="line"><span class="type">DEC</span></span><br><span class="line"><span class="type">DECIMAL</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"><span class="keyword">DEFAULT</span></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line">DENY</span><br><span class="line"><span class="keyword">DESC</span></span><br><span class="line">DESCENDING</span><br><span class="line"><span class="keyword">DESCRIBE</span></span><br><span class="line"><span class="keyword">DISCONNECT</span></span><br><span class="line">DISK</span><br><span class="line"><span class="keyword">DISTINCT</span></span><br><span class="line">DISTRIBUTED</span><br><span class="line">DIV</span><br><span class="line">DO</span><br><span class="line">DOMAIN</span><br><span class="line"><span class="keyword">DOUBLE</span></span><br><span class="line"><span class="keyword">DROP</span></span><br><span class="line">DUMMY</span><br><span class="line">DUMP</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">ELSEIF</span><br><span class="line">ENCLOSED</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line">ERRLVL</span><br><span class="line">ERROREXIT</span><br><span class="line"><span class="keyword">ESCAPE</span></span><br><span class="line">ESCAPED</span><br><span class="line"><span class="keyword">EXCEPT</span></span><br><span class="line">EXCEPTION</span><br><span class="line"><span class="keyword">EXEC</span></span><br><span class="line"><span class="keyword">EXECUTE</span></span><br><span class="line"><span class="keyword">EXISTS</span></span><br><span class="line">EXIT</span><br><span class="line">EXPLAIN</span><br><span class="line">EXTEND</span><br><span class="line"><span class="keyword">EXTERNAL</span></span><br><span class="line">EXTRACT</span><br><span class="line"><span class="literal">FALSE</span></span><br><span class="line"><span class="keyword">FETCH</span></span><br><span class="line">FIELD</span><br><span class="line">FIELDS</span><br><span class="line">FILE</span><br><span class="line">FILLFACTOR</span><br><span class="line"><span class="keyword">FILTER</span></span><br><span class="line"><span class="type">FLOAT</span></span><br><span class="line">FLOPPY</span><br><span class="line"><span class="keyword">FOR</span></span><br><span class="line">FORCE</span><br><span class="line"><span class="keyword">FOREIGN</span></span><br><span class="line">FOUND</span><br><span class="line">FREETEXT</span><br><span class="line">FREETEXTTABLE</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"><span class="keyword">FULL</span></span><br><span class="line"><span class="keyword">FUNCTION</span></span><br><span class="line">GENERATOR</span><br><span class="line"><span class="keyword">GET</span></span><br><span class="line"><span class="keyword">GLOBAL</span></span><br><span class="line">GO</span><br><span class="line">GOTO</span><br><span class="line"><span class="keyword">GRANT</span></span><br><span class="line"><span class="keyword">GROUP</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">HOLDLOCK</span><br><span class="line"><span class="keyword">HOUR</span></span><br><span class="line"><span class="keyword">IDENTITY</span></span><br><span class="line">IF</span><br><span class="line"><span class="keyword">IN</span></span><br><span class="line">INACTIVE</span><br><span class="line">INDEX</span><br><span class="line"><span class="keyword">INDICATOR</span></span><br><span class="line">INFILE</span><br><span class="line"><span class="keyword">INNER</span></span><br><span class="line"><span class="keyword">INOUT</span></span><br><span class="line">INPUT</span><br><span class="line"><span class="keyword">INSENSITIVE</span></span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="type">INT</span></span><br><span class="line"><span class="type">INTEGER</span></span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line"><span class="type">INTERVAL</span></span><br><span class="line"><span class="keyword">INTO</span></span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">ISOLATION</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">KEY</span><br><span class="line">KILL</span><br><span class="line"><span class="keyword">LANGUAGE</span></span><br><span class="line"><span class="keyword">LAST</span></span><br><span class="line"><span class="keyword">LEADING</span></span><br><span class="line"><span class="keyword">LEFT</span></span><br><span class="line">LENGTH</span><br><span class="line">LEVEL</span><br><span class="line"><span class="keyword">LIKE</span></span><br><span class="line">LIMIT</span><br><span class="line">LINENO</span><br><span class="line">LINES</span><br><span class="line">LISTEN</span><br><span class="line">LOAD</span><br><span class="line"><span class="keyword">LOCAL</span></span><br><span class="line">LOCK</span><br><span class="line">LOGFILE</span><br><span class="line">LONG</span><br><span class="line">LOWER</span><br><span class="line">MANUAL</span><br><span class="line"><span class="keyword">MATCH</span></span><br><span class="line">MAX</span><br><span class="line"><span class="keyword">MERGE</span></span><br><span class="line">MESSAGE</span><br><span class="line">MIN</span><br><span class="line"><span class="keyword">MINUTE</span></span><br><span class="line">MIRROREXIT</span><br><span class="line"><span class="keyword">MODULE</span></span><br><span class="line">MONEY</span><br><span class="line"><span class="keyword">MONTH</span></span><br><span class="line">MOVE</span><br><span class="line">NAMES</span><br><span class="line"><span class="type">NATIONAL</span></span><br><span class="line"><span class="keyword">NATURAL</span></span><br><span class="line"><span class="type">NCHAR</span></span><br><span class="line">NEXT</span><br><span class="line"><span class="keyword">NEW</span></span><br><span class="line"><span class="keyword">NO</span></span><br><span class="line">NOCHECK</span><br><span class="line">NONCLUSTERED</span><br><span class="line"><span class="keyword">NONE</span></span><br><span class="line"><span class="keyword">NOT</span></span><br><span class="line"><span class="keyword">NULL</span></span><br><span class="line">NULLIF</span><br><span class="line"><span class="type">NUMERIC</span></span><br><span class="line"><span class="keyword">OF</span></span><br><span class="line">OFF</span><br><span class="line"><span class="keyword">OFFSET</span></span><br><span class="line">OFFSETS</span><br><span class="line"><span class="keyword">ON</span></span><br><span class="line">ONCE</span><br><span class="line"><span class="keyword">ONLY</span></span><br><span class="line"><span class="keyword">OPEN</span></span><br><span class="line">OPTION</span><br><span class="line"><span class="keyword">OR</span></span><br><span class="line"><span class="keyword">ORDER</span></span><br><span class="line"><span class="keyword">OUTER</span></span><br><span class="line">OUTPUT</span><br><span class="line"><span class="keyword">OVER</span></span><br><span class="line">OVERFLOW</span><br><span class="line"><span class="keyword">OVERLAPS</span></span><br><span class="line">PAD</span><br><span class="line">PAGE</span><br><span class="line">PAGES</span><br><span class="line"><span class="keyword">PARAMETER</span></span><br><span class="line">PARTIAL</span><br><span class="line">PASSWORD</span><br><span class="line"><span class="keyword">PERCENT</span></span><br><span class="line">PERM</span><br><span class="line">PERMANENT</span><br><span class="line">PIPE</span><br><span class="line">PLAN</span><br><span class="line">POSITION</span><br><span class="line"><span class="keyword">PRECISION</span></span><br><span class="line"><span class="keyword">PREPARE</span></span><br><span class="line"><span class="keyword">PRIMARY</span></span><br><span class="line">PRINT</span><br><span class="line">PRIOR</span><br><span class="line">PRIVILEGES</span><br><span class="line">PROC</span><br><span class="line"><span class="keyword">PROCEDURE</span></span><br><span class="line">PROCESSEXIT</span><br><span class="line">PROTECTED</span><br><span class="line">PUBLIC</span><br><span class="line">PURGE</span><br><span class="line">RAISERROR</span><br><span class="line">READ</span><br><span class="line">READTEXT</span><br><span class="line"><span class="type">REAL</span></span><br><span class="line"><span class="keyword">REFERENCES</span></span><br><span class="line">REGEXP</span><br><span class="line">RELATIVE</span><br><span class="line">RENAME</span><br><span class="line">REPEAT</span><br><span class="line">REPLACE</span><br><span class="line">REPLICATION</span><br><span class="line">REQUIRE</span><br><span class="line">RESERV</span><br><span class="line">RESERVING</span><br><span class="line">RESET</span><br><span class="line">RESTORE</span><br><span class="line">RESTRICT</span><br><span class="line">RETAIN</span><br><span class="line"><span class="keyword">RETURN</span></span><br><span class="line"><span class="keyword">RETURNS</span></span><br><span class="line"><span class="keyword">REVOKE</span></span><br><span class="line"><span class="keyword">RIGHT</span></span><br><span class="line"><span class="keyword">ROLLBACK</span></span><br><span class="line"><span class="keyword">ROLLUP</span></span><br><span class="line">ROWCOUNT</span><br><span class="line">RULE</span><br><span class="line">SAVE</span><br><span class="line"><span class="keyword">SAVEPOINT</span></span><br><span class="line">SCHEMA</span><br><span class="line"><span class="keyword">SECOND</span></span><br><span class="line">SECTION</span><br><span class="line">SEGMENT</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">SENSITIVE</span></span><br><span class="line">SEPARATOR</span><br><span class="line">SEQUENCE</span><br><span class="line"><span class="built_in">SESSION_USER</span></span><br><span class="line"><span class="keyword">SET</span></span><br><span class="line">SETUSER</span><br><span class="line">SHADOW</span><br><span class="line">SHARED</span><br><span class="line"><span class="keyword">SHOW</span></span><br><span class="line">SHUTDOWN</span><br><span class="line">SINGULAR</span><br><span class="line">SIZE</span><br><span class="line"><span class="type">SMALLINT</span></span><br><span class="line">SNAPSHOT</span><br><span class="line"><span class="keyword">SOME</span></span><br><span class="line">SORT</span><br><span class="line">SPACE</span><br><span class="line"><span class="keyword">SQL</span></span><br><span class="line">SQLCODE</span><br><span class="line">SQLERROR</span><br><span class="line">STABILITY</span><br><span class="line">STARTING</span><br><span class="line">STARTS</span><br><span class="line">STATISTICS</span><br><span class="line">SUBSTRING</span><br><span class="line">SUM</span><br><span class="line">SUSPEND</span><br><span class="line"><span class="keyword">TABLE</span></span><br><span class="line">TABLES</span><br><span class="line">TEMP</span><br><span class="line">TEMPORARY</span><br><span class="line">TEXT</span><br><span class="line">TEXTSIZE</span><br><span class="line"><span class="keyword">THEN</span></span><br><span class="line"><span class="type">TIME</span></span><br><span class="line"><span class="type">TIMESTAMP</span></span><br><span class="line"><span class="keyword">TO</span></span><br><span class="line">TOP</span><br><span class="line"><span class="keyword">TRAILING</span></span><br><span class="line">TRAN</span><br><span class="line">TRANSACTION</span><br><span class="line">TRANSLATE</span><br><span class="line"><span class="keyword">TRIGGER</span></span><br><span class="line">TRIM</span><br><span class="line"><span class="literal">TRUE</span></span><br><span class="line"><span class="keyword">TRUNCATE</span></span><br><span class="line">TYPE</span><br><span class="line">UNCOMMITTED</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">UNIQUE</span></span><br><span class="line">UNTIL</span><br><span class="line">UPDATE</span><br><span class="line">UPDATETEXT</span><br><span class="line">UPPER</span><br><span class="line">USAGE</span><br><span class="line">USE</span><br><span class="line"><span class="keyword">USER</span></span><br><span class="line"><span class="keyword">USING</span></span><br><span class="line"><span class="keyword">VALUE</span></span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line"><span class="type">VARCHAR</span></span><br><span class="line">VARIABLE</span><br><span class="line"><span class="type">VARYING</span></span><br><span class="line">VERBOSE</span><br><span class="line"><span class="keyword">VIEW</span></span><br><span class="line">VOLUME</span><br><span class="line">WAIT</span><br><span class="line">WAITFOR</span><br><span class="line"><span class="keyword">WHEN</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">WHILE</span><br><span class="line"><span class="keyword">WITH</span></span><br><span class="line">WORK</span><br><span class="line">WRITE</span><br><span class="line">WRITETEXT</span><br><span class="line">XOR</span><br><span class="line"><span class="keyword">YEAR</span></span><br><span class="line">ZONE</span><br></pre></td></tr></table></figure>
</details>

<h1 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h1><p>《SQL必知必会（第5版）》<br>《MySQL必知必会（第1版）》</p>
<h1 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h1><p>数据库除了语法全大写有点看不习惯，整体语句还是比较简单的，SQL 学完后就是针对性学习各类 DBMS 了。</p>

        </div>

        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2023/05/07/tool_vscode/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">VS Code personalization</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2023/04/24/code_debug/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">debug resolution</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'GHjr9A7BcsjDCu8fuLv3Yev2-MdYXbMMI',
                    appKey: 'BwohkTMPdjQcGRYeFq6huB1E',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 Thanks for reading. Please feel free to write.',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'xcbyao';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2023&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">xcbyao</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pref"><span class="nav-number">1.</span> <span class="nav-text">Pref</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Basis"><span class="nav-number">2.</span> <span class="nav-text">Basis</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="nav-number">3.</span> <span class="nav-text">检索数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%8D%95%E4%B8%AA%E5%88%97"><span class="nav-number">3.1.</span> <span class="nav-text">检索单个列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%A4%9A%E4%B8%AA%E5%88%97"><span class="nav-number">3.2.</span> <span class="nav-text">检索多个列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E5%88%97"><span class="nav-number">3.3.</span> <span class="nav-text">检索所有列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%B8%8D%E5%90%8C%E5%80%BC"><span class="nav-number">3.4.</span> <span class="nav-text">检索不同值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%90%E5%88%B6%E7%BB%93%E6%9E%9C%EF%BC%88DBMS-%E5%AE%9E%E7%8E%B0%E4%B8%8D%E5%90%8C%EF%BC%89"><span class="nav-number">3.5.</span> <span class="nav-text">限制结果（DBMS 实现不同）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-Server"><span class="nav-number">3.5.1.</span> <span class="nav-text">SQL Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DB2"><span class="nav-number">3.5.2.</span> <span class="nav-text">DB2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Oracle"><span class="nav-number">3.5.3.</span> <span class="nav-text">Oracle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E3%80%81MariaDB%E3%80%81PostgreSQL-%E6%88%96-SQLite"><span class="nav-number">3.5.4.</span> <span class="nav-text">MySQL、MariaDB、PostgreSQL 或 SQLite</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL%E3%80%81MariaDB-%E5%92%8C-SQLite-%E6%8D%B7%E5%BE%84"><span class="nav-number">3.5.4.1.</span> <span class="nav-text">MySQL、MariaDB 和 SQLite 捷径</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">3.6.</span> <span class="nav-text">注释</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">4.</span> <span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E5%8D%95-%E5%A4%9A%E5%88%97%E6%8E%92%E5%BA%8F"><span class="nav-number">4.1.</span> <span class="nav-text">按单&#x2F;多列排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E5%88%97%E4%BD%8D%E7%BD%AE%E6%8E%92%E5%BA%8F"><span class="nav-number">4.2.</span> <span class="nav-text">按列位置排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E6%8E%92%E5%BA%8F%E6%96%B9%E5%90%91"><span class="nav-number">4.3.</span> <span class="nav-text">指定排序方向</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">5.</span> <span class="nav-text">过滤数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#WHERE-%E5%AD%90%E5%8F%A5"><span class="nav-number">5.1.</span> <span class="nav-text">WHERE 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WHERE-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">5.2.</span> <span class="nav-text">WHERE 操作符</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%87%E6%BB%A4"><span class="nav-number">6.</span> <span class="nav-text">高级数据过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88-WHERE-%E5%AD%90%E5%8F%A5%EF%BC%8CAND-OR-IN-NOT-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">6.1.</span> <span class="nav-text">组合 WHERE 子句，AND OR IN NOT 操作符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E5%80%BC%E9%A1%BA%E5%BA%8F%EF%BC%8C-%E6%98%8E%E7%A1%AE%E5%88%86%E7%BB%84"><span class="nav-number">6.1.1.</span> <span class="nav-text">求值顺序，() 明确分组</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%87%E6%BB%A4-LINK"><span class="nav-number">7.</span> <span class="nav-text">通配符过滤 LINK</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">7.1.</span> <span class="nav-text">通配符 % _ []</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E6%8A%80%E5%B7%A7"><span class="nav-number">7.2.</span> <span class="nav-text">通配符技巧</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">8.</span> <span class="nav-text">创建计算字段</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">8.1.</span> <span class="nav-text">计算字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E6%AE%B5"><span class="nav-number">8.2.</span> <span class="nav-text">拼接字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%AB%E5%90%8D-AS"><span class="nav-number">8.3.</span> <span class="nav-text">别名 AS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E7%AE%97%E6%9C%AF%E8%AE%A1%E7%AE%97"><span class="nav-number">8.4.</span> <span class="nav-text">执行算术计算</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">9.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">9.1.</span> <span class="nav-text">文本处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="nav-number">9.2.</span> <span class="nav-text">日期和时间函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">9.3.</span> <span class="nav-text">数值函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="nav-number">10.</span> <span class="nav-text">汇总数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="nav-number">10.1.</span> <span class="nav-text">聚集函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E4%B8%8D%E5%90%8C%E5%80%BC"><span class="nav-number">10.2.</span> <span class="nav-text">聚集不同值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="nav-number">10.3.</span> <span class="nav-text">组合聚集函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E7%BB%84"><span class="nav-number">11.</span> <span class="nav-text">分组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%88%86%E7%BB%84-GROUP-BY"><span class="nav-number">11.1.</span> <span class="nav-text">创建分组 GROUP BY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%88%86%E7%BB%84"><span class="nav-number">11.2.</span> <span class="nav-text">过滤分组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%92%8C%E6%8E%92%E5%BA%8F"><span class="nav-number">11.3.</span> <span class="nav-text">分组和排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT-%E5%AD%90%E5%8F%A5%E9%A1%BA%E5%BA%8F"><span class="nav-number">11.4.</span> <span class="nav-text">SELECT 子句顺序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%BF%87%E6%BB%A4"><span class="nav-number">12.1.</span> <span class="nav-text">子查询过滤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%9C%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5%E4%BD%BF%E7%94%A8"><span class="nav-number">12.2.</span> <span class="nav-text">作为计算字段使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%81%94%E7%BB%93%E8%A1%A8"><span class="nav-number">13.</span> <span class="nav-text">联结表</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%81%94%E7%BB%93"><span class="nav-number">13.1.</span> <span class="nav-text">创建联结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E8%81%94%E7%BB%93"><span class="nav-number">13.2.</span> <span class="nav-text">内联结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%94%E7%BB%93%E5%A4%9A%E4%B8%AA%E8%A1%A8"><span class="nav-number">13.3.</span> <span class="nav-text">联结多个表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E8%81%94%E7%BB%93"><span class="nav-number">14.</span> <span class="nav-text">高级联结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E5%88%AB%E5%90%8D"><span class="nav-number">14.1.</span> <span class="nav-text">表别名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%81%94%E7%BB%93"><span class="nav-number">14.2.</span> <span class="nav-text">不同类型的联结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E8%81%94%E7%BB%93%EF%BC%88self-join%EF%BC%89"><span class="nav-number">14.2.1.</span> <span class="nav-text">自联结（self-join）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E7%84%B6%E8%81%94%E7%BB%93%EF%BC%88natural-join%EF%BC%89"><span class="nav-number">14.2.2.</span> <span class="nav-text">自然联结（natural join）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E8%81%94%E7%BB%93%EF%BC%88outer-join%EF%BC%89"><span class="nav-number">14.2.3.</span> <span class="nav-text">外联结（outer join）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%A6%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0%E7%9A%84%E8%81%94%E7%BB%93"><span class="nav-number">14.3.</span> <span class="nav-text">带聚集函数的联结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2-UNION"><span class="nav-number">15.</span> <span class="nav-text">组合查询 UNION</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UNION-%E8%A7%84%E5%88%99"><span class="nav-number">15.1.</span> <span class="nav-text">UNION 规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%85%E5%90%AB%E6%88%96%E5%8F%96%E6%B6%88%E9%87%8D%E5%A4%8D%E7%9A%84%E8%A1%8C-UNION-ALL"><span class="nav-number">15.2.</span> <span class="nav-text">包含或取消重复的行 UNION ALL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="nav-number">15.3.</span> <span class="nav-text">对组合查询结果排序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE-INSERT"><span class="nav-number">16.</span> <span class="nav-text">插入数据 INSERT</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E5%AE%8C%E6%95%B4%E8%A1%8C"><span class="nav-number">16.1.</span> <span class="nav-text">插入完整行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E9%83%A8%E5%88%86%E8%A1%8C"><span class="nav-number">16.2.</span> <span class="nav-text">插入部分行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">16.3.</span> <span class="nav-text">插入检索出的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E8%A1%A8%E5%A4%8D%E5%88%B6%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E8%A1%A8"><span class="nav-number">16.4.</span> <span class="nav-text">一个表复制到另一个表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SELECT-INTO-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">16.4.1.</span> <span class="nav-text">SELECT INTO 注意事项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="nav-number">17.</span> <span class="nav-text">更新数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">18.</span> <span class="nav-text">删除数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%99"><span class="nav-number">18.1.</span> <span class="nav-text">更新和删除指导原则</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8"><span class="nav-number">19.</span> <span class="nav-text">表</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8-CREATE-TABLE"><span class="nav-number">19.1.</span> <span class="nav-text">创建表 CREATE TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%80%BC-DEFAULT"><span class="nav-number">19.2.</span> <span class="nav-text">指定默认值 DEFAULT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8-ALTER-TABLE"><span class="nav-number">19.3.</span> <span class="nav-text">更新表 ALTER TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8-DROP-TABLE"><span class="nav-number">19.4.</span> <span class="nav-text">删除表 DROP TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="nav-number">19.5.</span> <span class="nav-text">重命名表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">20.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E5%BA%94%E7%94%A8"><span class="nav-number">20.1.</span> <span class="nav-text">视图应用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E8%A7%84%E5%88%99%E5%92%8C%E9%99%90%E5%88%B6"><span class="nav-number">20.2.</span> <span class="nav-text">视图规则和限制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E8%A7%86%E5%9B%BE%E7%AE%80%E5%8C%96%E5%A4%8D%E6%9D%82%E7%9A%84%E8%81%94%E7%BB%93"><span class="nav-number">20.3.</span> <span class="nav-text">用视图简化复杂的联结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E8%A7%86%E5%9B%BE%E9%87%8D%E6%96%B0%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">20.4.</span> <span class="nav-text">用视图重新格式化检索出的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E8%A7%86%E5%9B%BE%E8%BF%87%E6%BB%A4%E4%B8%8D%E6%83%B3%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">20.5.</span> <span class="nav-text">用视图过滤不想要的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE%E4%B8%8E%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">20.6.</span> <span class="nav-text">使用视图与计算字段</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">21.</span> <span class="nav-text">存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">21.1.</span> <span class="nav-text">执行存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">21.2.</span> <span class="nav-text">创建存储过程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="nav-number">22.</span> <span class="nav-text">事务处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="nav-number">22.1.</span> <span class="nav-text">控制事务处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROLLBACK"><span class="nav-number">22.2.</span> <span class="nav-text">ROLLBACK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#COMMIT"><span class="nav-number">22.3.</span> <span class="nav-text">COMMIT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%9D%E7%95%99%E7%82%B9"><span class="nav-number">22.4.</span> <span class="nav-text">保留点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B8%B8%E6%A0%87-cursor"><span class="nav-number">23.</span> <span class="nav-text">游标 cursor</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%89%B9%E6%80%A7"><span class="nav-number">23.1.</span> <span class="nav-text">常见特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87"><span class="nav-number">23.2.</span> <span class="nav-text">使用游标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%B8%B8%E6%A0%87-DECLARE"><span class="nav-number">23.3.</span> <span class="nav-text">创建游标 DECLARE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87-OPEN-CURSOR"><span class="nav-number">23.4.</span> <span class="nav-text">使用游标 OPEN CURSOR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%B8%B8%E6%A0%87-CLOSE"><span class="nav-number">23.5.</span> <span class="nav-text">关闭游标 CLOSE</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7-SQL-%E7%89%B9%E6%80%A7"><span class="nav-number">24.</span> <span class="nav-text">高级 SQL 特性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9F-constraint"><span class="nav-number">24.1.</span> <span class="nav-text">约束 constraint</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E9%94%AE"><span class="nav-number">24.1.1.</span> <span class="nav-text">主键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%94%AE"><span class="nav-number">24.1.2.</span> <span class="nav-text">外键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="nav-number">24.1.3.</span> <span class="nav-text">唯一约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="nav-number">24.1.4.</span> <span class="nav-text">检查约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95-CREATE-INDEX"><span class="nav-number">24.2.</span> <span class="nav-text">索引 CREATE INDEX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">24.3.</span> <span class="nav-text">触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8"><span class="nav-number">24.4.</span> <span class="nav-text">数据库安全</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%A1%A8%E8%84%9A%E6%9C%AC"><span class="nav-number">25.</span> <span class="nav-text">样例表脚本</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vendors-%E8%A1%A8"><span class="nav-number">25.1.</span> <span class="nav-text">Vendors 表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Products-%E8%A1%A8"><span class="nav-number">25.2.</span> <span class="nav-text">Products 表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Customers-%E8%A1%A8"><span class="nav-number">25.3.</span> <span class="nav-text">Customers 表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Orders-%E8%A1%A8"><span class="nav-number">25.4.</span> <span class="nav-text">Orders 表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OrderItems-%E8%A1%A8"><span class="nav-number">25.5.</span> <span class="nav-text">OrderItems 表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL-%E8%AF%AD%E5%8F%A5%E8%AF%AD%E6%B3%95"><span class="nav-number">26.</span> <span class="nav-text">SQL 语句语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%A6%E5%AE%9A"><span class="nav-number">26.1.</span> <span class="nav-text">约定</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ALTER-TABLE"><span class="nav-number">26.2.</span> <span class="nav-text">ALTER TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#COMMIT-1"><span class="nav-number">26.3.</span> <span class="nav-text">COMMIT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-INDEX"><span class="nav-number">26.4.</span> <span class="nav-text">CREATE INDEX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-PROCEDURE"><span class="nav-number">26.5.</span> <span class="nav-text">CREATE PROCEDURE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-TABLE"><span class="nav-number">26.6.</span> <span class="nav-text">CREATE TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-VIEW"><span class="nav-number">26.7.</span> <span class="nav-text">CREATE VIEW</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE"><span class="nav-number">26.8.</span> <span class="nav-text">DELETE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DROP"><span class="nav-number">26.9.</span> <span class="nav-text">DROP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT"><span class="nav-number">26.10.</span> <span class="nav-text">INSERT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT-SELECT"><span class="nav-number">26.11.</span> <span class="nav-text">INSERT SELECT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROLLBACK-1"><span class="nav-number">26.12.</span> <span class="nav-text">ROLLBACK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT"><span class="nav-number">26.13.</span> <span class="nav-text">SELECT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE"><span class="nav-number">26.14.</span> <span class="nav-text">UPDATE</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">27.</span> <span class="nav-text">SQL 数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%8D%95%E5%BC%95%E5%8F%B7%E5%86%85%EF%BC%89"><span class="nav-number">27.1.</span> <span class="nav-text">字符串（单引号内）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%EF%BC%88%E4%B8%8D%E7%94%A8%E5%BC%95%E5%8F%B7%EF%BC%89"><span class="nav-number">27.2.</span> <span class="nav-text">数值（不用引号）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A7%E5%B8%81%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">27.2.1.</span> <span class="nav-text">货币数据类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4"><span class="nav-number">27.3.</span> <span class="nav-text">日期和时间</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ODBC-%E6%97%A5%E6%9C%9F"><span class="nav-number">27.3.1.</span> <span class="nav-text">ODBC 日期</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="nav-number">27.4.</span> <span class="nav-text">二进制</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">28.</span> <span class="nav-text">SQL 关键字</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Refer"><span class="nav-number">29.</span> <span class="nav-text">Refer</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PS"><span class="nav-number">30.</span> <span class="nav-text">PS</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
